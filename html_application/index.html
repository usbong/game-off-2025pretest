<!--
/*
' Copyright 2022~2024 USBONG
'
' Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You ' may obtain a copy of the License at
'
' http://www.apache.org/licenses/LICENSE-2.0
'
' Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, ' WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing ' permissions and limitations under the License.
'
' @company: USBONG
' @author: SYSON, MICHAEL B.
' @date created: 20221214
' @date updated: 20241130; from 20241129
' @website: www.usbong.ph
'
' References: GitHub itch.io Game Off 2021, 2022, 2023
'
'*/

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
<!--
  	<base href="http://localhost/usbong_2DAnimationTool/" target="_blank">
  	<base href="http://store.usbong.ph/" target="_blank">
-->

  </head>

  <title>
    Usbong Game Off 2024
  </title>

  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

  <style type="text/css">
		html, body
        {
            font-family: Arial;
			font-size: 11pt;

			/* edited by Mike, 20220911
			width: 640px;
			*/
			width: 100%; /*90%; 80%;*/
			height: 100%;

			/*added by Mike, 20231119*/
			background-color: white; /*black; transparent*/
			border: none;


			padding: 0;
			margin: 0;

			/* //added by Mike, 20221002
			//reference: https://www.w3schools.com/howto/howto_css_disable_text_selection.asp;
			//last accessed: 20221002
			*/

			-webkit-user-select: none; /* Safari */
			-ms-user-select: none; /* IE 10 and IE 11 */
			user-select: none; /* Standard syntax */

			/* added by Mike, 20221012 */
			transform: scale(1.0);

			/* added by Mike, 20221119 */
			touch-action: none;
		}

		canvas.myCanvas {
      position: absolute;

			padding: 0;
			margin: auto;
			display: block;

/*
			width: 320px;
			height: 288px;
*/

/*			width: 448px; *//*640px;*/
/*			height: 402px; *//*576px;*/

			width: 640px;
			height: 360px;

			/*	//removed by Mike, 20231121
				border: 1px solid gray;
			*/

/*
			padding: -10px;
*/
      visibility: hidden;

			border: 0px; /*1px dotted gray;*/

			z-index: -1;
		}
		
		canvas.myCanvasSnowEffect {
			position: absolute;

			padding: 0;
			margin: auto;
			display: block;


			width: 640px;
			height: 360px;

			visibility: hidden;

			border: 1px dotted gray;

			z-index: 10;
		}
		
		div.myDivSnowEffect
		 {
			position: absolute;

			background-color: white; /*pink;*/
			
			padding: 0;
			margin: auto;
			display: block;


			width: 5px; /*10px;*/
			height: 5px; /*10px;*/


			visibility: visible;
/*

			border: 1px dotted gray;
*/
			z-index: 20;
		}

		div.myDivTransitionEffect
		{
			position: absolute;

			background-color: black; /*pink;*/
			
			padding: 0;
			margin: auto;
			display: block;


			width: 360px;
			height: 360px;


			visibility: visible; /*hidden;*/
			z-index: 99;
			
			transform: scale(0, 0);
		}
		

		.ImageTileFrame1 {
			position: absolute;

			clip: rect(0px,32px,32px,0px);
			visibility: hidden;
			
			z-index: 4; /*2;*/
		}

		.ImageTileFrameFireballProjectileHold {
			position: absolute;

			clip: rect(0px,32px,32px,0px);
			visibility: hidden;
			
			z-index: 2; /*2;*/
		}
		
		.ImageTileFrameDd1 { 
			position: absolute;

			clip: rect(0px,32px,32px,0px);
			visibility: hidden;
			
			z-index: 5; /*2;*/
		}

		.ImageTileBgFrame {
			position: absolute;

			clip: rect(0px,32px,32px,0px);
			visibility: hidden;
			
			z-index: 2;
		}

		
		.ImageHeroFrame1 {
			position: absolute;

			clip: rect(0px,32px,32px,0px);
			
			visibility: hidden;
						
			z-index: 3;
		}

		.ImageTankFrame1 {
			position: absolute;

			clip: rect(0px,64px,64px,0px);
			visibility: hidden;
			
			z-index: 3;
		}
		

    .ImageMonsterBoss {
			position: absolute;

      clip: rect(0px,128px,128px,0px);

      width:512px;
      height: auto;

			visibility: hidden;
			
			z-index: 4; /*2;*/
		}

    .ImageMonster0 {
      position: absolute;

      clip: rect(0px,64px,64px,0px);

      visibility: hidden;
    }
	
	 .ImageMainSoldier {
			position: absolute;
/*
			width: 768px;
			height: 256px;
			
			object-fit: contain;

			clip: rect(0px,64px,64px,0px);
*/
			visibility: hidden;
			
			z-index: 2;
		}

	 .ImageBossBattleBgPart2, .ImageBossBattleBgPart3 {
			position: absolute;
			visibility: hidden;
			
			z-index: 5;
		}

	 .ImageBossBattleBgBeachPart2 {
			position: absolute;
			visibility: hidden;
			
			z-index: 4;
		}
		

		.ImageMouseInput {
			position: absolute;

			clip: rect(0px,64px,64px,0px);
/*
			clip: rect(0px,32px,32px,0px);
*/
			visibility: hidden; /*visible;*/
		}


		.ImageExplosion, .ImageInitFireball {
			position: absolute;

			/*	//edited by Mike, 20231120
				clip: rect(0px,256px,256px,0px);
			*/

			clip: rect(0px,128px,128px,0px);

			visibility: hidden;

			z-index: 10; /*4;*/
		}

		.ImageExplosionEffectResizedToSmall {
			position: absolute;

			clip: rect(0px,128px,128px,0px);
			
			visibility: hidden;

			z-index: 10; /*4;*/
		}
		
		.ImageGrassCutEffectSmall, .ImagePearlSmall, .ImageKeySmall {
			position: absolute;

			clip: rect(0px,32px,32px,0px);
			
			visibility: hidden;

			z-index: 2; /*4;*/
		}		
		
		
		.ImageExplosionToCity {
			position: absolute;

			clip: rect(0px,128px,128px,0px);
/*
			width: 64px; 
			height: auto;
*/
			object-fit: contain;
			
			visibility: hidden;
/*			
			scale: 0.5;
*/
			z-index: 10; /*4;*/
		}

		.ImageDust {
			position: absolute;

			clip: rect(0px,32px,32px,0px);

			visibility: hidden;

			z-index: 10; /*4;*/
		}
		
		.ImageHeroAttack {
			position: absolute;

			clip: rect(0px,32px,32px,0px);

			visibility: hidden;

			z-index: 10; /*4;*/
		}			
		
		.ImageHowToPlayGuide {
			position: absolute;

			text-align: center;
			line-height: 32px;

			visibility: hidden;

			width: 640px;
			height: 360px;

			/* //added by Mike, 20221104 */
			z-index: 10;
		}

		.ImageTitle {
			position: absolute;

			text-align: center;
			line-height: 32px;

			visibility: hidden;

			/* //edited by Mike, 20230121
			//notes: @640px, excess shaking via MS EDGE Browser
			*/
			width: 480px; /*640px;*/

			object-fit: contain;

			z-index: 10;
		}

		.ImageBossBattleBg {
			position: absolute;

			text-align: center;
			line-height: 32px;

			visibility: hidden;

			width: 360px; /*600*/
			height: auto;

			object-fit: contain;
			
			z-index: 1;
		}

		
		.ButtonSet, .TextInputSet {
			position: relative; /*absolute;*/
			font-size: 20px;
		}

		.LabelSet {
			position: relative; /*absolute;*/
			font-size: 24px;

			font-weight: bolder; /*bold;*/
		}

		.SelectAnimDirection {
			font-size: 22px;
		}

		table.TableSetPanel
		{
			position: absolute;
			border: 2px dotted #ab9c7d;
			margin-top: 0px; /*10px*/

			visibility: hidden;
		}


		.Image32x32Tile {
			position: absolute;
/*
			width: 256px;
			height: 256px;

			object-fit: contain;

			clip: rect(0px,64px,64px,0px);
*/
/*	//edited by Mike, 20231116
			width: 512px;
*/
			width: 768px;
			height: 256px;

			object-fit: contain;

			clip: rect(0px,64px,64px,0px);

			background-color: #f7f7f7; /*transparent;*/
/*
			border: none;
*/
			color: #222222;

			/* //removed by Mike, 20221111
			opacity: 0.5;*/

			font-weight: bold;
			/*font-size: 146%;*/ /*20px;*/
/*
			text-align: center;
			line-height: 32px;
*/

			border: 0px dotted gray;

			visibility: hidden;

			margin: 0px; /*1px;*/
			padding: 0px;

			z-index: 2; /*3;*/
		}
		
		.Image64x64Tile {
			position: absolute;
/*
			width: 512px;
			height: 512px;

			object-fit: contain;
*/
			clip: rect(0px,64px,64px,0px);

			visibility: hidden;

			margin: 0px; /*1px;*/
			padding: 0px;

			z-index: 2; /*3;*/
		}
		
		.ImageRiverTile {
			position: absolute;
/*
			width: 512px;
			height: 512px;

			object-fit: contain;
*/
			clip: rect(0px,130px,320px,0px);

			visibility: hidden;

			margin: 0px; /*1px;*/
			padding: 0px;

			z-index: 2; /*3;*/
		}		


    		/* noted by Mike, 20221105 */
    		.Image32x32TileTarget {
    			position: absolute;

    /* //added by Mike, 20221113; edited by Mike, 20230111*/
    /*
    			width: 128px;
    			height: 128px;
    */
    			width: 256px;
    			height: 256px;

    			object-fit: contain;


    			/* //added by Mike, 20221112; edited by Mike, 20230111 */
    /*
    			clip: rect(0px,32px,32px,0px);
    */
    			clip: rect(0px,64px,64px,0px);

    /* //removed by Mike, 20221112
    			width: 32px;
    			height: 32px;
    */

    /* //edited by Mike, 20221112 */
    /*
    			background-color: #ffffff;
    */
    background-color: transparent;
    border: none;
    			color: #222222;

    			/* //added by Mike, 20221111
    			   //TO-DO: -update: this
    			*/
    			opacity: 0.5;

    			font-weight: bold;
    			font-size: 146%; /*18px;*/

    			text-align: center;
    			line-height: 32px;

    			/*padding-top: 0.1875%;*/ /*6px;*/

    /* //note: with clip rect border is put on entire sprite image */
    /* //removed by Mike, 20221112
    			border: 3px solid #ff0000;
    			border-radius: 3px;
    */
    			margin: 0px; /*1px;*/
    			padding: 0px;
    			z-index: 4;
    		}

    		.Image32x32TileTargetBorder {
    			position: absolute;
    /*
    edited by Mike, 20230111
    			width: 27px;
    			height: 27px;
    */
    			width: 58px;
    			height: 58px;

    			background-color: transparent;
    			color: #222222;

    			font-weight: bold;
    			font-size: 146%; /*18px;*/

    			text-align: center;
    			line-height: 32px;

    			border: 3px dashed #ff0000;
    			border-radius: 3px;

    			visibility: hidden;

    			margin: 0px;
    			padding: 0px;
    			z-index: 4;
    		}

    		.Image32x32TileSpaceBorder {
    			position: absolute;

    /*
    edited by Mike, 20230111
    			width: 27px;
    			height: 27px;
    */
    			width: 58px;
    			height: 58px;

    			background-color: transparent; /*#ffffff;*/

    			color: #222222;

    			font-weight: bold;
    			font-size: 146%; /*18px;*/

    			text-align: center;
    			line-height: 32px;

    			border: 3px dashed #00ff00; /*#ffffff*/
    			border-radius: 3px;

    			visibility: hidden;

    			margin: 0px;
    			padding: 0px;
    			z-index: 4;
    		}


    		.Image32x32TileSpaceTarget {
    			position: absolute;

    /*
    edited by Mike, 20230111
    			width: 27px;
    			height: 27px;
    */
    			width: 58px;
    			height: 58px;

    			background-color: #000000; /*#ffffff;*/
    			color: #222222;

    			text-align: center;
    			line-height: 32px;

    			border: 3px solid #ffffff; /*#ff0000;*/
    			border-radius: 3px;

    			margin: 0px;
    			padding: 0px;
    			z-index: 5;
    		}

    		/* added by Mike, 20221105 */
    		.Image32x32TileSpace {
    			position: absolute;

    /* //added by Mike, 20221113; edited by Mike, 20230111*/
    /*
    			width: 128px;
    			height: 128px;
    */
    			width: 256px;
    			height: 256px;
    			object-fit: contain;

    			/* //added by Mike, 20221112; edited by Mike, 20230111 */
    /*
    			clip: rect(0px,32px,32px,0px);
    */
    			clip: rect(0px,64px,64px,0px);


    /* //removed by Mike, 20221112
    			width: 32px;
    			height: 32px;
    */

    /* //edited by Mike, 20221112 */
    /*
    			background-color: #222222;
    */
    background-color: transparent;
    border: none;
    			color: #222222;

    			text-align: center;
    			line-height: 32px;

    			/*padding-top: 0.1875%;*/ /*6px;*/

    /* //note: with clip rect border is put on entire sprite image */
    /* //removed by Mike, 20221112
    			border: 3px solid #ff0000;
    			border-radius: 3px;
    */
    			margin: 0px; /*1px;*/
    			padding: 0px;

    			z-index: 3;
    		}


			/*added by Mike, 20231111 */
			div.DivTextStatus
			{
				position: absolute;

/*	//edited by Mike, 20221213
				background-color: #000000aa;
*/
/*
				background-color: #00000099;
				
*/
				background-color: transparent;

				color: #eeeeee; /*#ffffff;*/ /*#ffbd00;*/ /* gold */

				/*
				border: 3px solid #ffffff;				
				border-radius: 4px;
*/

				/*opacity: 50%;*/

				font-size: 24px; /*28; 16px;*/
				font-weight: bold;

				padding: 20px;
				padding-top: 20px;

				visibility: hidden;

				/* added by Mike, 20230128;
					put above tile images */
				z-index: 90; /*4;*/
			}

			div.DivTextStatusBackground
			{
				position: absolute;

				background-color: #00000099;
				border: 3px solid #ffffff;				
				border-radius: 4px;

				font-size: 30px; /*16px;*/
				font-weight: bold;

				padding: 10px;
				
				width: 120px; 
				height: 120px; 

				visibility: hidden;

				/* added by Mike, 20230128;
					put above tile images */
				z-index: 80; /*4;*/
			}

			
			div.DivStepCountStatusShadow
			{
				position: absolute;
/*
				background-color: #000000aa;
*/
				/*color: #ffffff;*/ /* white */

				color: #6d4e22; /* brown */

				/*opacity: 50%;*/

				font-size: 32px;/*42px;*/
				font-weight: bold;

/* //edited by Mike, 20230130
				padding: 10px;
*/
				/* //changed from margin */
				/* //edited by Mike, 20230130
				margin: 10px;
				*/
				padding: 0px;


				visibility: hidden;

				/* put above image tiles;
					below step count button
				*/
				z-index: 90; /*4;*/
			}



			div.DivTextEnter
			{
				position: absolute;
				/*background-color: #000000aa;*/
				color: #000000; /*#ffffff;*/

				/*opacity: 50%;*/

				font-size: 16px;
				font-weight: bold;

				/* //noted by Mike, 20230130 */
				padding: 10px;

				visibility: visible;
			}

			div.DivTextClickStart
			{
				position: absolute;
				/*
				background-color: #4d4d4d;
*/
				
				color: #ffffff; /*#ffffff;*/

				/*opacity: 50%;*/

				font-size: 16px;
				font-weight: bold;

				/* //noted by Mike, 20230130 */
				padding: 10px;
				padding-right: 40px;
				padding-left: 40px;

    			border: 3px solid #ffffff;
    			border-radius: 3px;

				visibility: hidden;
				
				z-index: 99;				
			}

			div.DivTextClickContinue
			{
				position: absolute;

				background-color: #4d4d4d;

				color: #fff484; /*#fff484; #ffffff;*/

				opacity: 80%;

				font-size: 20px;
				font-weight: bold;

				/* //noted by Mike, 20230130 */
				padding: 10px;
				padding-right: 40px;
				padding-left: 40px;
				
    			border: 4px solid #ffffff; /*#4d4d4d;*/
    			border-radius: 3px;


				visibility: hidden;
				
				z-index: 99;				
			}

			div.DivTextScore
			{
				position: absolute;
/*
				background-color: #000000aa;
*/
				color: #6d4e22; /* brown */

				/*color: #ffffff;*/ /* white */

				/*opacity: 50%;*/

				font-size: 32px;/*42px;*/
				font-weight: bold;

/* //edited by Mike, 20230130
				padding: 10px;
*/
				/* //changed from margin */
				/* //edited by Mike, 20230130
				margin: 10px;
				*/
				padding: 0px;

				visibility: hidden;

				/* put above image tiles;
					below step count button
				*/
				z-index: 90; /*4;*/
			}

			div.DivTextTime
			{
				position: absolute;
/*
				background-color: #000000aa;
*/
				color: #ffffff; /* brown; #6d4e22 */

				/*opacity: 50%;*/

				font-size: 32px;/*42px;*/
				font-weight: bold;

/* //edited by Mike, 20230130
				padding: 10px;
*/
				/* //changed from margin */
				/* //edited by Mike, 20230130
				margin: 10px;
				*/
				padding: 0px;

				visibility: hidden;

				/* put above image tiles;
					below step count button
				*/
				z-index: 90; /*4;*/
			}


      audio.myAudio
      {
        width: 416px;
        height: 312px;

        /* added by Mike, 20230115 */
        visibility: hidden;
      }


  </style>

  <script>

var iRowCount=0;
const iRowCountMax=6;//10;
var iColumnCount=0;
const iColumnCountMax=6;//10;
//column, row
var arrayHasVisitedRoom = [[],[],[],[],[],[]];

var bIsGameOver=false;
const iInputDelayAtGameOverCountMax=100;
var iInputDelayAtGameOverCount=0;

var bIsHeroInRiver=false;
var bHasHeroReachedBottomOfRoomRiver=false;
var bHasHeroReachedTopOfRoomRiver=false;
var bHasPlayedSolvedTune=false;

var bIsMissionDone=false;
var bIsMissionStarted=false;
var bHasViewedMissionIntro=false;

var bIsHeroInTank=false;
var bIsHeroAttacked=false;

var bIsBossMonsterHit=false;
var bIsMiniBossMonsterHit=false;
//var iBossLife=3;

var bIsActionKeyPressed=false;

var iInputDelayCountMax=100;//1000;//3;
var iInputDelayCount=iInputDelayCountMax;

var bHasViewedHowToPlayGuide=false;
//var bIsStillUsingItchScreen=false;

//added by Mike, 20231111
//reference: https://github.com/usbong/tugon/blob/main/mainLinux.cpp;
//last accessed: 20221125
var bIsExecutingShake=false;
var iDestroyHumanShakeDelayCount=0;
var iDestroyHumanShakeDelayMax=5;

var iShakeOffsetWidthMax=2;
var iShakeOffsetHeightMax=2;

var iShakeOffsetWidth=iShakeOffsetWidthMax;
var iShakeOffsetHeight=iShakeOffsetHeightMax;

var iHeroInvincibileCount=0;
var iHeroInvincibileCountMax=50;

var iCurrHeroLifeMax=10;
var iCurrHeroLife=iCurrHeroLifeMax;
var iCurrHeroLifeAnimationDelayCount=0;
var iCurrHeroLifeAnimationDelayCountMax=5;

var iCurrHeroManaMax=10;
var iCurrHeroMana=iCurrHeroManaMax;
var iCurrHeroManaAnimationDelayCount=0;
var iCurrHeroManaAnimationDelayCountMax=5;
var iCurrHeroProjectileManaAnimationDelayCount=0;
var iCurrHeroProjectileManaAnimationDelayCountMax=5;

var iCurrBossMonsterLifeMax=20;
var iCurrBossMonsterLife=iCurrBossMonsterLifeMax;
var iCurrBossMonsterLifeAnimationDelayCount=0;
var iCurrBossMonsterLifeAnimationDelayCountMax=5;

var iCurrHeroDeathCount=0;
var iCurrPearlCount=0;
var iCurrPearlCountMax=6;
var iCurrMonsterDeathCount=0;
/*
const sAudioEffectActionCannonFire ="assets/audio/usbongGameOff2023AudioEffectsCannon.mp3";
const sAudioBGM="assets/audio/usbongGameOff2023BGM.mp3";
*/

const sAudioEffectActionCannonFire ="assets/audio/usbongGameOff2023AudioEffectsCannon.mp3";
const sAudioEffectGrassCut ="assets/audio/usbongGameOff2023TapLoudEdited.mp3";

const sAudioBGM="assets/audio/usbongGameOff2024CaveBGMV22.mp3";

const sAudioBGMPart2="assets/audio/usbongGameOff2024CaveBadBGMV10.mp3";

const sAudioBGMPart3="assets/audio/usbongGameOff2024CaveFantasyBGM.mp3";

const sAudioEffectSolved ="assets/audio/UsbongGameOff2024TuneSolved.mp3";

const sAudioEffectBossScreech ="assets/audio/usbongGameOff2024Screech.mp3";

const sAudioEffectWater ="assets/audio/usbongGameOff2024WaterOKV2.mp3";

var myAudio;
var myAudioPart2;
var myAudioPart3;
var myAudioBossScreech;
var myAudioWater;

/*
var iAnimationCount=-1;//0; start at -1
var iAnimationCountMax=5;
var iAnimationDelayCount=10; //0
var iAnimationDelayCountMax=10;
*/

var iRiverAnimationCount=-1;//0; start at -1
var iRiverAnimationCountMax=5;
var iRiverAnimationDelayCount=10; //bat; //0
var iRiverAnimationDelayCountMax=6;
var iRiverImagePosX=0;
var iRiverImagePosY=0;
var iRiverImageFrameWidth=0;
var iRiverImageFrameHeight=0;

//added by Mike, 20231127
var iBatMonsterAnimationCount=-1;//0; start at -1
var iBatMonsterAnimationCountMax=5;
var iBatMonsterAnimationDelayCount=10; //bat; //0
var iBatMonsterAnimationDelayCountMax=6;

var iBossMonsterAnimationCount=-1;//0; start at -1
var iBossMonsterAnimationCountMax=5;
var iBossMonsterAnimationDelayCount=10; //0
var iBossMonsterAnimationDelayCountMax=10;

var iBossMonsterHitAnimationCount=-1;//0; start at -1
var iBossMonsterHitAnimationCountMax=5;

var iBossMonsterMovementDelayCount=-1;//0; start at -1
const iBossMonsterMovementDelayCountMax=5;

var iMiniBossMonsterMovementDelayCount=-1;//0; start at -1
const iMiniBossMonsterMovementDelayCountMax=500;

//added by Mike, 20241115
var iMiniMapAnimationCount=-1;//0; start at -1
var iMiniMapAnimationCountMax=5;
var iMiniMapAnimationDelayCount=0; //0
var iMiniMapAnimationDelayCountMax=5;

//added by Mike, 20231119
var iExplosionEffectAnimationCount=-1; //0; //due to immediately +1 in execution;
var iExplosionEffectAnimationCountMax=5;
var iExplosionEffectAnimationDelayCount=0;
var iExplosionEffectAnimationDelayCountMax=2;//4;//1;

var iFireballExplosionEffectAnimationCount=-1; //0; //due to immediately +1 in execution;
var iFireballExplosionEffectAnimationCountMax=5;
var iFireballExplosionEffectAnimationDelayCount=0;
var iFireballExplosionEffectAnimationDelayCountMax=2;//4;//1;

var iGrassCutEffectAnimationCount=-1; //0; //due to immediately +1 in execution;
var iGrassCutEffectAnimationCountMax=5;
var iGrassCutEffectAnimationDelayCount=0;
var iGrassCutEffectAnimationDelayCountMax=4;//1;

var iPearlAnimationCount=-1; //0; //due to immediately +1 in execution;
var iPearlAnimationCountMax=5;
var iPearlAnimationDelayCount=0;
var iPearlAnimationDelayCountMax=2;
var iPearlInvincibileCount=0;
const iPearlInvincibileCountMax=10;

var iKeyAnimationCount=-1; //0; //due to immediately +1 in execution;
var iKeyAnimationCountMax=5;
var iKeyAnimationDelayCount=0;
var iKeyAnimationDelayCountMax=2;
var iKeyInvincibileCount=0;
const iKeyInvincibileCountMax=10;

var iAmuletInvincibileCount=0;
const iAmuletInvincibileCountMax=10;

var bHasObtainedPearlAtRoom42=false;
var bHasObtainedPearlAtRoom41=false;
var bHasObtainedPearlAtRoom33=false;
var bHasObtainedPearlAtRoom43=false;
var bHasObtainedPearlAtRoom22=false;
//var bHasObtainedPearlAtRoom11=false;
var bHasObtainedKeyAtRoom1=false;
var bHasUsedKeyAtRoom11=false;
var bHasObtainedAmuletAtRoom32=false; //Pendant; Agimat
var bHasObtainedPearlAtRoom12=false;

var dElapsedTimeInSeconds=0;

var iPearlStatusAnimationCount=-1; //0; //due to immediately +1 in execution;
var iPearlStatusAnimationCountMax=5;
var iPearlStatusAnimationDelayCount=0;
var iPearlStatusAnimationDelayCountMax=2;

var iAmuletStatusAnimationCount=-1; //0; //due to immediately +1 in execution;
var iAmuletStatusAnimationCountMax=5;
var iAmuletStatusAnimationDelayCount=0;
var iAmuletStatusAnimationDelayCountMax=2;

var iHeroFireballProjectileAnimationCount=-1; //0; //due to immediately +1 in execution;
var iHeroFireballProjectileAnimationCountMax=5;
var iHeroFireballProjectileAnimationDelayCount=0;
var iHeroFireballProjectileAnimationDelayCountMax=2;

var iHeroFireballProjectileHoldAnimationCount=-1; //0; //due to immediately +1 in execution;
var iHeroFireballProjectileHoldAnimationCountMax=5;
var iHeroFireballProjectileHoldAnimationDelayCount=0;
var iHeroFireballProjectileHoldAnimationDelayCountMax=1;//2;

var iKeyStatusAnimationCount=-1; //0; //due to immediately +1 in execution;
var iKeyStatusAnimationCountMax=5;
var iKeyStatusAnimationDelayCount=0;
var iKeyStatusAnimationDelayCountMax=2;

//added by Mike, 20231127
var iMonsterExplosionEffectAnimationCount=-1; //0; //due to immediately +1 in execution;
var iMonsterExplosionEffectAnimationCountMax=5;
var iMonsterExplosionEffectAnimationDelayCount=0;
//edited by Mike, 20231128
var iMonsterExplosionEffectAnimationDelayCountMax=2;//4;//1;

//added by Mike, 20241105
var iDustEffectAnimationCount=-1; //0; //due to immediately +1 in execution;
var iDustEffectAnimationCountMax=5;
var iDustEffectAnimationDelayCount=0;
var iDustEffectAnimationDelayCountMax=4;//1;

var iInitFireballEffectAnimationCount=-1; //0; //due to immediately +1 in execution;
var iInitFireballEffectAnimationCountMax=5;
var iInitFireballEffectAnimationDelayCount=0;
var iInitFireballEffectAnimationDelayCountMax=2;//4;//1;

//added by Mike, 20241113
var iHeroAttackEffectAnimationCount=-1; //0; //due to immediately +1 in execution;
var iHeroAttackEffectAnimationCountMax=5;
var iHeroAttackEffectAnimationDelayCount=0;
var iHeroAttackEffectAnimationDelayCountMax=2;//2;//1;

var iMonsterBossAttackDelayCount=0;
var iMonsterBossAttackDelayCountMax=120;

var iImageExplosionEffectAnimationWidth=32;//64;
var iImageExplosionEffectAnimationHeight=32;//64;

var iImageFireballExplosionEffectAnimationWidth=32;//64;
var iImageFireballExplosionEffectAnimationHeight=32;//64;

var iImageGrassCutEffectAnimationWidth=32;//64;
var iImageGrassCutEffectAnimationHeight=32;//64;

var iImageDustEffectAnimationWidth=32;
var iImageDustEffectAnimationHeight=32;

var iImageHeroAttackEffectAnimationWidth=32;
var iImageHeroAttackEffectAnimationHeight=32;

var iTransitionRotate=0;
var iTransitionScale=0;//1;
var iTransitionDelayCount=0;
var iTransitionDelayCountMax=20;

var iMouseAnimationCount=-1; //0; //due to immediately +1 in execution;
var iMouseAnimationCountMax=5;
var iMouseAnimationDelayCount=0;
var iMouseAnimationDelayCountMax=2;//1;

//added by Mike, 20241105
var iMouseClickStartTime=0;
var iMouseClickMaxElapsedTime=250; //1/4 second
var bIsHeroDash=false;
var bHasHeroShotFireball=false;

var iHeroAnimationCount=-1; //0; //due to immediately +1 in execution;
var iHeroAnimationCountMax=5;
var iHeroAnimationDelayCount=0;
var iHeroAnimationDelayCountMax=5;//2;//1; //TODO: -add: more dust effect if target walking distance is far

/*
var iScore=10000;//0;
var iTargetScore=10000;//0;
var bIsIncreasingScore=false;//true;

//added by Mike, 20231125
var iTextScoreDivWidthOffset=5;
var iTextScoreDivWidth;
var iTextScoreShadowDivWidthOffset=1;
*/

//added by Mike, 20241114
//font size at 32px; 00:00:00.length is 8
var iTextTimeDivWidthOffset=16*8; //5;
var iTextTimeDivWidth;
var iTextTimeShadowDivWidthOffset=1;
var iStartTimeInMilliseconds=0;

//added by Mike, 20231127
var iCurrSnowFlakeCount=0;
var iCurrSnowFlakeCountMax=20;
var iCurrSnowFlakeCountPosX=0;
var iCurrSnowFlakeCountPosY=0;

//note: acceleration
//min 2; not 1
var mainImageTileProjectileStepYMax=6;//10;//4;//20;//20;
var mainImageTileProjectileStepXMax=6;//10;//4;//20;//20;

var mainImageTileProjectileVelocityY=2;//4;//20;//4;//1;
var mainImageTileProjectileVelocityX=2;//4;//20;//4;//1;

var mainImageTileProjectileStepYMin=mainImageTileProjectileVelocityY;//4;//12;
var mainImageTileProjectileStepXMin=mainImageTileProjectileVelocityX;//4;//12;

var mainImageTileProjectileStepY=mainImageTileProjectileStepYMin;//20;
var mainImageTileProjectileStepX=mainImageTileProjectileStepYMin;//20;

var mainImageTileProjectileStepDestinationY=0;
var mainImageTileProjectileStepDestinationX=0;

//## --
//note: acceleration
//min 2; not 1
var mainImageTileFireballProjectileStepYMax=10;//6;//4;//20;//20;
var mainImageTileFireballProjectileStepXMax=10;//6;//4;//20;//20;

var mainImageTileFireballProjectileVelocityY=mainImageTileFireballProjectileStepYMax;//2;//4;//20;//4;//1;
var mainImageTileFireballProjectileVelocityX=mainImageTileFireballProjectileStepXMax;//2;//4;//20;//4;//1;

var mainImageTileFireballProjectileStepYMin=2;//4;//12; //mainImageTileFireballProjectileVelocityY
var mainImageTileFireballProjectileStepXMin=2;//4;//12; //mainImageTileFireballProjectileVelocityX

var mainImageTileFireballProjectileStepY=mainImageTileFireballProjectileStepYMax;//Min;//20;
var mainImageTileFireballProjectileStepX=mainImageTileFireballProjectileStepYMax;//Min; //20;

var mainImageTileFireballProjectileStepDestinationY=0;
var mainImageTileFireballProjectileStepDestinationX=0;

var bossMonsterImageTilePosX=500;
var bossMonsterImageTilePosY=10;

var iImageFrameWidth=32;// 64; //0;
var iImageFrameHeight=32;// 64;

var iImageFrameWidthLarge=64;
var iImageFrameHeightLarge=64;

var iImageFrameWidthDefault=32;
var iImageFrameHeightDefault=32;

//added by Mike, 20231121
var iMouseInputImageWidth=64;
var iMouseInputImageHeight=64;

var iMonsterAttackDamageDefault=1;
var iMonsterAttackDamageBoss=2;//3;

var iCurrTextCharacterCount=0;
var iCurrTextCharacterCountMax=0;
var sCurrText="";
var sText="";

//added by Mike, 20231128
var iTitlePressStartEffectDelayCount=0;
var iTitlePressStartEffectDelayCountMax=5;

var iHowToPlayGuideImageFrame2DelayCount=0;
var iHowToPlayGuideImageFrame2DelayCountMax=8;

var iTitleImageFrame2DelayCount=0;
const iTitleImageFrame2DelayCountMax=40;


//added by Mike, 20231119; from 20221121
var iDelayAnimationCountEnter=0;
const iDelayAnimationCountEnterMax=10;

//added by Mike, 20231121
var bHasViewedTitle=false;
var bHasPressedStart=false;

var iMonsterBossTileWidth=128;
var iMonsterBossTileHeight=128;

var iMainImageTileStepAngle=0;

var newMainImageTileProjectilePosX=0;
var newMainImageTileProjectilePosY=0;
var bHasFired=false;

var iMousePointPosX=0;
var iMousePointPosY=0;

const iKEY_W = 0;
const iKEY_S = 1;
const iKEY_A = 2;
const iKEY_D = 3;

const iTotalKeyCount = 4; //8; //12;
const iDirectionTotalKeyCount = 4; //8

//added by Mike, 20231125
//https://www.w3schools.com/js/js_arrays.asp; last accessed: 20220823
const arrayKeyPressed = [];
for (iCount=0; iCount<iTotalKeyCount; iCount++) {
	arrayKeyPressed[iCount]=false;
}

/*
var iFacingDirection=0;

const iFACING_DOWN=0;
const iFACING_UP=1;
const iFACING_LEFT=2;
const iFACING_RIGHT=3;
*/

//edited by Mike, 20221129
//1000/60=16.66; 60 frames per second
//1000/30=33.33; 30 frames
const fFramesPerSecondDefault=16.66;
//const fFramesPerSecondDefault=33.33;
var fFramesPerSecond=fFramesPerSecondDefault;
var iCurrentIntervalId=-1;

var mainImageTilePosX=0;
var mainImageTilePosY=0;
var mainImageTileStepX=2;//0; //2;
var mainImageTileStepY=2;//0; //2;

var mainImageTileProjectilePosX=0;
var mainImageTileProjectilePosY=0;

var mainImageTileFireballProjectilePosX=0;
var mainImageTileFireballProjectilePosY=0;
	
var bHasReachedDestinationY=false;
var bHasReachedDestinationX=false;

var bHasFireballReachedDestinationY=false;
var bHasFireballReachedDestinationX=false;
	
var iPrevMouseXPos=-1;
var iPrevMouseYPos=-1;
	
var bIsHeroFacingLeft=false;
		
	//added by Mike, 20241111
	var batMonsterImageTilePosX=0;
	var batMonsterImageTilePosY=0;
	var batMonsterTileStepX=2;
	var batMonsterTileStepY=2;
	var batMonsterTileStepDelay=0;	
	var batMonsterTileStepDelayMax=5;	
	var isBatMonsterTileActive=false;

	var miniBossMonsterImageTilePosX=0;
	var miniBossMonsterImageTilePosY=0;
	var miniBossMonsterTileStepX=2;
	var miniBossMonsterTileStepY=2;
	var miniBossMonsterTileStepDelay=0;	
	var miniBossMonsterTileStepDelayMax=5;	
	var isMiniBossMonsterTileActive=false;	
	
	var bossMonsterImageTilePosX=0;
	var bossMonsterImageTilePosY=0;
	var bossMonsterTileStepX=2;
	var bossMonsterTileStepY=2;
	var bossMonsterTileStepDelay=0;	
	var bossMonsterTileStepDelayMax=5;	
	var isBossMonsterTileActive=false;	

/*	
	var snakeMonsterImageTilePosX=0;
	var snakeMonsterImageTilePosY=0;
	var snakeMonsterTileStepX=2;
	var snakeMonsterTileStepY=2;
	var snakeMonsterTileStepDelay=0;	
	var snakeMonsterTileStepDelayMax=5;	
	var isSnakeMonsterTileActive=false;
*/
	var arraySnakeMonsterCountId = [[],[]];
	var iSnakeMonsterCountMax = 2;
	
	var arrayGrassMonsterCountId = [[],[],[],[]];
	var iGrassMonsterCountMax = 4;
/*
	var arraySlimeMonsterCountId = [[],[],[],[],[],[]];
	var iSlimeMonsterCountMax = 6;
*/
	var arraySlimeMonsterCountId = [[],[],[]];
	var iSlimeMonsterCountMax = 3;

//	var arrayMiniBossMonsterCountId = [[],[],[],[],[],[]]; //[],[],[],[],[],[]
//	var iMiniBossMonsterCountMax = 6;///12;//6;

	var arrayMiniBossMonsterCountId = [[],[],[],[],[],[],[],[],[],[],[],[]]; //[],[],[],[],[],[]
	const iMiniBossMonsterCountMax = 12;//6;

	
	const MONSTER_OBJECT=0;
	const MONSTER_IS_ACTIVE=1;	
	const MONSTER_POSX=2;
	const MONSTER_POSY=3;
	const MONSTER_STEPX=4;
	const MONSTER_STEPY=5;

	const MONSTER_ANIMATION_DELAY_COUNT=6;
	const MONSTER_ANIMATION_DELAY_COUNT_MAX=7;
	const MONSTER_ANIMATION_COUNT=8;
	const MONSTER_ANIMATION_COUNT_MAX=9;
	const MONSTER_STEP_DELAY=10;
	const MONSTER_STEP_DELAY_MAX=11;
	
	const MONSTER_IS_IN_RIVER=12;
	
	var iCurrMapLocation=53;//12;//0;		
	var hasInitMapLocation=false;	
		
	var iStageMaxWidth=640;
	var iStageMaxHeight=360;

	var iVerticalOffset=0;

	//note: for INNER SCREEN
	//edited by Mike, 20231126; itch.io; screen.width appears to cause incorrect output;
	//due to itch.io window top-left at 0;
	var iHorizontalOffset=0;
	var iVerticalOffsetInnerScreen=0;
	
	var iInnerHorizontalOffset=(640-iStageMaxHeight)/2;		
	var iInnerVerticalOffset=iImageFrameHeight/4;//2;

	function resetProjectile() {
		var mainImageTile = document.getElementById("mainImageTileImageId");

		var mainImageTileProjectile = document.getElementById("mainImageTileProjectileImageId");

		var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");
		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");

		var iFrameY=0;

		mainImageTileProjectilePosX = parseInt(mainImageTile.style.left);
		mainImageTileProjectilePosY =parseInt(mainImageTile.style.top);

		newMainImageTileProjectilePosX=parseInt(mainImageTileProjectilePosX);
		newMainImageTileProjectilePosY=parseInt(mainImageTileProjectilePosY);

		mainImageTileProjectile.style.left = mainImageTileProjectilePosX+"px";
		mainImageTileProjectile.style.top = mainImageTileProjectilePosY+"px";

		mainImageTileProjectile.style.visibility="hidden";
		bHasFired=false;		
		bIsHeroDash=false;
		//bHasHeroShotFireball=false;

		iMainImageTileStepAngle=0;

		mainImageTileProjectileStepY=mainImageTileProjectileStepYMin;//20;
		mainImageTileProjectileStepX=mainImageTileProjectileStepXMin;//20;

		bHasReachedDestinationY=false;
		bHasReachedDestinationX=false;
	
		//TODO: -add: idle animation
		
		iHeroAnimationCount=0; 

		mainImageTileTankBody.style.visibility="hidden";
		mainImageTileHeroBody.style.visibility="hidden";

		if (bIsHeroInTank) {
			if (bIsHeroFacingLeft) {
				iFrameY=iImageFrameHeightLarge*2;//64*2; 128;
			}
			else {
				iFrameY=iImageFrameHeightLarge*3;//64*3; 192;
			}
			
			mainImageTileTankBody.style.visibility="visible";

			mainImageTileTankBody.style.objectPosition = "-" + 0 + "px -" + iFrameY + "px";
		}
		else {
			if (bIsHeroInRiver) {
				if (bIsHeroFacingLeft) {
					iFrameY=iImageFrameHeight*0;//64*2; 128;
				}
				else {
					iFrameY=iImageFrameHeight*1;//64*3; 192;
				}
			}
			else {
				if (bIsHeroFacingLeft) {
					iFrameY=iImageFrameHeight*2;//64*2; 128;
				}
				else {
					iFrameY=iImageFrameHeight*3;//64*3; 192;
				}
			}

			mainImageTileHeroBody.style.visibility="visible";
			mainImageTileHeroBody.style.objectPosition = "-" + 0 + "px -" + iFrameY + "px";
		}
	}
	
	function resetFireballProjectile() {
		var mainImageTile = document.getElementById("mainImageTileImageId");
		var mainImageTileFireballProjectile = document.getElementById("mainImageTileFireballProjectileImageId");
		var mainImageTileFireballProjectileHold = document.getElementById("mainImageTileFireballProjectileHoldImageId");

		mainImageTileFireballProjectilePosX = 0+"px";//mainImageTile.style.left;
		mainImageTileFireballProjectilePosY = 0+"px";//mainImageTile.style.top;

		newMainImageTileFireballProjectilePosX=0; //mainImageTileProjectilePosX;
		newMainImageTileFireballProjectilePosY=0; //mainImageTileProjectilePosY;

		mainImageTileFireballProjectile.style.left = mainImageTileFireballProjectilePosX;
		mainImageTileFireballProjectile.style.top = mainImageTileFireballProjectilePosY;

		mainImageTileFireballProjectile.style.visibility="hidden";
		mainImageTileFireballProjectileHold.style.visibility="hidden";
				
		bHasFired=false;
		//bIsActionKeyPressed=false;
		bHasHeroShotFireball=false;

		iMainImageTileStepAngle=0;

		mainImageTileFireballProjectileStepY=mainImageTileFireballProjectileStepYMax; //Min;//20;
		mainImageTileFireballProjectileStepX=mainImageTileFireballProjectileStepXMax; //Min;//20;
	}	

	function drawGridBuggy(myCanvasContext, iXPos, iYPos) {
/*	
		iMiniMapRoomWidth=5;
		iMiniMapRoomHeight=5;		
		iMiniMapSpacing=2;
		
		iMiniMapRowCountMax=5;
		iMiniMapColumnCountMax=3;		
*/

		//myCanvasContext.fillStyle = "#0da200"; //"#ff0000";
		
		//alert(iInnerHorizontalOffset);
		
		//alert(iStageMaxHeight);
		//alert(iStageMaxWidth);		
		//alert(iInnerHorizontalOffset);
		
		//0+iHorizontalOffset+iStageMaxWidth/2
		
		myCanvasContext.strokeStyle = "#0da200";
		
		myCanvasContext.beginPath();
		myCanvasContext.rect(0+iXPos, 0+iYPos, 0+iStageMaxHeight-iInnerHorizontalOffset*1.5, iStageMaxHeight);
		myCanvasContext.stroke();
		
/*
		//horizontal
    	for (var iRowCount=0; iRowCount<iMiniMapRowCountMax; iRowCount++) {
    		for (var iColumnCount=0; iColumnCount<iMiniMapColumnCountMax; iColumnCount++) {
				myCanvasContext.fillStyle = "#ffffff"; //"#ff0000";
				
				myCanvasContext.fillRect(0+iXPos+iColumnCount*iMiniMapRoomWidth+iMiniMapSpacing*iColumnCount, 0+iYPos+iRowCount*iMiniMapRoomHeight+iMiniMapSpacing*iRowCount, iMiniMapRoomWidth, iMiniMapRoomHeight);
			}
		}		
*/		
		//alert(iCurrMapLocation)
		
		//myCanvasContext.fillStyle = "#ff0000"; //"#ffffff";		
	}
	

	//added by Mike, 20241115
	//reference: 
	//1) Game Off 2023: Battle Tactics
	//2) https://www.w3schools.com/graphics/canvas_lines.asp; last accessed: 20241115
	function drawMiniMap(myCanvasContext, iXPos, iYPos) {
		iMiniMapRoomWidth=5;
		iMiniMapRoomHeight=5;		
		iMiniMapSpacing=2;
		
		iMiniMapRowCountMax=iRowCountMax;//5;
		iMiniMapColumnCountMax=iColumnCountMax;//5;//3;		
		
/*		
		myCanvasContext.fillStyle = "#ffffff"; //"#ff0000";
		myCanvasContext.fillRect(0+iXPos, 0+iYPos, iMiniMapRoomHeight, iMiniMapRoomHeight);
*/		

		//horizontal
    	for (var iRowCount=0; iRowCount<iMiniMapRowCountMax; iRowCount++) {
    		for (var iColumnCount=0; iColumnCount<iMiniMapColumnCountMax; iColumnCount++) {
				
				if (arrayHasVisitedRoom[iColumnCount][iRowCount]==1) {
					myCanvasContext.fillStyle = "#ffffff"; //"#ff0000";
				}
				else {
					myCanvasContext.fillStyle = "#3e2900"; //"#ff0000";
				}
				
				myCanvasContext.fillRect(0+iXPos+iColumnCount*iMiniMapRoomWidth+iMiniMapSpacing*iColumnCount, 0+iYPos+iRowCount*iMiniMapRoomHeight+iMiniMapSpacing*iRowCount, iMiniMapRoomWidth, iMiniMapRoomHeight);
			}
		}		
		
		//alert(iCurrMapLocation)
		
		//myCanvasContext.fillStyle = "#ff0000"; //"#ffffff";
		
		//example: 53
		iRowCount=parseInt(iCurrMapLocation/10);
		iColumnCount=iCurrMapLocation-iRowCount*10;
/*		
		alert("iRowCount: "+iRowCount);
		alert("iColumnCount: "+iColumnCount);
*/		
/*
		iRowCount-=1;
		iColumnCount-=1;
*/
		
		if (iMiniMapAnimationDelayCount==iMiniMapAnimationDelayCountMax) {
			iMiniMapAnimationCount=(iMiniMapAnimationCount+1)%5; //last hidden

			iMiniMapAnimationDelayCount=0;
		}
		else {
			iMiniMapAnimationDelayCount++;
		}

		//iMiniMapAnimationCount=(iMiniMapAnimationCount+1)%5;
		
		if (iMiniMapAnimationCount==0) {
			//myCanvasContext.fillStyle = "#ff0000"; //"#ffffff";
/*			
			myCanvasContext.strokeStyle = "#ff0000";
			
			myCanvasContext.beginPath();
			
			myCanvasContext.rect(0+iXPos+iColumnCount*iMiniMapRoomWidth+iMiniMapSpacing*iColumnCount, 0+iYPos+iRowCount*iMiniMapRoomHeight+iMiniMapSpacing*iRowCount, iMiniMapRoomWidth, iMiniMapRoomHeight);

			myCanvasContext.stroke();
*/			
			myCanvasContext.fillStyle = "#ff7f27"; //"#000000"; //"#00c7ff"; //"#ff0000";
			myCanvasContext.fillRect(0+iXPos+iColumnCount*iMiniMapRoomWidth+iMiniMapSpacing*iColumnCount, 0+iYPos+iRowCount*iMiniMapRoomHeight+iMiniMapSpacing*iRowCount, iMiniMapRoomWidth, iMiniMapRoomHeight);			

		}
		else {			
			myCanvasContext.fillStyle = "#ffffff";
			myCanvasContext.fillRect(0+iXPos+iColumnCount*iMiniMapRoomWidth+iMiniMapSpacing*iColumnCount, 0+iYPos+iRowCount*iMiniMapRoomHeight+iMiniMapSpacing*iRowCount, iMiniMapRoomWidth, iMiniMapRoomHeight);			
		}		
	}
	
	function drawHeroLifeBar(myCanvasContext, iXPos, iYPos) {

/*	
		var textLifeBarDiv = document.getElementById("textLifeBarDivId");
		
		textLifeBarDiv.style.visibility="visible";
		textLifeBarDiv.style.left=0+iXPos+"px"; //+iImageFrameWidthDefault
		textLifeBarDiv.style.top=0+iYPos+"px"; //+iImageFrameHeightDefault*0.9
				
		textLifeBarDiv.innerHTML = "HP";
*/			
/*	
		var heroLifeBarStatusImageTile = document.getElementById("heroLifeBarStatusImageTileId");

		heroLifeBarStatusImageTile.style.visibility="visible";
		heroLifeBarStatusImageTile.style.left=0+iXPos+"px"; 
		heroLifeBarStatusImageTile.style.top=0+iYPos+"px";
*/		
		var iHeroLifeBarWidth=4;
		var iHeroLifeBarHeight=4;		
		var iHeroLifeBarSpacing=0;//1;
			
		//var iCurrHeroLife=10;

		myCanvasContext.fillStyle = "#2d2622"; //"#736157"; //#ffffff; //"#ff0000";	
		myCanvasContext.fillRect(0+iXPos, 0+iYPos, iHeroLifeBarWidth*iCurrHeroLifeMax, iHeroLifeBarHeight);

		if (iCurrHeroLife>=5) {
			myCanvasContext.fillStyle = "#00c7ff"; //sky blue
		}
		else if (iCurrHeroLife>=2) {
			myCanvasContext.fillStyle = "#ff6b00"; //orange
		}
		else {
/*		
			//myCanvasContext.fillStyle = "#ff0000"; //red
			iCurrHeroLifeAnimationDelayCount=(iCurrHeroLifeAnimationDelayCount+1)%iCurrHeroLifeAnimationDelayCountMax;

			if (iCurrHeroLifeAnimationDelayCount==0) {
				myCanvasContext.fillStyle = "#000000"; //black
			}			
			else {
				myCanvasContext.fillStyle = "#ff0000"; //red		
			}
*/
			//Game Off 2021; TUGON
			if (iCurrHeroLifeAnimationDelayCount<10) {//5) {
				myCanvasContext.fillStyle = "#ff0000"; //red	
			}
			else {
				if (iCurrHeroLifeAnimationDelayCount>20) {//10) {
					iCurrHeroLifeAnimationDelayCount=0;
				}
				myCanvasContext.fillStyle = "#000000"; //black
			}			
			iCurrHeroLifeAnimationDelayCount++;			
		}
		
		//myCanvasContext.fillRect(0+iXPos, 0+iYPos, iHeroLifeBarWidth*iCurrHeroLife, iHeroLifeBarHeight);
		
		//textLifeBarDiv.clientWidth
		
		myCanvasContext.fillRect(0+iXPos, 0+iYPos, iHeroLifeBarWidth*iCurrHeroLife, iHeroLifeBarHeight);
	}	
	

	function drawHeroManaBar(myCanvasContext, iXPos, iYPos) {	

		var mainImageTileFireballProjectile = document.getElementById("mainImageTileFireballProjectileImageId");
/*
		var textManaBarDiv = document.getElementById("textManaBarDivId");
				
		//textManaBarDiv.style.visibility="visible";
		textManaBarDiv.style.visibility="hidden";

		textManaBarDiv.style.left=0+iXPos+"px"; //+iImageFrameWidthDefault
		textManaBarDiv.style.top=0+iYPos+"px"; //+iImageFrameHeightDefault*0.9
				
		textManaBarDiv.innerHTML = "MP";
*/
/*
		var heroLifeBarStatusImageTile = document.getElementById("heroLifeBarStatusImageTileId");
*/

/*		//goes up
		var iHeroManaBarWidth=10;
		var iHeroManaBarHeight=4*iCurrHeroManaMax;		
*/
		var iHeroManaBarWidth=4;
		var iHeroManaBarHeight=4;		

		var iHeroManaBarSpacing=0;//1;
		var iHeroManaBarPaddingX=2;
		var iHeroManaBarPaddingY=2;

/*		
		var iCurrHeroManaMax=10; //recharge
		var iCurrHeroMana=iCurrHeroManaMax; 
*/		

		myCanvasContext.fillStyle = "#2d2622"; //"#736157"; //#ffffff; //"#ff0000";	
		myCanvasContext.fillRect(0+iXPos, 0+iYPos, iHeroManaBarWidth*iCurrHeroManaMax, iHeroManaBarHeight);


//		if ((bHasFireballReachedDestinationX) && (bHasFireballReachedDestinationY)){
			//iCurrHeroMana=iCurrHeroManaMax;
		if (mainImageTileFireballProjectile.style.visibility=="hidden") {
		
			if (iCurrHeroProjectileManaAnimationDelayCount==iCurrHeroProjectileManaAnimationDelayCountMax) {
				if (iCurrHeroMana<iCurrHeroManaMax) {
					iCurrHeroMana++;
				}			
				iCurrHeroProjectileManaAnimationDelayCount=0;
			}
			else {
				iCurrHeroProjectileManaAnimationDelayCount++;
			}
		}
			
/*
		myCanvasContext.fillStyle = "#ffffff"; //white		
		myCanvasContext.fillRect(0+iXPos+textManaBarDiv.innerHTML.length*6-iHeroManaBarPaddingX, 0+iYPos-iHeroManaBarPaddingY, iHeroManaBarWidth*iCurrHeroManaMax+iHeroManaBarPaddingX, iHeroManaBarHeight+iHeroManaBarPaddingY);
*/		

		//myCanvasContext.fillStyle = "#000000"; //black		
		//myCanvasContext.fillStyle = "#ff6b00"; //orange
		//myCanvasContext.fillStyle = "#00dd00";

		//Game Off 2021; TUGON
		if (iCurrHeroManaAnimationDelayCount<10) {//5) {
			myCanvasContext.fillStyle = "#00dd00";
		}
		else {
			if (iCurrHeroManaAnimationDelayCount>20) {//10) {
				iCurrHeroManaAnimationDelayCount=0;
			}
			myCanvasContext.fillStyle = "#00cc00";
		}	
		iCurrHeroManaAnimationDelayCount++;


		myCanvasContext.fillRect(0+iXPos, 0+iYPos, iHeroManaBarWidth*iCurrHeroMana, iHeroManaBarHeight);
		
		//*iCurrHeroManaMax
		
		//OK; goes up
		//myCanvasContext.fillRect(0+iXPos+textManaBarDiv.innerHTML.length*4, 0+iYPos, iHeroManaBarWidth, -iHeroManaBarHeight/iCurrHeroManaMax*(iCurrHeroMana));

	}		

	function drawPearlStatus(myCanvasContext, iXPos, iYPos) {	
		var pearlStatusImageTile = document.getElementById("pearlStatusImageTileId");
		var textPearlStatusDiv = document.getElementById("textPearlStatusDivId");
				
		pearlStatusImageTile.style.visibility="visible";				
		pearlStatusImageTile.style.left=0+iXPos+"px";
		pearlStatusImageTile.style.top=0+iYPos+iImageFrameHeightDefault*1+"px";
		
		textPearlStatusDiv.style.visibility="visible";
		textPearlStatusDiv.style.left=0+iXPos+iImageFrameWidthDefault+"px";
		//note: pearl position centered within image file vertically
		textPearlStatusDiv.style.top=0+iYPos+iImageFrameHeightDefault*0.9+"px";
				
		textPearlStatusDiv.innerHTML = "x"+iCurrPearlCount;
		
		
/*	
		var iHeroLifeBarWidth=4;
		var iHeroLifeBarHeight=4;		
		var iHeroLifeBarSpacing=0;//1;
			
		//var iCurrHeroLife=10;

		//myCanvasContext.fillStyle = "#00c7ff"; //00d9ff; //"#ff0000";

		if (iCurrHeroLife>=5) {
			myCanvasContext.fillStyle = "#00c7ff";		
		}
		else if (iCurrHeroLife>=2) {
			myCanvasContext.fillStyle = "#ff6b00"; //orange
		}
		else {
			myCanvasContext.fillStyle = "#ff0000"; //red
		}
		
		myCanvasContext.fillRect(0+iXPos, 0+iYPos, iHeroLifeBarWidth*iCurrHeroLife, iHeroLifeBarHeight);
*/		
	}	
	
	function drawMonsterDeathStatus(myCanvasContext, iXPos, iYPos) {		
		var deathCountImageTile = document.getElementById("deathCountImageId");	
		var textMonsterDeathStatusDiv = document.getElementById("textMonsterDeathStatusDivId");

		deathCountImageTile.style.visibility="visible";
		deathCountImageTile.style.left=0+iXPos+iImageFrameWidthDefault+"px";
		deathCountImageTile.style.top=0+iYPos+iImageFrameHeightDefault*1+"px";

		textMonsterDeathStatusDiv.style.visibility="visible";
		textMonsterDeathStatusDiv.style.left=parseInt(deathCountImageTile.style.left)+iImageFrameWidthDefault+"px"
		textMonsterDeathStatusDiv.style.top=0+iYPos+iImageFrameHeightDefault*0.9+"px";
				
		if (iCurrMonsterDeathCount>999) {
			iCurrMonsterDeathCount=999; //BAD ENDING...? how to reach 999? the faster?!
		}		
				
		textMonsterDeathStatusDiv.innerHTML = "x"+iCurrMonsterDeathCount;		
	}	
	
	function drawKeyStatus(myCanvasContext, iXPos, iYPos) {	
		var keyStatusImageTile = document.getElementById("keyStatusImageTileId");
		//var textPearlStatusDiv = document.getElementById("textPearlStatusDivId");
				
		keyStatusImageTile.style.visibility="visible";				
		keyStatusImageTile.style.left=0+iXPos+"px";
		keyStatusImageTile.style.top=0+iYPos+iImageFrameHeightDefault*1+"px";

/*		
		textPearlStatusDiv.style.visibility="visible";
		textPearlStatusDiv.style.left=0+iXPos+iImageFrameWidthDefault+"px";
		//note: pearl position centered within image file vertically
		textPearlStatusDiv.style.top=0+iYPos+iImageFrameHeightDefault*0.9+"px";
				
		textPearlStatusDiv.innerHTML = "x"+iCurrPearlCount;
*/		
	}		

	function drawAmuletStatus(myCanvasContext, iXPos, iYPos) {	
		var amuletStatusImageTile = document.getElementById("amuletStatusImageTileId");

		//var iFrameY=0;
		var iFrameY=iImageFrameHeight*3;	

/*		
		if (iAmuletStatusAnimationDelayCount>=iAmuletStatusAnimationDelayCountMax) {			
			iAmuletStatusAnimationCount=(iAmuletStatusAnimationCount+1)%2;

			iAmuletStatusAnimationDelayCount=0;
		}
		else {
			iAmuletStatusAnimationDelayCount++;
		}
		
		amuletStatusImageTile.style.objectPosition = "-" + iImageFrameWidthDefault*2-iImageFrameWidthDefault*(iAmuletStatusAnimationCount) + "px -" + iFrameY + "px";
*/
		//Game Off 2021; TUGON
		if (iAmuletStatusAnimationDelayCount<5) {//5) {
			//riverImageRight.style.objectPosition = "-" + 0 + "px -" + iFrameY + "px";
			iAmuletStatusAnimationCount=0;
		}
		else {
			if (iAmuletStatusAnimationDelayCount>10) {//10) {
				iAmuletStatusAnimationDelayCount=0;
			}
			//riverImageRight.style.objectPosition = "-" + iRiverImageFrameWidth + "px -" + iFrameY + "px";
			iAmuletStatusAnimationCount=1;
		}			
		iAmuletStatusAnimationDelayCount++;	

		amuletStatusImageTile.style.objectPosition = "-" + iImageFrameWidthDefault*2-iImageFrameWidthDefault*(iAmuletStatusAnimationCount) + "px -" + iFrameY + "px";		

						
		amuletStatusImageTile.style.visibility="visible";				
		amuletStatusImageTile.style.left=0+iXPos+"px";
		amuletStatusImageTile.style.top=0+iYPos+iImageFrameHeightDefault*1+"px";
	}			

	function initTest() {
		iCurrHeroLife=iCurrHeroLifeMax;
		
		bHasPressedStart=false;
  		bHasViewedHowToPlayGuide=false;
		bHasViewedTitle=false;
		bIsMissionDone=false;
		
		//------------
		//note: not played during onLoad(), unless in ITCH.IO...
		myAudio = document.getElementById("myAudioId");
		
        myAudio.setAttribute("src", sAudioBGM);

        var fMyAudioVolume=1.0;//0.4;
        myAudio.volume=fMyAudioVolume;
        myAudio.loop=true;		
        myAudio.play();
		//-----------			
	}

	function init() {	
		bIsGameOver=false;		
		dElapsedTimeInSeconds=0;
		
		iInputDelayAtGameOverCount=0;
		
		iHeroInvincibileCount=0;
		bIsHeroAttacked=false;
		bIsExecutingShake=false;
		iDestroyHumanShakeDelayCount=0;
		
		bHasPressedStart=false;
  		bHasViewedHowToPlayGuide=false;
		bHasViewedTitle=false;
		bIsMissionDone=false;
		bIsMissionStarted=false;	
		bHasViewedMissionIntro=false;
		bIsHeroInTank=false;
		bIsHeroDash=false;
		bHasHeroShotFireball=false;
		
		bHasPlayedSolvedTune=false;
		
		iBatMonsterAnimationCount=-1;//0; start at -1
		iBatMonsterAnimationCountMax=5;
		iBatMonsterAnimationDelayCount=10; //bat; //0
		iBatMonsterAnimationDelayCountMax=6;

		iGrassCutEffectAnimationCount=-1; //0; //due to immediately +1 in execution;
		iGrassCutEffectAnimationCountMax=5;
		iGrassCutEffectAnimationDelayCount=0;
		iGrassCutEffectAnimationDelayCountMax=4;//1;

		iPearlAnimationCount=-1; //0; //due to immediately +1 in execution;
		iPearlAnimationCountMax=5;
		iPearlAnimationDelayCount=0;
		iPearlAnimationDelayCountMax=2;
		iPearlInvincibileCount=0;
		//iPearlInvincibileCountMax=10;
		bHasObtainedPearlAtRoom42=false;
		bHasObtainedPearlAtRoom41=false;
		bHasObtainedPearlAtRoom33=false;
		bHasObtainedPearlAtRoom43=false;
		bHasObtainedPearlAtRoom22=false;
		//bHasObtainedPearlAtRoom11=false;
		bHasObtainedKeyAtRoom1=false;
		bHasUsedKeyAtRoom11=false;
		bHasObtainedAmuletAtRoom32=false;
		bHasObtainedPearlAtRoom12=false;

		iBossMonsterAnimationCount=-1;//0; start at -1
		iBossMonsterAnimationCountMax=5;
		iBossMonsterAnimationDelayCount=10; //0
		iBossMonsterAnimationDelayCountMax=10;
		iBossMonsterHitAnimationCount=-1;//0; start at -1
		iBossMonsterHitAnimationCountMax=5;
		iBossMonsterMovementDelayCount=-1;//0; start at -1
		//iBossMonsterMovementDelayCountMax=20;

		iMiniMapAnimationCount=-1;//0; start at -1
		iMiniMapAnimationCountMax=5;
		iMiniMapAnimationDelayCount=0; //0
		iMiniMapAnimationDelayCountMax=5;

		iExplosionEffectAnimationCount=-1; //0; //due to immediately +1 in execution;
		iExplosionEffectAnimationCountMax=5;
		iExplosionEffectAnimationDelayCount=0;
		iExplosionEffectAnimationDelayCountMax=4;//1;

		iMonsterExplosionEffectAnimationCount=-1; //0; //due to immediately +1 in execution;
		iMonsterExplosionEffectAnimationCountMax=5;
		iMonsterExplosionEffectAnimationDelayCount=0;
		iMonsterExplosionEffectAnimationDelayCountMax=2;//4;//1;

		iDustEffectAnimationCount=-1; //0; //due to immediately +1 in execution;
		iDustEffectAnimationCountMax=5;
		iDustEffectAnimationDelayCount=0;
		iDustEffectAnimationDelayCountMax=4;//1;

		iHeroAttackEffectAnimationCount=-1; //0; //due to immediately +1 in execution;
		iHeroAttackEffectAnimationCountMax=5;
		iHeroAttackEffectAnimationDelayCount=0;
		iHeroAttackEffectAnimationDelayCountMax=2;//4;//1;

		iHeroAnimationCount=-1; //0; //due to immediately +1 in execution;
		iHeroAnimationCountMax=5;
		iHeroAnimationDelayCount=0;
		iHeroAnimationDelayCountMax=5;//2;//1; //TODO: -add: more dust effect if target walking distance is far

		var mouseInputImage = document.getElementById("mouseInputImageId");
		var titleImage = document.getElementById("titleImageId");
		var titleImageFrame2 = document.getElementById("titleImageFrame2Id");

		var howToPlayGuideImage = document.getElementById("howToPlayGuideImageId");
		var howToPlayGuideImageFrame2 = document.getElementById("howToPlayGuideImageFrame2Id");
		var bossBattleBgImage = document.getElementById("bossBattleBgImageId");			
		var bossBattleBgImageBeach = document.getElementById("bossBattleBgImageBeachId");			
		var bossBattleBgImageBeachPart2 = document.getElementById("bossBattleBgImageBeachPart2Id");			
		
		var bossBattleBgImagePart2 = document.getElementById("bossBattleBgImagePart2Id");		
		var bossBattleBgImagePart3 = document.getElementById("bossBattleBgImagePart3Id");		

		var textStatusDiv = document.getElementById("textStatusDivId");
		var textStatusBackgroundDiv = document.getElementById("textStatusBackgroundDivId");
		var myCanvasTwo = document.getElementById("myCanvasTwoId");

		//var grassBgImage = document.getElementById("grassBgImageId");			
		
		var mainImageTile = document.getElementById("mainImageTileImageId");
		var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");
		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");
		var mainImageTileProjectile = document.getElementById("mainImageTileProjectileImageId");
		var mainImageTileFireballProjectile = document.getElementById("mainImageTileFireballProjectileImageId");
		var mainImageTileFireballProjectileHold = document.getElementById("mainImageTileFireballProjectileHoldImageId");

		var doorImageRight = document.getElementById("doorImageRightId");		
		var doorImageLeft = document.getElementById("doorImageLeftId");
		var doorImageTop = document.getElementById("doorImageTopId");
		var doorImageBottom = document.getElementById("doorImageBottomId");

		var doorLockedImageRight = document.getElementById("doorLockedImageRightId");				
		var riverImageRight = document.getElementById("riverImageRightId");		

		var batMonsterImageTile = document.getElementById("batMonsterImageId");

		var bossMonsterImageTile = document.getElementById("bossMonsterImageId");

		var explosionEffectImage = document.getElementById("explosionEffectImageId");
		var fireballExplosionEffectImage = document.getElementById("fireballExplosionEffectImageId");
		
		var grassCutEffectImage = document.getElementById("grassCutEffectImageId");
		var pearlImageTile = document.getElementById("pearlImageTileId");
		var pearlStatusImageTile = document.getElementById("pearlStatusImageTileId");

		var textMonsterDeathStatusDiv = document.getElementById("textMonsterDeathStatusDivId");

		var keyImageTile = document.getElementById("keyImageTileId");
		var keyStatusImageTile = document.getElementById("keyStatusImageTileId");

		var amuletImageTile = document.getElementById("amuletImageTileId");
		var amuletStatusImageTile = document.getElementById("amuletStatusImageTileId"); 

		var heroLifeBarStatusImageTile = document.getElementById("heroLifeBarStatusImageTileId"); 

		var myFavicon = document.getElementById("faviconImageId");
		var deathCountImageTile = document.getElementById("deathCountImageId");

		var textTimeDiv = document.getElementById("textTimeDivId");
		var textPearlStatusDiv = document.getElementById("textPearlStatusDivId");
		var textLifeBarDiv = document.getElementById("textLifeBarDivId");
		var textManaBarDiv = document.getElementById("textManaBarDivId");
		var textMonsterDeathDiv = document.getElementById("textMonsterDeathDivId");

		var titleImage = document.getElementById("titleImageId");
		var textEnterDiv = document.getElementById("textEnterDivId");
		
		var textNewGameDiv = document.getElementById("textNewGameDivId");
		var textContinueGameDiv = document.getElementById("textContinueGameDivId");

		//--------------------
		mouseInputImage.style.visibility="hidden";
		titleImage.style.visibility="visible";
		titleImageFrame2.style.visibility="hidden";
		
		howToPlayGuideImage.style.visibility="hidden";
		howToPlayGuideImageFrame2.style.visibility="hidden";		
		bossBattleBgImage.style.visibility="hidden";
		bossBattleBgImageBeach.style.visibility="hidden";
		bossBattleBgImageBeachPart2.style.visibility="hidden";

		bossBattleBgImagePart2.style.visibility="hidden";
		bossBattleBgImagePart3.style.visibility="hidden";
		textStatusDiv.style.visibility="hidden";
		textStatusBackgroundDiv.style.visibility="hidden";
		myCanvasTwo.style.visibility="hidden";
		
		//grassBgImage.style.visibility="hidden";
		
		mainImageTile.visibility="hidden";
		mainImageTileTankBody.visibility="hidden";
		mainImageTileHeroBody.visibility="hidden";
		mainImageTileProjectile.visibility="hidden";		
		mainImageTileFireballProjectile.visibility="hidden";		
		mainImageTileFireballProjectileHold.visibility="hidden";		
		
		doorImageRight.style.visibility="hidden";
		doorImageLeft.style.visibility="hidden";
		doorImageTop.style.visibility="hidden";
		doorImageBottom.style.visibility="hidden";

		doorLockedImageRight.style.visibility="hidden";
		riverImageRight.style.visibility="hidden";

		batMonsterImageTile.style.visibility="hidden";
		bossMonsterImageTile.style.visibility="hidden";
		
		explosionEffectImage.style.visibility="hidden";
		grassCutEffectImage.style.visibility="hidden";
		pearlImageTile.style.visibility="hidden";
		pearlStatusImageTile.style.visibility="hidden";

		keyImageTile.style.visibility="hidden";
		keyStatusImageTile.style.visibility="hidden";
		
		amuletImageTile.style.visibility="hidden";
		amuletStatusImageTile.style.visibility="hidden";		
		
		myFavicon.style.visibility="hidden";
		deathCountImageTile.style.visibility="hidden";

		textTimeDiv.style.visibility="hidden";
		textPearlStatusDiv.style.visibility="hidden";
		textLifeBarDiv.style.visibility="hidden";
		textManaBarDiv.style.visibility="hidden";
		
		textMonsterDeathStatusDiv.style.visibility="hidden";

		titleImage.style.visibility="hidden";
		textEnterDiv.style.visibility="visible";
		
		textNewGameDiv.style.visibility="hidden";
		textContinueGameDiv.style.visibility="hidden";
				
		//--------------------
		myCanvasTwo.style.top = (iVerticalOffsetInnerScreen+0)+"px";
		myCanvasTwo.style.left = iHorizontalOffset+"px";

		mainImageTilePosX=iStageMaxWidth/2-iImageFrameWidth/2;
		mainImageTilePosY=iStageMaxHeight/2-iImageFrameHeight;

		mainImageTile.style.left = (iHorizontalOffset+mainImageTilePosX)+"px";
		mainImageTile.style.top = (iVerticalOffsetInnerScreen+mainImageTilePosY)+"px";
		
		mainImageTileTankBody.style.left = mainImageTile.style.left;
		mainImageTileTankBody.style.top = mainImageTile.style.top;

		mainImageTileHeroBody.style.left = mainImageTile.style.left;
		mainImageTileHeroBody.style.top = mainImageTile.style.top;
		
		textTimeDiv.innerHTML = "00:00:00";
		textPearlStatusDiv.innerHTML = "x0";
		//textLifeBarDiv.innerHTML = "LIFE";
/*		
		textMonsterDeathStatusDiv.innerHTML = "x0";
*/
		
		textNewGameDiv.innerHTML = "NEW GAME";
		textNewGameDiv.style.left = iHorizontalOffset+iStageMaxWidth/2-textNewGameDiv.clientWidth/2+"px";
		//textNewGameDiv.style.top= iVerticalOffsetInnerScreen+iStageMaxHeight/2-textNewGameDiv.clientHeight+"px";						
		textNewGameDiv.style.top= iVerticalOffsetInnerScreen+textNewGameDiv.clientHeight*2+"px";						
		textContinueGameDiv.innerHTML = "CONTINUE";
		textContinueGameDiv.style.left = iHorizontalOffset+iStageMaxWidth/2-textContinueGameDiv.clientWidth/2+"px";
		textContinueGameDiv.style.top= iVerticalOffsetInnerScreen+textContinueGameDiv.clientHeight*4+"px";		

		////var myCanvasTwo = document.getElementById("myCanvasTwoId");
		////myCanvasTwo.style.visibility="hidden";
			
		var iCurrMapLocation=53;		
		var hasInitMapLocation=false;
		
		for (iRowCount=0; iRowCount<iRowCountMax; iRowCount++) {				
			for (iColumnCount=0; iColumnCount<iColumnCountMax; iColumnCount++) {
				arrayHasVisitedRoom[iColumnCount][iRowCount]=0;
			}
		}			
		

		//------------
		//note: not played during onLoad(), unless in ITCH.IO...
		myAudio = document.getElementById("myAudioId");
		
        myAudio.setAttribute("src", sAudioBGM);

        var fMyAudioVolume=1.0;//0.4;
        myAudio.volume=fMyAudioVolume;
        myAudio.loop=true;		
        myAudio.play();

		//alert("DITO");	
		//-----------		

		myAudioPart2 = document.getElementById("myAudioPart2Id");		
		myAudioPart2.setAttribute("src", sAudioBGMPart2);

		var fMyAudioPart2Volume=1.0;//0.4;
		myAudioPart2.volume=fMyAudioPart2Volume;
		myAudioPart2.loop=true;		
		//myAudioPart2.play();

		//-----------		

		myAudioPart3 = document.getElementById("myAudioPart3Id");		
		myAudioPart3.setAttribute("src", sAudioBGMPart3);

		var fMyAudioPart3Volume=0.5;//0.4;
		myAudioPart3.volume=fMyAudioPart3Volume;
		myAudioPart3.loop=true;		
		//myAudioPart3.play();

		//-----------		
			
		myAudioBossScreech = document.getElementById("myAudioBossScreechId");		
		myAudioBossScreech.setAttribute("src", sAudioEffectBossScreech);

		var fMyAudioBossScreechVolume=1.0;//0.4;
		myAudioBossScreech.volume=fMyAudioBossScreechVolume;
		myAudioBossScreech.loop=false;		
		//myAudioBossScreech.play();		
		//-----------		

		myAudioWater = document.getElementById("myAudioWaterId");		
		myAudioWater.setAttribute("src", sAudioEffectWater);

		var fMyAudioWaterVolume=1.0;//0.4;
		myAudioWater.volume=fMyAudioWaterVolume;
		myAudioWater.loop=false;		
		//myAudioBossScreech.play();		
		//-----------		
		
		//note: set this here;
		keyImageTile.style.objectPosition = "-" + iImageFrameWidthDefault*0 + "px -" + iImageFrameHeight*3 + "px";

		keyStatusImageTile.style.objectPosition = "-" + iImageFrameWidthDefault*0 + "px -" + iImageFrameHeight*3 + "px";
		
		amuletImageTile.style.objectPosition = "-" + iImageFrameWidthDefault*2 + "px -" + iImageFrameHeight*3 + "px";

		amuletStatusImageTile.style.objectPosition = "-" + iImageFrameWidthDefault*2 + "px -" + iImageFrameHeight*3 + "px";		
		
		//heroLifeBarStatusImageTile.style.visibility="visible";
		heroLifeBarStatusImageTile.style.left=0+iImageFrameWidthDefault*.1+"px"; 
		heroLifeBarStatusImageTile.style.top=0+iImageFrameWidthDefault*.1+"px";
				
/*
		var snakeMonsterImageTile = document.getElementById("snakeMonsterImageId");		
		snakeMonsterImageTile.style.visibility="hidden";
*/

		for (iCount=0; iCount<iSnakeMonsterCountMax; iCount++) {
			arraySnakeMonsterCountId[iCount][MONSTER_OBJECT]= document.getElementById("snakeMonsterImageId"+iCount);
			
			arraySnakeMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="hidden";			
			arraySnakeMonsterCountId[iCount][MONSTER_IS_ACTIVE]=false;

			arraySnakeMonsterCountId[iCount][MONSTER_POSX]=0;
			arraySnakeMonsterCountId[iCount][MONSTER_POSY]=0;
			arraySnakeMonsterCountId[iCount][MONSTER_STEPX]=2;
			arraySnakeMonsterCountId[iCount][MONSTER_STEPY]=2;			
			
			arraySnakeMonsterCountId[iCount][MONSTER_ANIMATION_DELAY_COUNT]=10;
			arraySnakeMonsterCountId[iCount][MONSTER_ANIMATION_DELAY_COUNT_MAX]=6;		

			arraySnakeMonsterCountId[iCount][MONSTER_ANIMATION_COUNT]=-1;		
			arraySnakeMonsterCountId[iCount][MONSTER_ANIMATION_COUNT_MAX]=5;		

			arraySnakeMonsterCountId[iCount][MONSTER_STEP_DELAY]=0;		
			arraySnakeMonsterCountId[iCount][MONSTER_STEP_DELAY_MAX]=5;		
			
			arraySnakeMonsterCountId[iCount][MONSTER_IS_IN_RIVER]=false;		
		}
	
		for (iCount=0; iCount<iGrassMonsterCountMax; iCount++) {
			arrayGrassMonsterCountId[iCount][MONSTER_OBJECT]= document.getElementById("grassMonsterImageId"+iCount);
			
			arrayGrassMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="hidden";			
			arrayGrassMonsterCountId[iCount][MONSTER_IS_ACTIVE]=false;

			arrayGrassMonsterCountId[iCount][MONSTER_POSX]=0;
			arrayGrassMonsterCountId[iCount][MONSTER_POSY]=0;
			arrayGrassMonsterCountId[iCount][MONSTER_STEPX]=2;
			arrayGrassMonsterCountId[iCount][MONSTER_STEPY]=2;			
			
			arrayGrassMonsterCountId[iCount][MONSTER_ANIMATION_DELAY_COUNT]=10;
			arrayGrassMonsterCountId[iCount][MONSTER_ANIMATION_DELAY_COUNT_MAX]=6;		

			arrayGrassMonsterCountId[iCount][MONSTER_ANIMATION_COUNT]=-1;		
			arrayGrassMonsterCountId[iCount][MONSTER_ANIMATION_COUNT_MAX]=5;		

			arrayGrassMonsterCountId[iCount][MONSTER_STEP_DELAY]=0;		
			arrayGrassMonsterCountId[iCount][MONSTER_STEP_DELAY_MAX]=5;		
			
			arrayGrassMonsterCountId[iCount][MONSTER_IS_IN_RIVER]=false;	
		}
		
		for (iCount=0; iCount<iSlimeMonsterCountMax; iCount++) {
			arraySlimeMonsterCountId[iCount][MONSTER_OBJECT]= document.getElementById("slimeMonsterImageId"+iCount);
			
			arraySlimeMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="hidden";			
			arraySlimeMonsterCountId[iCount][MONSTER_IS_ACTIVE]=false;

			arraySlimeMonsterCountId[iCount][MONSTER_POSX]=0;
			arraySlimeMonsterCountId[iCount][MONSTER_POSY]=0;
			arraySlimeMonsterCountId[iCount][MONSTER_STEPX]=2;
			arraySlimeMonsterCountId[iCount][MONSTER_STEPY]=2;			
			
			arraySlimeMonsterCountId[iCount][MONSTER_ANIMATION_DELAY_COUNT]=10; //should be greater than MONSTER_ANIMATION_DELAY_COUNT_MAX
			arraySlimeMonsterCountId[iCount][MONSTER_ANIMATION_DELAY_COUNT_MAX]=8;		

			arraySlimeMonsterCountId[iCount][MONSTER_ANIMATION_COUNT]=-1;		
			arraySlimeMonsterCountId[iCount][MONSTER_ANIMATION_COUNT_MAX]=5;		

			arraySlimeMonsterCountId[iCount][MONSTER_STEP_DELAY]=0;		
			arraySlimeMonsterCountId[iCount][MONSTER_STEP_DELAY_MAX]=5;		
			
			arraySlimeMonsterCountId[iCount][MONSTER_IS_IN_RIVER]=false;	
		}
		
		for (iCount=0; iCount<iMiniBossMonsterCountMax; iCount++) {
			arrayMiniBossMonsterCountId[iCount][MONSTER_OBJECT]= document.getElementById("miniBossMonsterImageId"+iCount);
			
			arrayMiniBossMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="hidden";			
			arrayMiniBossMonsterCountId[iCount][MONSTER_IS_ACTIVE]=false;

			arrayMiniBossMonsterCountId[iCount][MONSTER_POSX]=0;
			arrayMiniBossMonsterCountId[iCount][MONSTER_POSY]=0;
			arrayMiniBossMonsterCountId[iCount][MONSTER_STEPX]=2;
			arrayMiniBossMonsterCountId[iCount][MONSTER_STEPY]=2;			
			
			arrayMiniBossMonsterCountId[iCount][MONSTER_ANIMATION_DELAY_COUNT]=0;//10; //should be greater than MONSTER_ANIMATION_DELAY_COUNT_MAX
			arrayMiniBossMonsterCountId[iCount][MONSTER_ANIMATION_DELAY_COUNT_MAX]=5; //8

			arrayMiniBossMonsterCountId[iCount][MONSTER_ANIMATION_COUNT]=-1;		
			arrayMiniBossMonsterCountId[iCount][MONSTER_ANIMATION_COUNT_MAX]=5;		

			arrayMiniBossMonsterCountId[iCount][MONSTER_STEP_DELAY]=0;		
			arrayMiniBossMonsterCountId[iCount][MONSTER_STEP_DELAY_MAX]=5;		
			
			arrayMiniBossMonsterCountId[iCount][MONSTER_IS_IN_RIVER]=false;	
		}		
		
/*		
		for (iRowCount=0; iRowCount<iRowCountMax; iRowCount++) {
			for (iColumnCount=0; iColumnCount<iColumnCountMax; iColumnCount++) {
				arrayHasVisitedRoom[iRowCount][iColumnCount]=0;
			}
		}
*/		
		
		//added by Mike, 20231121
////		var mouseInputImage = document.getElementById("mouseInputImageId");

		var iTitleImageWidth = (titleImage.clientWidth);
		var iTitleImageHeight = (titleImage.clientHeight);
/*
		titleImage.style.top = (iVerticalOffsetInnerScreen+0+iStageMaxHeight/3 -iTitleImageHeight/2)+"px";
		titleImage.style.left = 0+iHorizontalOffset+iStageMaxWidth/2 -iTitleImageWidth/2 +"px";
*/
/*
		titleImage.style.top = (iVerticalOffsetInnerScreen)+"px";
		titleImage.style.left = 0+iHorizontalOffset +"px";
*/		
		
		titleImage.style.top = (iVerticalOffsetInnerScreen+0+iStageMaxHeight/2 -iTitleImageHeight/2)+"px";

		titleImage.style.left = 0+iHorizontalOffset+iStageMaxWidth/2 -iTitleImageWidth/2 +"px";

		
		//---------------		

		iTextTimeDivWidth = (textTimeDiv.clientWidth)+iTextTimeDivWidthOffset;
		//iTextTimeDivWidth = "00:00".length*32; //32px font
		
		textTimeDiv.style.left = iHorizontalOffset+iStageMaxWidth-iTextTimeDivWidth*0.60+"px";
		textTimeDiv.style.top= (0)+"px";
			
		iStartTimeInMilliseconds=Date.now();
	
		if (bIsHeroInTank) {
			iImageFrameWidth=iImageFrameWidthLarge;
		}
		else {
			iImageFrameWidth=iImageFrameWidthDefault;
		}
		
		mainImageTilePosX=iStageMaxWidth/2-iImageFrameWidth/2;
		mainImageTilePosY=iStageMaxHeight/2-iImageFrameHeight;

		mainImageTile.style.left = (iHorizontalOffset+mainImageTilePosX)+"px";
		mainImageTile.style.top = (iVerticalOffsetInnerScreen+mainImageTilePosY)+"px";
		
		//added by Mike, 20231124
		mainImageTileTankBody.style.left = mainImageTile.style.left;
		mainImageTileTankBody.style.top = mainImageTile.style.top;

		//added by Mike, 20231124
		mainImageTileHeroBody.style.left = mainImageTile.style.left;
		mainImageTileHeroBody.style.top = mainImageTile.style.top;

		//cat body
		//mainImageTileTankBody.style.objectPosition = "-" + 128 + "px -" + 192 + "px";
		//mainImageTileTankBody.style.objectPosition = "-" + 0 + "px -" + 0 + "px";
		//mainImageTileTankBody.style.objectPosition = "-" + 0 + "px -" + 192 + "px";

		mainImageTileTankBody.style.objectPosition = "-" + 0 + "px -" + iImageFrameHeightLarge*3 + "px";
		mainImageTileHeroBody.style.objectPosition = "-" + 0 + "px -" + iImageFrameHeight*3 + "px";

		//mainImageTile.style.objectPosition = "-" + iImageFrameWidth*3 + "px -" + iImageFrameHeight*3 + "px";
		
		if (bIsHeroInTank) {
			mainImageTile.style.objectPosition = "-" + iImageFrameWidthLarge*3 + "px -" + iImageFrameHeightLarge*3 + "px";
		}
		else {
			mainImageTile.style.objectPosition = "-" + iImageFrameWidth*3 + "px -" + iImageFrameHeight*3 + "px";
		}
		

		mainImageTileProjectile.style.objectPosition = "-" + 0 + "px -" + 128 + "px";
		mainImageTileProjectilePosX = mainImageTile.style.left;
		mainImageTileProjectilePosY = mainImageTile.style.top;

		//mainImageTileFireballProjectile.style.objectPosition = "-" + 0 + "px -" + 128 + "px";
		mainImageTileFireballProjectile.style.objectPosition = "-" + 0 + "px -" + 32*2 + "px";
		mainImageTileFireballProjectilePosX = 0+"px"; //mainImageTile.style.left;
		mainImageTileFireballProjectilePosY = 0+"px"; //mainImageTile.style.top;

		mainImageTileFireballProjectileHold.style.objectPosition = "-" + 0 + "px -" + iImageFrameHeight*3 + "px";
		
		iBossMonsterImageTileStepAngle=-70; //facing left door of Boss Room
		//flip vertically;
		iBossMonsterImageTileStepAngle=(iBossMonsterImageTileStepAngle+180)%360;		
		bossMonsterImageTile.style.transform = "rotate("+iBossMonsterImageTileStepAngle+"deg)";	
		bossMonsterImageTile.style.transformOrigin = "12.5% 12.5%"; 
				
		var iTextEnterDivWidth = (textEnterDiv.clientWidth);
		var iTextEnterDivHeight = (textEnterDiv.clientHeight);

		textEnterDiv.style.left = 0+iHorizontalOffset+iStageMaxWidth/2 -iTextEnterDivWidth/2 +"px";

		textEnterDiv.style.top = 0+iStageMaxHeight-iTextEnterDivHeight*2+"px";

		//alert ("textEnterDiv.style.left: "+textEnterDiv.style.left);
		//alert ("textEnterDiv.style.top: "+textEnterDiv.style.top);

		textEnterDiv.style.visibility="visible";

		iTransitionScale=1;
		
		textEnterDiv.style.transform = "scale("+iTransitionScale+","+iTransitionScale+")";	
		
		mouseInputImage.style.left = (iHorizontalOffset+iStageMaxWidth/2-iTextEnterDivWidth/2+iMouseInputImageWidth/2)+"px";
		mouseInputImage.style.top = (iVerticalOffsetInnerScreen+iStageMaxHeight+iTextEnterDivHeight/2)+"px";
		mouseInputImage.style.objectPosition = "-" + 0 + "px -" + 192 + "px";

/*
		mainImageMonsterPosX=iHorizontalOffset+iStageMaxWidth/2-iMonsterTileWidth;
		mainImageMonsterPosY=iVerticalOffsetInnerScreen+0-iMonsterTileHeight;
*/

		bHasReachedDestinationY=false;
		bHasReachedDestinationX=false;		
		
		iCurrHeroLife=iCurrHeroLifeMax;
		iCurrBossMonsterLife=iCurrBossMonsterLifeMax;
		
		iCurrHeroDeathCount=0;
		iCurrPearlCount=0; //debug; change this;
		iCurrMonsterDeathCount=0;//998;//0;
				
		//resetProjectile()				
	}

  function setExplosionEffectPosition(iInputX, iInputY) {
    var explosionEffectImage = document.getElementById("explosionEffectImageId");

    if (explosionEffectImage.style.visibility=="visible") {
      return;
    }

    explosionEffectImage.style.objectPosition = "-" + 0 + "px -" + 0 + "px";

	explosionEffectImage.style.transform = "scale(0.5,0.5)";	

    explosionEffectImage.style.visibility="visible";
	
	iExplosionEffectAnimationDelayCount=iExplosionEffectAnimationDelayCountMax;

	iExplosionEffectAnimationCount=-1; //0;

    explosionEffectImage.style.left = iInputX-128-iImageExplosionEffectAnimationWidth/2;
    explosionEffectImage.style.top = iInputY-128-iImageExplosionEffectAnimationHeight/2;
  }
  
  function setExplosionEffectPositionLarge(iInputX, iInputY) {
    var explosionEffectImage = document.getElementById("explosionEffectImageId");

    if (explosionEffectImage.style.visibility=="visible") {
      return;
    }

    explosionEffectImage.style.objectPosition = "-" + 0 + "px -" + 0 + "px";

	//explosionEffectImage.style.transform = "scale(0.5,0.5)";	
	
	//set back to default scale
	explosionEffectImage.style.transform = "scale(1,1)";

    explosionEffectImage.style.visibility="visible";
	
	iExplosionEffectAnimationDelayCount=iExplosionEffectAnimationDelayCountMax;

	iExplosionEffectAnimationCount=-1; //0;

    explosionEffectImage.style.left = iInputX-iImageExplosionEffectAnimationWidth/2;//-128-iImageExplosionEffectAnimationWidth/2;
    explosionEffectImage.style.top = iInputY-iImageExplosionEffectAnimationHeight/2;//-128-iImageExplosionEffectAnimationHeight/2;
  }  

  function setFireballExplosionEffectPosition(iInputX, iInputY) {
    var fireballExplosionEffectImage = document.getElementById("fireballExplosionEffectImageId"); 
	
    if (fireballExplosionEffectImage.style.visibility=="visible") {
      return;
    }

    //explosionEffectImage.style.objectPosition = "-" + 0 + "px -" + 0 + "px";
    fireballExplosionEffectImage.style.objectPosition = "-" + 0 + "px -" + 128 + "px";
	
	fireballExplosionEffectImage.style.transform = "scale(0.5,0.5)";	

    fireballExplosionEffectImage.style.visibility="visible";
	
	iFireballExplosionEffectAnimationDelayCount=iFireballExplosionEffectAnimationDelayCountMax;

	iFireballExplosionEffectAnimationCount=-1; //0;

    fireballExplosionEffectImage.style.left = iInputX-128-iImageFireballExplosionEffectAnimationWidth/2;
    fireballExplosionEffectImage.style.top = iInputY-128-iImageFireballExplosionEffectAnimationHeight/2;
	
  }
  
  function setFireballExplosionEffectPositionLarge(iInputX, iInputY) {
    var fireballExplosionEffectImage = document.getElementById("fireballExplosionEffectImageId"); 
	
    if (fireballExplosionEffectImage.style.visibility=="visible") {
      return;
    }

    //explosionEffectImage.style.objectPosition = "-" + 0 + "px -" + 0 + "px";
    fireballExplosionEffectImage.style.objectPosition = "-" + 0 + "px -" + 128 + "px";
	
	//fireballExplosionEffectImage.style.transform = "scale(0.5,0.5)";	
	
	//set back to default scale
	fireballExplosionEffectImage.style.transform = "scale(1,1)";	

    fireballExplosionEffectImage.style.visibility="visible";
	
	iFireballExplosionEffectAnimationDelayCount=iFireballExplosionEffectAnimationDelayCountMax;

	iFireballExplosionEffectAnimationCount=-1; //0;

    fireballExplosionEffectImage.style.left = iInputX-iImageFireballExplosionEffectAnimationWidth/2;//-128-iImageFireballExplosionEffectAnimationWidth/2;
    fireballExplosionEffectImage.style.top = iInputY-iImageFireballExplosionEffectAnimationHeight/2;//-128-iImageFireballExplosionEffectAnimationHeight/2;
	
  }

  function setGrassCutEffectPosition(iInputX, iInputY) {
    var grassCutEffectImage = document.getElementById("grassCutEffectImageId");

    if (grassCutEffectImage.style.visibility=="visible") {
      return;
    }

	//var iFrameY=0;
	var iFrameY=iImageFrameHeight*2;

    grassCutEffectImage.style.objectPosition = "-" + 0 + "px -" + iFrameY + "px";

    grassCutEffectImage.style.visibility="visible";
	
	iGrassCutEffectAnimationDelayCount=iGrassCutEffectAnimationDelayCountMax;
	iGrassCutEffectAnimationCount=-1; //0;

/*
    grassCutEffectImage.style.left = iInputX-iImageFrameWidthDefault-iImageGrassCutEffectAnimationWidth/2+"px";
    grassCutEffectImage.style.top = iInputY-iImageFrameHeightDefault-iImageGrassCutEffectAnimationHeight/2+"px";
*/	

    grassCutEffectImage.style.left = iInputX;
    grassCutEffectImage.style.top = iInputY;
	
  }
  
  //currently not used
  function setPearlPosition(iInputX, iInputY) {
    var pearlImageTile = document.getElementById("pearlImageTileId");

    if (pearlImageTile.style.visibility=="visible") {
      return;
    }

	var iFrameY=0;//iImageFrameHeight*2;

    pearlImageTile.style.objectPosition = "-" + 0 + "px -" + iFrameY + "px";

    pearlImageTile.style.visibility="visible";
	
	iPearlAnimationDelayCount=iPearlAnimationDelayCountMax;
	iPearlAnimationCount=-1; //0;

    pearlImageTile.style.left = iInputX;
    pearlImageTile.style.top = iInputY;	
  }  
  
  //added by Mike, 20231129
  function setCityExplosionEffectPosition(iInputX, iInputY) {
    var explosionEffectImage = document.getElementById("explosionEffectToCityImageId");

    if (explosionEffectImage.style.visibility=="visible") {
      return;
    }
	
	//edited by Mike, 20231127
    //explosionEffectImage.style.objectPosition = "-" + 0 + "px -" + 0 + "px";
    explosionEffectImage.style.objectPosition = "-" + 0 + "px -" + 128 + "px";

    explosionEffectImage.style.visibility="visible";

    iMonsterExplosionEffectAnimationDelayCount=iMonsterExplosionEffectAnimationDelayCountMax;

    iMonsterExplosionEffectAnimationCount=-1; //0;

    explosionEffectImage.style.left = iInputX-iImageExplosionEffectAnimationWidth/2;

    explosionEffectImage.style.top = iInputY-iImageExplosionEffectAnimationHeight/2;
  }

	//added by Mike, 20240511
	function setDustEffectPosition(iInputX, iInputY) {
		var dustEffectImage = document.getElementById("dustEffectImageId");

		if (dustEffectImage.style.visibility=="visible") {
		  return;
		}

		dustEffectImage.style.objectPosition = "-" + 0 + "px -" + 0 + "px";

		dustEffectImage.style.visibility="visible";

		iDustEffectAnimationDelayCount=iDustEffectAnimationDelayCountMax;

		iDustEffectAnimationCount=-1; //0;
/*
alert("iInputX: "+iInputX);
alert("iInputY: "+iInputY);
*/
		dustEffectImage.style.left = iInputX;//+iImageDustEffectAnimationWidth/2;
		dustEffectImage.style.top = iInputY+iImageDustEffectAnimationHeight/4; //near feet
	}
	
	function setInitFireballEffectPosition(iInputX, iInputY) {
		var initFireballEffectImage = document.getElementById("initFireballEffectImageId");

		if (initFireballEffectImage.style.visibility=="visible") {
		  return;
		}
		
		var iFrameY=128*3;

		initFireballEffectImage.style.objectPosition = "-" + 0 + "px -" + iFrameY + "px";

		initFireballEffectImage.style.visibility="visible";

		iInitFireballEffectAnimationDelayCount=iInitFireballEffectAnimationDelayCountMax;

		iInitFireballEffectAnimationCount=-1; //0;
/*
alert("iInputX: "+iInputX);
alert("iInputY: "+iInputY);
*/
		initFireballEffectImage.style.left = iInputX-iImageFrameWidthLarge/2-iImageFrameWidthDefault/2;
		initFireballEffectImage.style.top = iInputY-iImageFrameHeightLarge/2-iImageFrameHeightDefault/2;
	}
	
  
	//added by Mike, 20240513
	function setHeroAttackEffectPosition(iInputX, iInputY) {
		var heroAttackEffectImage = document.getElementById("heroAttackEffectImageId");

		if (heroAttackEffectImage.style.visibility=="visible") {
		  return;
		}

		heroAttackEffectImage.style.objectPosition = "-" + 0 + "px -" + 0 + "px";

		heroAttackEffectImage.style.visibility="visible";

		iHeroAttackEffectAnimationDelayCount=iHeroAttackEffectAnimationDelayCountMax;

		iHeroAttackEffectAnimationCount=-1; //0;

		heroAttackEffectImage.style.left = iInputX;
		heroAttackEffectImage.style.top = iInputY;		
	} 
  
  	//added by Mike, 20231128
	function executeEnterClickAnimation() {	
		var textEnterDiv = document.getElementById("textEnterDivId");

			
		if (iTitlePressStartEffectDelayCount<iTitlePressStartEffectDelayCountMax) {
			iTitlePressStartEffectDelayCount++;
			return;	
		}
		else {
			iTitlePressStartEffectDelayCount=0;
		}
		
		//textEnterDiv.innerHTML = "START";
		//textEnterDiv.innerHTML = "<font color='red'>START</font>";

		//alert(iTransitionScale);
		
		if (iTransitionScale<1) {
			iTransitionScale+=0.1
		}
		else if (iTransitionScale>0) {
			iTransitionScale-=0.1
		}

		textEnterDiv.style.transform = "scale("+iTransitionScale+","+iTransitionScale+")";	
	}
	
	//added by Mike, 20231121
	function executeMouseClickAnimation() {
		var mouseInputImage = document.getElementById("mouseInputImageId");
		mouseInputImage.style.visibility="visible";

		if (iMouseAnimationDelayCount==iMouseAnimationDelayCountMax) {
			iMouseAnimationCount=(iMouseAnimationCount+1)%3; //last hidden

			iMouseAnimationDelayCount=0;
		}
		else {
			iMouseAnimationDelayCount++;
		}

		if (iMouseAnimationCount==0) { 
			mouseInputImage.style.objectPosition = "-" + 0 + "px -" + 192 + "px";
		}
		else if (iMouseAnimationCount==1) { 
			mouseInputImage.style.objectPosition = "-" + (iImageFrameWidth*2) + "px -" + 192 + "px";
		}
		else {
			mouseInputImage.style.objectPosition = "-" + (iImageFrameWidth*2)*2 + "px -" + 192 + "px";
		}
	}
	
	//added by Mike, 20241103
	function executeHeroWalkingAnimation() {
		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");
		mainImageTileHeroBody.style.visibility="visible";

		if (iHeroAnimationDelayCount==iHeroAnimationDelayCountMax) {
			iHeroAnimationCount=(iHeroAnimationCount+1)%3; //last hidden

			iHeroAnimationDelayCount=0;
		}
		else {
			iHeroAnimationDelayCount++;
		}

		var iFrameY=0;
		var iFrameXOffset=0;
		
		
		if (bIsHeroInRiver){
			if (bIsHeroFacingLeft) {
				iFrameY=iImageFrameHeight*0;
			}
			else {
				iFrameY=iImageFrameHeight*1;
			}
			
			iFrameXOffset=iImageFrameWidth;
		}
		else {
			if (bIsHeroFacingLeft) {
				iFrameY=iImageFrameHeight*2;//64*2; 128;
			}
			else {
				iFrameY=iImageFrameHeight*3;//64*3; 192;
			}
		}			

		if (iHeroAnimationCount==0) { 
			mainImageTileHeroBody.style.objectPosition = "-" + 0-iFrameXOffset + "px -" + iFrameY + "px";
		}
		else if (iHeroAnimationCount==1) { 
			mainImageTileHeroBody.style.objectPosition = "-" + iFrameXOffset-iImageFrameWidth + "px -" + iFrameY + "px";
		}
		else {
			mainImageTileHeroBody.style.objectPosition = "-" + iFrameXOffset-iImageFrameWidth*2 + "px -" + iFrameY + "px";
		}
	}
	
	function executeTankWalkingAnimation() {
		var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");
		mainImageTileTankBody.style.visibility="visible";

		if (iHeroAnimationDelayCount==iHeroAnimationDelayCountMax) {
			iHeroAnimationCount=(iHeroAnimationCount+1)%3; //last hidden

			iHeroAnimationDelayCount=0;
		}
		else {
			iHeroAnimationDelayCount++;
		}

		var iFrameY=0;
		//destination to the left of hero projectile
		if (bIsHeroFacingLeft) {
			iFrameY=iImageFrameHeightLarge*2;//64*2; 128;
		}
		else {
			iFrameY=iImageFrameHeightLarge*3;//64*3; 192;
		}
		
		if (iHeroAnimationCount==0) { 
			mainImageTileTankBody.style.objectPosition = "-" + 0 + "px -" + iFrameY + "px";
		}
		else if (iHeroAnimationCount==1) { 
			mainImageTileTankBody.style.objectPosition = "-" + iImageFrameWidthLarge + "px -" + iFrameY + "px";
		}
		else {
			mainImageTileTankBody.style.objectPosition = "-" + iImageFrameWidthLarge*2 + "px -" + iFrameY + "px";
		}
	}	
	
	function executeRiverAnimation() {
		var riverImageRight = document.getElementById("riverImageRightId");
		
		riverImageRight.style.visibility="visible";

		//iMonsterAnimationDelayCountMax=15;

/*		
		if (iRiverAnimationDelayCount>=iRiverAnimationDelayCountMax) {
			iRiverAnimationCount=(iRiverAnimationCount+1)%2; //3; //last hidden

			iRiverAnimationDelayCount=0;						
		}
		else {
			iRiverAnimationDelayCount++;
		}

		//alert("DITO: "+iRiverAnimationCount);
		//alert("iRiverAnimationDelayCount: "+iRiverAnimationDelayCount);

		var iFrameY=0;
		//var iRiverImageFrameWidth=130;
		//iRiverImageFrameWidth=130;
		
		//var iFrameY=iImageFrameHeight*2;//64*2; 128;

		//currently two frames only
		if (iRiverAnimationCount==0) { 
			riverImageRight.style.objectPosition = "-" + 0 + "px -" + iFrameY + "px";
		}
		else  { 
			riverImageRight.style.objectPosition = "-" + iRiverImageFrameWidth + "px -" + iFrameY + "px";
		}
*/
			var iFrameY=0;

			//Game Off 2021; TUGON
			if (iRiverAnimationDelayCount<10) {//5) {
				riverImageRight.style.objectPosition = "-" + 0 + "px -" + iFrameY + "px";
			}
			else {
				if (iRiverAnimationDelayCount>20) {//10) {
					iRiverAnimationDelayCount=0;
				}
				riverImageRight.style.objectPosition = "-" + iRiverImageFrameWidth + "px -" + iFrameY + "px";
			}			
			iRiverAnimationDelayCount++;				
	}	

	function executeBatMonsterWalkingAnimation() {
		var batMonsterImageTile = document.getElementById("batMonsterImageId");
		
		//hero tile position
		var mainImageTile = document.getElementById("mainImageTileImageId");

		batMonsterImageTile.style.visibility="visible";

		//iMonsterAnimationDelayCountMax=15;
		
		if (iBatMonsterAnimationDelayCount>=iBatMonsterAnimationDelayCountMax) {
			iBatMonsterAnimationCount=(iBatMonsterAnimationCount+1)%2; //3; //last hidden

			iBatMonsterAnimationDelayCount=0;			
			
			//==============================
			//AI; movement
			if (batMonsterTileStepDelay>=batMonsterTileStepDelayMax) {
				batMonsterTileStepDelay=0;

				if (batMonsterImageTilePosY<parseInt(mainImageTile.style.top)) {//mainImageTilePosY) {
					batMonsterImageTilePosY+=batMonsterTileStepY;				
				}
				else {
					batMonsterImageTilePosY-=batMonsterTileStepY;
				}
				
				batMonsterImageTile.style.top=batMonsterImageTilePosY+"px";

				if (batMonsterImageTilePosX<mainImageTilePosX) {
					batMonsterImageTilePosX+=batMonsterTileStepX;
				}
				else {
					batMonsterImageTilePosX-=batMonsterTileStepX;
				}
				
				batMonsterImageTile.style.left=batMonsterImageTilePosX+"px";							
			}
			else {
				batMonsterTileStepDelay++;
			}			
			//==============================
		}
		else {
			iBatMonsterAnimationDelayCount++;

	//		alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);
		}

		//var iFrameY=0;
		var iFrameY=iImageFrameHeight*2;//64*2; 128;

		//currently two frames only
		if (iBatMonsterAnimationCount==0) { 
			batMonsterImageTile.style.objectPosition = "-" + 0 + "px -" + iFrameY + "px";
		}
		else if (iBatMonsterAnimationCount==1) { 
			batMonsterImageTile.style.objectPosition = "-" + iImageFrameWidthDefault + "px -" + iFrameY + "px";
		}
/*		
		else {
			batMonsterImageTile.style.objectPosition = "-" + iImageFrameWidthDefault*2 + "px -" + iFrameY + "px";
		}
*/		
	}
		
	function executeBossMonsterWalkingAnimation() {
		var bossMonsterImageTile = document.getElementById("bossMonsterImageId");
		
		//hero tile position
		var mainImageTile = document.getElementById("mainImageTileImageId");

		bossMonsterImageTile.style.visibility="visible";

		//iMonsterAnimationDelayCountMax=15;
		
		if (iBossMonsterAnimationDelayCount>=iBossMonsterAnimationDelayCountMax) {
			iBossMonsterAnimationCount=(iBossMonsterAnimationCount+1)%2; //3; //last hidden

			iBossMonsterAnimationDelayCount=0;			
		}
		else {
			iBossMonsterAnimationDelayCount++;

	//		alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);
		}

			//==============================
			//AI; movement
			if (iBossMonsterMovementDelayCount>=iBossMonsterMovementDelayCountMax) {			
				var iDeltaX=(parseInt(mainImageTile.style.left)-iHorizontalOffset)-(bossMonsterImageTilePosX+iImageFrameWidthLarge/2);
				var iDeltaY=(parseInt(mainImageTile.style.top)-iVerticalOffset)-(bossMonsterImageTilePosY+iImageFrameHeightLarge/2);
	
				////alert(parseInt(mainImageTile.style.left));
				////alert("BOSS: "+parseInt(bossMonsterImageTile.style.left));

				////alert(parseInt(mainImageTile.style.top));
				////alert("BOSS: "+parseInt(bossMonsterImageTile.style.top));
	
				iDeltaY*=-1;

				var fBossMonsterImageTileStepAngleRad=Math.atan2(iDeltaX,iDeltaY);
				var iBossMonsterImageTileStepAngle=fBossMonsterImageTileStepAngleRad*(180/Math.PI);
				//var iBossMonsterImageTileStepAngle=fBossMonsterImageTileStepAngleRad*(360/Math.PI);
				//var iBossMonsterImageTileStepAngle=fBossMonsterImageTileStepAngleRad*(720/Math.PI);

				//clockwise
				//iBossMonsterImageTileStepAngle=(iBossMonsterImageTileStepAngle)%360;
				//flip vertically;
				iBossMonsterImageTileStepAngle=(iBossMonsterImageTileStepAngle+180)%360;
				
				bossMonsterImageTile.style.transform = "rotate("+iBossMonsterImageTileStepAngle+"deg)";	

				bossMonsterImageTile.style.transformOrigin = "12.5% 12.5%"; 

				
				var newBossMonsterTileStepY=bossMonsterTileStepY*Math.cos(fBossMonsterImageTileStepAngleRad).toFixed(3);
				newBossMonsterTileStepY*=-1;
				var newBossMonsterTileStepX=bossMonsterTileStepX*Math.sin(fBossMonsterImageTileStepAngleRad).toFixed(3);
				
				bossMonsterImageTilePosY=parseInt(bossMonsterImageTile.style.top)+newBossMonsterTileStepY;			
				bossMonsterImageTilePosX=parseInt(bossMonsterImageTile.style.left)+newBossMonsterTileStepX;

				bossMonsterImageTile.style.left = bossMonsterImageTilePosX+"px";
				bossMonsterImageTile.style.top = bossMonsterImageTilePosY+"px";			

				iBossMonsterMovementDelayCount=0;		
				
				//if (myAudioBossScreech.currentTime==0) {
				if (iBossMonsterHitAnimationCount%iBossMonsterHitAnimationCountMax==0) {
					myAudioBossScreech.play();
				}
			}
			else {
				iBossMonsterMovementDelayCount++;
			}
			//==============================
			
			
		var iFrameY=0;
		//var iFrameY=iImageFrameHeight*2;//64*2; 128;
		
		if (bIsBossMonsterHit) {
			//iImageFrameHeightLarge*2 = 128
			
			//reference: Game Off 2022; Time
			bossMonsterImageTile.style.objectPosition = "-" + iImageFrameHeightLarge*2*(iBossMonsterAnimationCount) + "px -" + iImageFrameHeightLarge*2 + "px";
			
			if (iBossMonsterHitAnimationCount>=iBossMonsterHitAnimationCountMax) {
				bIsBossMonsterHit=false;
				iBossMonsterHitAnimationCount=0;
			}
			iBossMonsterHitAnimationCount++;
		}
		else {
			//currently two frames only
			if (iBossMonsterAnimationCount==0) { 
				bossMonsterImageTile.style.objectPosition = "-" + 0 + "px -" + iFrameY + "px";
			}
			else if (iBossMonsterAnimationCount==1) { 
				//use actual image dimensions in file; not scaled down dimensions
				bossMonsterImageTile.style.objectPosition = "-" + iImageFrameWidthLarge*2 + "px -" + iFrameY + "px";
			}
		}
		
		//==================================================
/*		
		iTransitionRotate=(iTransitionRotate+10)%360; //30
		bossMonsterImageTile.style.transform = "rotate("+iTransitionRotate+"deg)";	
		bossMonsterImageTile.style.transformOrigin = "12.5% 12.5%"; 
*/

/*
		if (iTransitionScale<1) {
			iTransitionScale+=0.1
		}
		else if (iTransitionScale>0) {
			iTransitionScale-=0.1
		}
		//iTransitionScale=0.5;
		
		bossMonsterImageTile.style.transform = "scale("+iTransitionScale+","+iTransitionScale+")";			
		bossMonsterImageTile.style.transformOrigin = "12.5% 12.5%"; 
*/		
	}	
	
	function executeMiniBossMonsterWalkingAnimation(iCount,inputArrayMiniBossMonster){//inputArrayMiniBossMonsterWithIdCount) {	
		//hero tile position
		var mainImageTile = document.getElementById("mainImageTileImageId");

/*
		var miniBossMonsterImageTile = document.getElementById("miniBossMonsterImageId");
		miniBossMonsterImageTile.style.visibility="visible";
*/		
		
		inputArrayMiniBossMonster[iCount][MONSTER_OBJECT].style.visibility="visible";
		
		//==============================
		//AI; movement		
		if (inputArrayMiniBossMonster[iCount][MONSTER_ANIMATION_DELAY_COUNT]>=inputArrayMiniBossMonster[iCount][MONSTER_ANIMATION_DELAY_COUNT_MAX]) {
			inputArrayMiniBossMonster[iCount][MONSTER_ANIMATION_COUNT]=(inputArrayMiniBossMonster[iCount][MONSTER_ANIMATION_COUNT]+1)%2; //3; //last hidden

			inputArrayMiniBossMonster[iCount][MONSTER_ANIMATION_DELAY_COUNT]=0;			
		}
		else {
			inputArrayMiniBossMonster[iCount][MONSTER_ANIMATION_DELAY_COUNT]++;

	//		alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);
		}


			//==============================
			//AI; movement
/*
		if (iMiniBossMonsterHitAnimationCount>=iMiniBossMonsterHitAnimationCountMax) {
			//bIsBossMonsterHit=false;
			//iMiniBossMonsterHitAnimationCount=0;
		}
		iMiniBossMonsterHitAnimationCount++;
*/		
		if (iMiniBossMonsterMovementDelayCount>=iMiniBossMonsterMovementDelayCountMax) {		
			if ((iCount==0)||(iCount>0)&&(!inputArrayMiniBossMonster[iCount-1][MONSTER_IS_ACTIVE])){			
				//movement
				if (inputArrayMiniBossMonster[iCount][MONSTER_ANIMATION_DELAY_COUNT]>=inputArrayMiniBossMonster[iCount][MONSTER_ANIMATION_DELAY_COUNT_MAX]/2) {
				
					var iDeltaX=(parseInt(mainImageTile.style.left)+iImageFrameWidth/2-iHorizontalOffset)-(inputArrayMiniBossMonster[iCount][MONSTER_POSX]+iImageFrameWidth/2);
					
					var iDeltaY=(parseInt(mainImageTile.style.top)+iImageFrameHeight/2-iVerticalOffset)-(inputArrayMiniBossMonster[iCount][MONSTER_POSY]+iImageFrameHeight/2);

					
					////alert(parseInt(mainImageTile.style.left));
					////alert("BOSS: "+parseInt(bossMonsterImageTile.style.left));

					////alert(parseInt(mainImageTile.style.top));
					////alert("BOSS: "+parseInt(bossMonsterImageTile.style.top));

					iDeltaY*=-1;

					var fMiniBossMonsterImageTileStepAngleRad=Math.atan2(iDeltaX,iDeltaY);
					var iMiniBossMonsterImageTileStepAngle=fMiniBossMonsterImageTileStepAngleRad*(180/Math.PI);
					//var iBossMonsterImageTileStepAngle=fBossMonsterImageTileStepAngleRad*(360/Math.PI);
					//var iBossMonsterImageTileStepAngle=fBossMonsterImageTileStepAngleRad*(720/Math.PI);

					//clockwise
					//iBossMonsterImageTileStepAngle=(iBossMonsterImageTileStepAngle)%360;
					//flip vertically;
					iMiniBossMonsterImageTileStepAngle=(iMiniBossMonsterImageTileStepAngle+180)%360;
					
					inputArrayMiniBossMonster[iCount][MONSTER_OBJECT].style.transform = "rotate("+iMiniBossMonsterImageTileStepAngle+"deg)";	

					inputArrayMiniBossMonster[iCount][MONSTER_OBJECT].style.transformOrigin = "12.5% 12.5%"; 
					
					var newMiniBossMonsterTileStepY=inputArrayMiniBossMonster[iCount][MONSTER_STEPY]*Math.cos(fMiniBossMonsterImageTileStepAngleRad).toFixed(3);
					newMiniBossMonsterTileStepY*=-1;
					
					var newMiniBossMonsterTileStepX=inputArrayMiniBossMonster[iCount][MONSTER_STEPX]*Math.sin(fMiniBossMonsterImageTileStepAngleRad).toFixed(3);

					inputArrayMiniBossMonster[iCount][MONSTER_POSY]=parseInt(inputArrayMiniBossMonster[iCount][MONSTER_OBJECT].style.top)+newMiniBossMonsterTileStepY;			
					inputArrayMiniBossMonster[iCount][MONSTER_POSX]=parseInt(inputArrayMiniBossMonster[iCount][MONSTER_OBJECT].style.left)+newMiniBossMonsterTileStepX;

					//inputArrayMiniBossMonster[iCount][MONSTER_ANIMATION_DELAY_COUNT]=0;					
				}
			}
		}
		iMiniBossMonsterMovementDelayCount++;
			
		var iFrameY=0;
		//var iFrameY=iImageFrameHeight*2;//64*2; 128;

		//currently two frames only
		if (inputArrayMiniBossMonster[iCount][MONSTER_ANIMATION_COUNT]==0) { 
			inputArrayMiniBossMonster[iCount][MONSTER_OBJECT].style.objectPosition = "-" + 0 + "px -" + iFrameY + "px";
		}
		else if (inputArrayMiniBossMonster[iCount][MONSTER_ANIMATION_COUNT]==1) { 
			//use actual image dimensions in file; not scaled down dimensions
			inputArrayMiniBossMonster[iCount][MONSTER_OBJECT].style.objectPosition = "-" + iImageFrameWidth + "px -" + iFrameY + "px";
		}


/*		
		if (bIsMiniBossMonsterHit) {
			//iImageFrameHeightLarge*2 = 128
			
			//reference: Game Off 2022; Time
			miniBossMonsterImageTile.style.objectPosition = "-" + iImageFrameHeightLarge*2*(iMiniBossMonsterAnimationCount) + "px -" + iImageFrameHeightLarge*2 + "px";
			
			if (iMiniBossMonsterHitAnimationCount>=iMiniBossMonsterHitAnimationCountMax) {
				bIsMiniBossMonsterHit=false;
				iMiniBossMonsterHitAnimationCount=0;
			}
			iMiniBossMonsterHitAnimationCount++;
		}
		else {		
			//currently two frames only
			if (iMiniBossMonsterAnimationCount==0) { 
				miniBossMonsterImageTile.style.objectPosition = "-" + 0 + "px -" + iFrameY + "px";
			}
			else if (iMiniBossMonsterAnimationCount==1) { 
				//use actual image dimensions in file; not scaled down dimensions
				miniBossMonsterImageTile.style.objectPosition = "-" + iImageFrameWidthLarge*2 + "px -" + iFrameY + "px";
			}
		}		
*/		
	}	
	
	function executeSnakeMonsterWalkingAnimation(inputArraySnakeMonsterWithIdCount) {		
		//hero tile position
		var mainImageTile = document.getElementById("mainImageTileImageId");

		inputArraySnakeMonsterWithIdCount[MONSTER_OBJECT].style.visibility="visible";
				
/*				
		if (inputArraySnakeMonsterWithIdCount[MONSTER_ANIMATION_DELAY_COUNT]>=inputArraySnakeMonsterWithIdCount[MONSTER_ANIMATION_DELAY_COUNT_MAX]) {
			inputArraySnakeMonsterWithIdCount[MONSTER_ANIMATION_COUNT]=(inputArraySnakeMonsterWithIdCount[MONSTER_ANIMATION_COUNT]+1)%2; //3; //last hidden

			inputArraySnakeMonsterWithIdCount[MONSTER_ANIMATION_DELAY_COUNT]=0;
			
			if (inputArraySnakeMonsterWithIdCount[MONSTER_STEP_DELAY]>=inputArraySnakeMonsterWithIdCount[MONSTER_STEP_DELAY_MAX]) {
				inputArraySnakeMonsterWithIdCount[MONSTER_STEP_DELAY]=0;
			}
			else {
				inputArraySnakeMonsterWithIdCount[MONSTER_STEP_DELAY]++;
			}				
		}
		else {
			inputArraySnakeMonsterWithIdCount[MONSTER_ANIMATION_DELAY_COUNT]++;
		}
*/		

		//==============================
		//AI; movement		
		if (inputArraySnakeMonsterWithIdCount[MONSTER_ANIMATION_DELAY_COUNT]>=inputArraySnakeMonsterWithIdCount[MONSTER_ANIMATION_DELAY_COUNT_MAX]/2) {
		
			if (inputArraySnakeMonsterWithIdCount[MONSTER_POSY]<parseInt(mainImageTile.style.top)) {//mainImageTilePosY) {
				inputArraySnakeMonsterWithIdCount[MONSTER_POSY]+=inputArraySnakeMonsterWithIdCount[MONSTER_STEPY];								
			}
			else {
				inputArraySnakeMonsterWithIdCount[MONSTER_POSY]-=inputArraySnakeMonsterWithIdCount[MONSTER_STEPY];				
			}
			
			inputArraySnakeMonsterWithIdCount[MONSTER_OBJECT].style.top=inputArraySnakeMonsterWithIdCount[MONSTER_POSY]+"px";		

			if (inputArraySnakeMonsterWithIdCount[MONSTER_POSX]<mainImageTilePosX) {
				inputArraySnakeMonsterWithIdCount[MONSTER_POSX]+=inputArraySnakeMonsterWithIdCount[MONSTER_STEPX];
				
			}
			else {
				inputArraySnakeMonsterWithIdCount[MONSTER_POSX]-=inputArraySnakeMonsterWithIdCount[MONSTER_STEPX];
				
			}
			
			inputArraySnakeMonsterWithIdCount[MONSTER_OBJECT].style.left=inputArraySnakeMonsterWithIdCount[MONSTER_POSX]+"px";	
			
			
		}
		//==============================
		
/*
		//var iFrameY=0;
		var iFrameY=iImageFrameHeight*3;//2;//64*2; 128;

		//currently two frames only
		if (inputArraySnakeMonsterWithIdCount[MONSTER_ANIMATION_COUNT]==0) { 
			inputArraySnakeMonsterWithIdCount[MONSTER_OBJECT].style.objectPosition = "-" + 0 + "px -" + iFrameY + "px";
		}
		else if (inputArraySnakeMonsterWithIdCount[MONSTER_ANIMATION_COUNT]==1) { 
			inputArraySnakeMonsterWithIdCount[MONSTER_OBJECT].style.objectPosition = "-" + iImageFrameWidthDefault + "px -" + iFrameY + "px";
		}
*/		

		var iFrameY=iImageFrameHeight*3;
		
		var iFrameXOffset=0;
		
		if (inputArraySnakeMonsterWithIdCount[MONSTER_IS_IN_RIVER]) {
			iFrameXOffset=iImageFrameWidth*2;
		}

		//Game Off 2021; TUGON
		if (inputArraySnakeMonsterWithIdCount[MONSTER_ANIMATION_DELAY_COUNT]<20) {//30//40) {
			inputArraySnakeMonsterWithIdCount[MONSTER_OBJECT].style.objectPosition = "-" + 0 - iFrameXOffset + "px -" + iFrameY + "px";
		}
		else {
			if (inputArraySnakeMonsterWithIdCount[MONSTER_ANIMATION_DELAY_COUNT]>40) {//60//80) {
				inputArraySnakeMonsterWithIdCount[MONSTER_ANIMATION_DELAY_COUNT]=0;
			}
			inputArraySnakeMonsterWithIdCount[MONSTER_OBJECT].style.objectPosition = "-" + iImageFrameWidthDefault - iFrameXOffset + "px -" + iFrameY + "px";
		}	
		inputArraySnakeMonsterWithIdCount[MONSTER_ANIMATION_DELAY_COUNT]++;
		
/*			
		//var iFrameY=0;
		var iFrameY=iImageFrameHeight*3;//2;//64*2; 128;

		//currently two frames only
		if (inputArraySnakeMonsterWithIdCount[MONSTER_ANIMATION_COUNT]==0) { 
			inputArraySnakeMonsterWithIdCount[MONSTER_OBJECT].style.objectPosition = "-" + 0 + "px -" + iFrameY + "px";
		}
		else if (inputArraySnakeMonsterWithIdCount[MONSTER_ANIMATION_COUNT]==1) { 
			inputArraySnakeMonsterWithIdCount[MONSTER_OBJECT].style.objectPosition = "-" + iImageFrameWidthDefault + "px -" + iFrameY + "px";
		}
*/						
	}
	
	function executeGrassMonsterAnimation(inputArrayGrassMonsterWithIdCount) {		

		inputArrayGrassMonsterWithIdCount[MONSTER_OBJECT].style.visibility="visible";
				
		if (inputArrayGrassMonsterWithIdCount[MONSTER_ANIMATION_DELAY_COUNT]>=inputArrayGrassMonsterWithIdCount[MONSTER_ANIMATION_DELAY_COUNT_MAX]) {
			inputArrayGrassMonsterWithIdCount[MONSTER_ANIMATION_COUNT]=(inputArrayGrassMonsterWithIdCount[MONSTER_ANIMATION_COUNT]+1)%2; //3; //last hidden

			inputArrayGrassMonsterWithIdCount[MONSTER_ANIMATION_DELAY_COUNT]=0;
			
			if (inputArrayGrassMonsterWithIdCount[MONSTER_STEP_DELAY]>=inputArrayGrassMonsterWithIdCount[MONSTER_STEP_DELAY_MAX]) {
				inputArrayGrassMonsterWithIdCount[MONSTER_STEP_DELAY]=0;
			}
			else {
				inputArrayGrassMonsterWithIdCount[MONSTER_STEP_DELAY]++;
			}				
		}
		else {
			inputArrayGrassMonsterWithIdCount[MONSTER_ANIMATION_DELAY_COUNT]++;
		}

		//var iFrameY=0;
		var iFrameY=iImageFrameHeight*2;//2;//64*2; 128;

		//currently two frames only
		if (inputArrayGrassMonsterWithIdCount[MONSTER_ANIMATION_COUNT]==0) { 
			inputArrayGrassMonsterWithIdCount[MONSTER_OBJECT].style.objectPosition = "-" + 0 + "px -" + iFrameY + "px";
		}
		else if (inputArrayGrassMonsterWithIdCount[MONSTER_ANIMATION_COUNT]==1) { 
			inputArrayGrassMonsterWithIdCount[MONSTER_OBJECT].style.objectPosition = "-" + iImageFrameWidthDefault + "px -" + iFrameY + "px";
		}
	}
	
	function executeSlimeMonsterAnimation(inputArraySlimeMonsterWithIdCount) {		
		//hero tile position
		var mainImageTile = document.getElementById("mainImageTileImageId");
		
		inputArraySlimeMonsterWithIdCount[MONSTER_OBJECT].style.visibility="visible";
				
		if (inputArraySlimeMonsterWithIdCount[MONSTER_ANIMATION_DELAY_COUNT]>=inputArraySlimeMonsterWithIdCount[MONSTER_ANIMATION_DELAY_COUNT_MAX]) {
			inputArraySlimeMonsterWithIdCount[MONSTER_ANIMATION_COUNT]=(inputArraySlimeMonsterWithIdCount[MONSTER_ANIMATION_COUNT]+1)%2; //3; //last hidden

			inputArraySlimeMonsterWithIdCount[MONSTER_ANIMATION_DELAY_COUNT]=0;
			
			if (inputArraySlimeMonsterWithIdCount[MONSTER_STEP_DELAY]>=inputArraySlimeMonsterWithIdCount[MONSTER_STEP_DELAY_MAX]) {
				inputArraySlimeMonsterWithIdCount[MONSTER_STEP_DELAY]=0;
			}
			else {
				inputArraySlimeMonsterWithIdCount[MONSTER_STEP_DELAY]++;
			}				
		}
		else {
			inputArraySlimeMonsterWithIdCount[MONSTER_ANIMATION_DELAY_COUNT]++;
		}

		//var iFrameY=0;

		//==============================
		//AI; movement
		if (inputArraySlimeMonsterWithIdCount[MONSTER_ANIMATION_DELAY_COUNT]>=inputArraySlimeMonsterWithIdCount[MONSTER_ANIMATION_DELAY_COUNT_MAX]) {///2) {
		
			if (inputArraySlimeMonsterWithIdCount[MONSTER_POSY]<parseInt(mainImageTile.style.top)) {//mainImageTilePosY) {
				inputArraySlimeMonsterWithIdCount[MONSTER_POSY]+=inputArraySlimeMonsterWithIdCount[MONSTER_STEPY];				
			}
			else {
				inputArraySlimeMonsterWithIdCount[MONSTER_POSY]-=inputArraySlimeMonsterWithIdCount[MONSTER_STEPY];
			}
			
			inputArraySlimeMonsterWithIdCount[MONSTER_OBJECT].style.top=inputArraySlimeMonsterWithIdCount[MONSTER_POSY]+"px";

			//go to the right
			if (inputArraySlimeMonsterWithIdCount[MONSTER_POSX]<mainImageTilePosX) {
				inputArraySlimeMonsterWithIdCount[MONSTER_POSX]+=inputArraySlimeMonsterWithIdCount[MONSTER_STEPX];
				
				//iFrameY=0;
			}
			else {
				inputArraySlimeMonsterWithIdCount[MONSTER_POSX]-=inputArraySlimeMonsterWithIdCount[MONSTER_STEPX];
				
				//iFrameY=iImageFrameHeight*1;//2;//64*2; 128;
			}
			
			inputArraySlimeMonsterWithIdCount[MONSTER_OBJECT].style.left=inputArraySlimeMonsterWithIdCount[MONSTER_POSX]+"px";	
			
		}
		//==============================

		//var iFrameY=0;
		var iFrameY=iImageFrameHeight*1;//2;//64*2; 128;

		//currently two frames only
		if (inputArraySlimeMonsterWithIdCount[MONSTER_ANIMATION_COUNT]==0) { 
			inputArraySlimeMonsterWithIdCount[MONSTER_OBJECT].style.objectPosition = "-" + 0 + "px -" + iFrameY + "px";
		}
		else if (inputArraySlimeMonsterWithIdCount[MONSTER_ANIMATION_COUNT]==1) { 
			inputArraySlimeMonsterWithIdCount[MONSTER_OBJECT].style.objectPosition = "-" + iImageFrameWidthDefault + "px -" + iFrameY + "px";
		}
	}
	
	function executeExplosionEffect() {
		var explosionEffectImage = document.getElementById("explosionEffectImageId");

		if (explosionEffectImage.style.visibility=="hidden") {
			return;
		}

		if (iExplosionEffectAnimationDelayCount==iExplosionEffectAnimationDelayCountMax) {
	//	if (iExplosionEffectAnimationDelayCount>=iExplosionEffectAnimationDelayCountMax) {
			
			iExplosionEffectAnimationCount=(iExplosionEffectAnimationCount+1)%5; //last hidden

			iExplosionEffectAnimationDelayCount=0;
			/*
			explosionEffectImage.style.visibility="visible";
			*/
			
			//alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);
		}
		else {
			iExplosionEffectAnimationDelayCount++;

	//		alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);

		}

		//alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);
		
		//note: current output: fireball effect used in first frame only;
		iFrameY=0;
		//iFrameY=128;

		//put fireballExplosion as 1st frame
		if (iExplosionEffectAnimationCount==0) {
			iFrameY=128;
		}

		if (iExplosionEffectAnimationCount==0) { //%2
			explosionEffectImage.style.objectPosition = "-" + 0 + "px -" + iFrameY + "px";
		}
		else if (iExplosionEffectAnimationCount==1) {
			explosionEffectImage.style.objectPosition = "-" + 128 + "px -" + iFrameY + "px";
			//alert(">>>>");
		}
		else if (iExplosionEffectAnimationCount==2) {
			explosionEffectImage.style.objectPosition = "-" + 128*2 + "px -" + iFrameY + "px";
			//alert(">>>>");
		}
		else if (iExplosionEffectAnimationCount==3) {
			explosionEffectImage.style.objectPosition = "-" + 128*3 + "px -" + iFrameY + "px";
			//alert(">>>>");
		}
		else {
			explosionEffectImage.style.visibility="hidden";
			
			//alert("HALLO");
		}
	}
	
	function executeFireballExplosionEffect() {
		var fireballExplosionEffectImage = document.getElementById("fireballExplosionEffectImageId");

		if (fireballExplosionEffectImage.style.visibility=="hidden") {
			return;
		}

		if (iFireballExplosionEffectAnimationDelayCount==iFireballExplosionEffectAnimationDelayCountMax) {
	//	if (iExplosionEffectAnimationDelayCount>=iExplosionEffectAnimationDelayCountMax) {
			
			iFireballExplosionEffectAnimationCount=(iFireballExplosionEffectAnimationCount+1)%5; //last hidden

			iFireballExplosionEffectAnimationDelayCount=0;
			/*
			explosionEffectImage.style.visibility="visible";
			*/
			
			//alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);
		}
		else {
			iFireballExplosionEffectAnimationDelayCount++;

	//		alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);

		}

		//alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);
		
		//iFrameY=0;
		iFrameY=128;

		if (iFireballExplosionEffectAnimationCount==0) { //%2
			fireballExplosionEffectImage.style.objectPosition = "-" + 0 + "px -" + iFrameY + "px";
		}
		else if (iFireballExplosionEffectAnimationCount==1) {
			fireballExplosionEffectImage.style.objectPosition = "-" + 128 + "px -" + iFrameY + "px";
			//alert(">>>>");
		}
		else if (iFireballExplosionEffectAnimationCount==2) {
			fireballExplosionEffectImage.style.objectPosition = "-" + 128*2 + "px -" + iFrameY + "px";
			//alert(">>>>");
		}
		else if (iFireballExplosionEffectAnimationCount==3) {
			fireballExplosionEffectImage.style.objectPosition = "-" + 128*3 + "px -" + iFrameY + "px";
			//alert(">>>>");
		}
		else {
			fireballExplosionEffectImage.style.visibility="hidden";			
			//alert("HALLO");
		}		
	}

	function executeGrassCutEffect() {
		var grassCutEffectImage = document.getElementById("grassCutEffectImageId");

		if (grassCutEffectImage.style.visibility=="hidden") {
			return;
		}

		//alert("DITO");

		//var iFrameY=0;
		var iFrameY=iImageFrameHeight*2;		
		
		if (iGrassCutEffectAnimationDelayCount==iGrassCutEffectAnimationDelayCountMax) {			
			iGrassCutEffectAnimationCount=(iGrassCutEffectAnimationCount+1)%2; //last hidden

			iGrassCutEffectAnimationDelayCount=0;
		}
		else {
			iGrassCutEffectAnimationDelayCount++;
		}

		//alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);
		
		if (iGrassCutEffectAnimationCount==0) { //%2		
			grassCutEffectImage.style.objectPosition = "-" + iImageFrameWidthDefault*2 + "px -" + iFrameY + "px";
		}
		else {
			grassCutEffectImage.style.visibility="hidden";
		}
	}
	
	function executePearlAnimation() {
		var pearlImageTile = document.getElementById("pearlImageTileId");

		if (pearlImageTile.style.visibility=="hidden") {
			return;
		}

		//alert("DITO");

		var iFrameY=0;
		//var iFrameY=iImageFrameHeight*2;		
		
		if (iPearlAnimationDelayCount>=iPearlAnimationDelayCountMax) {			
			iPearlAnimationCount=(iPearlAnimationCount+1)%3;

			iPearlAnimationDelayCount=0;
		}
		else {
			iPearlAnimationDelayCount++;
		}

		//alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);
		
		pearlImageTile.style.objectPosition = "-" + iImageFrameWidthDefault*iPearlAnimationCount + "px -" + iFrameY + "px";

/*		
		if (iPearlAnimationCount==0) { //%2		
			pearlImageTile.style.objectPosition = "-" + iImageFrameWidthDefault*2 + "px -" + iFrameY + "px";
		}
		else {
			pearlImageTile.style.visibility="hidden";
		}
*/		
	}	

	function executeKeyAnimation() {
		var keyImageTile = document.getElementById("keyImageTileId");

		if (keyImageTile.style.visibility=="hidden") {
			return;
		}

		//alert("DITO");

		//var iFrameY=0;
		var iFrameY=iImageFrameHeight*3;		

/*		
		if (iKeyAnimationDelayCount>=iKeyAnimationDelayCountMax) {			
			iKeyAnimationCount=(iKeyAnimationCount+1)%3;

			iKeyAnimationDelayCount=0;
		}
		else {
			iKeyAnimationDelayCount++;
		}
*/
		iKeyAnimationDelayCount=0;

		//alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);
				
		//keyImageTile.style.objectPosition = "-" + iImageFrameWidthDefault*iKeyAnimationCount + "px -" + iFrameY + "px";

		keyImageTile.style.objectPosition = "-" + iImageFrameWidthDefault*0 + "px -" + iFrameY + "px";

/*		
		if (iPearlAnimationCount==0) { //%2		
			pearlImageTile.style.objectPosition = "-" + iImageFrameWidthDefault*2 + "px -" + iFrameY + "px";
		}
		else {
			pearlImageTile.style.visibility="hidden";
		}
*/		
	}	
	
	function executeAmuletAnimation() {
		var amuletImageTile = document.getElementById("amuletImageTileId");

		if (amuletImageTile.style.visibility=="hidden") {
			return;
		}

		//alert("DITO");

		//var iFrameY=0;
		var iFrameY=iImageFrameHeight*3;		
		
		//iAmuletAnimationDelayCount=0;
		//amuletImageTile.style.objectPosition = "-" + iImageFrameWidthDefault*2 + "px -" + iFrameY + "px";	
/*		
		if (iAmuletStatusAnimationDelayCount>=iAmuletStatusAnimationDelayCountMax) {			
			iAmuletStatusAnimationCount=(iAmuletStatusAnimationCount+1)%3;

			iAmuletStatusAnimationDelayCount=0;
		}
		else {
			iAmuletStatusAnimationDelayCount++;
		}
		
		amuletImageTile.style.objectPosition = "-" + iImageFrameWidthDefault*2-iImageFrameWidthDefault*iAmuletStatusAnimationCount + "px -" + iFrameY + "px";
*/
		
		//Game Off 2021; TUGON
		if (iAmuletStatusAnimationDelayCount<5) {//5) {
			//riverImageRight.style.objectPosition = "-" + 0 + "px -" + iFrameY + "px";
			iAmuletStatusAnimationCount=0;
		}
		else {
			if (iAmuletStatusAnimationDelayCount>10) {//10) {
				iAmuletStatusAnimationDelayCount=0;
			}
			//riverImageRight.style.objectPosition = "-" + iRiverImageFrameWidth + "px -" + iFrameY + "px";
			iAmuletStatusAnimationCount=1;
		}			
		iAmuletStatusAnimationDelayCount++;	

		amuletImageTile.style.objectPosition = "-" + iImageFrameWidthDefault*2-iImageFrameWidthDefault*(iAmuletStatusAnimationCount) + "px -" + iFrameY + "px";		
		
	}	
	
	function executePearlStatusAnimation() {
		var pearlStatusImageTile = document.getElementById("pearlStatusImageTileId");

		if (pearlStatusImageTile.style.visibility=="hidden") {
			return;
		}

		//alert("DITO");

		var iFrameY=0;
		//var iFrameY=iImageFrameHeight*2;		
		
		if (iPearlStatusAnimationDelayCount>=iPearlStatusAnimationDelayCountMax) {			
			iPearlStatusAnimationCount=(iPearlStatusAnimationCount+1)%3;

			iPearlStatusAnimationDelayCount=0;
		}
		else {
			iPearlStatusAnimationDelayCount++;
		}
		
		pearlStatusImageTile.style.objectPosition = "-" + iImageFrameWidthDefault*iPearlStatusAnimationCount + "px -" + iFrameY + "px";
	}	

	function executeKeyStatusAnimation() {
		var keyStatusImageTile = document.getElementById("keyStatusImageTileId");

		if (keyStatusImageTile.style.visibility=="hidden") {
			return;
		}

		//alert("DITO");

		var iFrameY=0;
		//var iFrameY=iImageFrameHeight*2;		
		
		if (iKeyStatusAnimationDelayCount>=iKeyStatusAnimationDelayCountMax) {			
			iKeyStatusAnimationCount=(iKeyStatusAnimationCount+1)%3;

			iKeyStatusAnimationDelayCount=0;
		}
		else {
			iKeyStatusAnimationDelayCount++;
		}
		
		keyStatusImageTile.style.objectPosition = "-" + iImageFrameWidthDefault*iKeyStatusAnimationCount + "px -" + iFrameY + "px";
	}		
	
	function executeHeroFireballProjectileAnimation() {
		var mainImageTileFireballProjectile = document.getElementById("mainImageTileFireballProjectileImageId");

		if (mainImageTileFireballProjectile.style.visibility=="hidden") {
			return;
		}

		//alert("DITO");

		//var iFrameY=0;
		var iFrameY=iImageFrameHeight*2;		
		
		if (iHeroFireballProjectileAnimationDelayCount>=iHeroFireballProjectileAnimationDelayCountMax) {			
			iHeroFireballProjectileAnimationCount=(iHeroFireballProjectileAnimationCount+1)%2;

			iHeroFireballProjectileAnimationDelayCount=0;
		}
		else {
			iHeroFireballProjectileAnimationDelayCount++;
		}		
		
		mainImageTileFireballProjectile.style.objectPosition = "-" + iImageFrameWidthDefault*iHeroFireballProjectileAnimationCount + "px -" + iFrameY + "px";
	 }		

	function updateHeroFireballProjectileHoldPositions() {
		var mainImageTileFireballProjectileHold = document.getElementById("mainImageTileFireballProjectileHoldImageId");

		//var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");
		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");

		mainImageTileFireballProjectileHold.style.left=mainImageTileHeroBody.style.left;
		mainImageTileFireballProjectileHold.style.top=mainImageTileHeroBody.style.top;

/*		
		//##===============
		//var iFrameY=0;
		var iFrameY=iImageFrameHeight*3;		
		
		if (iHeroFireballProjectileHoldAnimationDelayCount>=iHeroFireballProjectileHoldAnimationDelayCountMax) {			
			iHeroFireballProjectileHoldAnimationCount=(iHeroFireballProjectileHoldAnimationCount+1)%2;

			iHeroFireballProjectileHoldAnimationDelayCount=0;
		}
		else {
			iHeroFireballProjectileHoldAnimationDelayCount++;
		}		
		
		mainImageTileFireballProjectileHold.style.objectPosition = "-" + iImageFrameWidthDefault*iHeroFireballProjectileHoldAnimationCount + "px -" + iFrameY + "px";
		
		mainImageTileFireballProjectileHold.style.left=mainImageTileHeroBody.style.left;//+"px";
		mainImageTileFireballProjectileHold.style.top=mainImageTileHeroBody.style.top;//+"px";
*/		
	}
	 
	function executeHeroFireballProjectileHoldAnimation() {
		var mainImageTileFireballProjectileHold = document.getElementById("mainImageTileFireballProjectileHoldImageId");
		
		var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");
		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");

/*
		if (mainImageTileFireballProjectileHold.style.visibility=="hidden") {
			return;
		}
*/

//		mainImageTileFireballProjectileHold.style.visibility="visible";

		//alert("DITO");

		//var iFrameY=0;
		var iFrameY=iImageFrameHeight*3;		
		
		if (iHeroFireballProjectileHoldAnimationDelayCount>=iHeroFireballProjectileHoldAnimationDelayCountMax) {			
			iHeroFireballProjectileHoldAnimationCount=(iHeroFireballProjectileHoldAnimationCount+1)%2;

			iHeroFireballProjectileHoldAnimationDelayCount=0;
			
			//wait before setting to visible
			mainImageTileFireballProjectileHold.style.visibility="visible";
		}
		else {
			iHeroFireballProjectileHoldAnimationDelayCount++;
		}		
		
		mainImageTileFireballProjectileHold.style.objectPosition = "-" + iImageFrameWidthDefault*iHeroFireballProjectileHoldAnimationCount + "px -" + iFrameY + "px";
		
		mainImageTileFireballProjectileHold.style.left=mainImageTileHeroBody.style.left;//+"px";
		mainImageTileFireballProjectileHold.style.top=mainImageTileHeroBody.style.top;//+"px";
		
  }			 

  function executeExplosionEffectToMonsterBoss() {
		var explosionEffectImage = document.getElementById("explosionEffectToMonsterImageId");

		if (explosionEffectImage.style.visibility=="hidden") {
			return;
		}

		if (iMonsterExplosionEffectAnimationDelayCount==iMonsterExplosionEffectAnimationDelayCountMax) {
	//	if (iExplosionEffectAnimationDelayCount>=iExplosionEffectAnimationDelayCountMax) {
			iMonsterExplosionEffectAnimationCount=(iMonsterExplosionEffectAnimationCount+1)%5; //last hidden


			iMonsterExplosionEffectAnimationDelayCount=0;
			/*
			explosionEffectImage.style.visibility="visible";
			*/
		}
		else {
			iMonsterExplosionEffectAnimationDelayCount++;

	//		alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);

		}

		//alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);

		if (iMonsterExplosionEffectAnimationCount==0) { //%2
			explosionEffectImage.style.objectPosition = "-" + 0 + "px -" + 128 + "px";
		}
		else if (iMonsterExplosionEffectAnimationCount==1) {
			explosionEffectImage.style.objectPosition = "-" + 128 + "px -" + 128 + "px";
			//alert(">>>>");
		}
		else if (iMonsterExplosionEffectAnimationCount==2) {
			explosionEffectImage.style.objectPosition = "-" + 128*2 + "px -" + 128 + "px";
			//alert(">>>>");
		}
		else if (iMonsterExplosionEffectAnimationCount==3) {
			explosionEffectImage.style.objectPosition = "-" + 128*3 + "px -" + 128 + "px";
			//alert(">>>>");
		}
		else {
			explosionEffectImage.style.visibility="hidden";
		}
	}

	function executeExplosionEffectToCity() {
		var explosionEffectImage = document.getElementById("explosionEffectToCityImageId");

/*		
		if (iTransitionScale<1) {
			iTransitionScale+=0.1
		}
		else if (iTransitionScale>0) {
			iTransitionScale-=0.1
		}
*/
		//iTransitionScale=0.5;
		
//		explosionEffectImage.style.transform = "scale("+iTransitionScale+","+iTransitionScale+")";	

		//explosionEffectImage.style.transform = "scale("+0.5+","+0.5+")";	

		if (explosionEffectImage.style.visibility=="hidden") {
			return;
		}

		//alert("Dito");
		
		if (iMonsterExplosionEffectAnimationDelayCount==iMonsterExplosionEffectAnimationDelayCountMax) {
	//	if (iExplosionEffectAnimationDelayCount>=iExplosionEffectAnimationDelayCountMax) {
			iMonsterExplosionEffectAnimationCount=(iMonsterExplosionEffectAnimationCount+1)%5; //last hidden


			iMonsterExplosionEffectAnimationDelayCount=0;
			/*
			explosionEffectImage.style.visibility="visible";
			*/
		}
		else {
			iMonsterExplosionEffectAnimationDelayCount++;

	//		alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);

		}

		//alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);

		if (iMonsterExplosionEffectAnimationCount==0) { //%2
			explosionEffectImage.style.objectPosition = "-" + 0 + "px -" + 128 + "px";
		}
		else if (iMonsterExplosionEffectAnimationCount==1) {
			explosionEffectImage.style.objectPosition = "-" + 128 + "px -" + 128 + "px";
			//alert(">>>>");
		}
		else if (iMonsterExplosionEffectAnimationCount==2) {
			explosionEffectImage.style.objectPosition = "-" + 128*2 + "px -" + 128 + "px";
			//alert(">>>>");
		}
		else if (iMonsterExplosionEffectAnimationCount==3) {
			explosionEffectImage.style.objectPosition = "-" + 128*3 + "px -" + 128 + "px";
			//alert(">>>>");
		}
		else {
			explosionEffectImage.style.visibility="hidden";
		}
	}

	//added by Mike, 20241105
	function executeDustEffect() {
		var dustEffectImage = document.getElementById("dustEffectImageId");

		if (dustEffectImage.style.visibility=="hidden") {
			return;
		}

		if (iDustEffectAnimationDelayCount==iDustEffectAnimationDelayCountMax) {
			iDustEffectAnimationCount=(iDustEffectAnimationCount+1)%4;//5; //last hidden

			iDustEffectAnimationDelayCount=0;
		}
		else {
			iDustEffectAnimationDelayCount++;

	//		alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);
		}
		
		//dustEffectImage.style.objectPosition = "-" + 0 + "px -" + 256 + "px";

		//alert("iDustEffectAnimationCount: "+iDustEffectAnimationCount);

		if (iDustEffectAnimationCount==0) { //%2
			dustEffectImage.style.objectPosition = "-" + 0 + "px -" + 256 + "px";
		}
		else if (iDustEffectAnimationCount==1) {
			dustEffectImage.style.objectPosition = "-" + iImageDustEffectAnimationWidth + "px -" + 256 + "px";
			//alert(">>>>");
		}
		else if (iDustEffectAnimationCount==2) {
			dustEffectImage.style.objectPosition = "-" + iImageDustEffectAnimationWidth*2 + "px -" + 256 + "px";
			//alert(">>>>");
		}
////		else if (iExplosionEffectAnimationCount==3) {
////			explosionEffectImage.style.objectPosition = "-" + 128*3 + "px -" + 0 + "px";
////			//alert(">>>>");
////		}	
		else {
			dustEffectImage.style.visibility="hidden";
		}		
	}
	
	function executeInitFireballEffect() {
		var initFireballEffectImage = document.getElementById("initFireballEffectImageId");

		if (initFireballEffectImage.style.visibility=="hidden") {
			return;
		}

		if (iInitFireballEffectAnimationDelayCount==iInitFireballEffectAnimationDelayCountMax) {
			iInitFireballEffectAnimationCount=(iInitFireballEffectAnimationCount+1)%4;//5; //last hidden

			iInitFireballEffectAnimationDelayCount=0;
			
		}
		else {
			iInitFireballEffectAnimationDelayCount++;

	//		alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);
		}
		
		//dustEffectImage.style.objectPosition = "-" + 0 + "px -" + 256 + "px";

		//alert("iInitFireballEffectAnimationCount: "+iInitFireballEffectAnimationCount);
		
		var iFrameY=128*2+32*4;
		//var iFrameY=0;

		if (iInitFireballEffectAnimationCount==0) { //%2
			initFireballEffectImage.style.objectPosition = "-" + 0 + "px -" + iFrameY + "px";
		}
		else if (iInitFireballEffectAnimationCount==1) {
			initFireballEffectImage.style.objectPosition = "-" + 128 + "px -" + iFrameY + "px";
			//alert(">>>>");
		}
		else if (iInitFireballEffectAnimationCount==2) {
			initFireballEffectImage.style.objectPosition = "-" + 128*2 + "px -" + iFrameY + "px";
			//alert(">>>>");
		}
/*		
		else if (iInitFireballEffectAnimationCount==3) {
			initFireballEffectImage.style.objectPosition = "-" + 128*3 + "px -" + iFrameY + "px";
////			//alert(">>>>");
		}	
*/		
		else {
			initFireballEffectImage.style.visibility="hidden";
		}		
	}
	
	//added by Mike, 20241113
	function executeHeroAttackEffect() {
		var heroAttackEffectImage = document.getElementById("heroAttackEffectImageId");

		if (heroAttackEffectImage.style.visibility=="hidden") {
			return;
		}

		if (iHeroAttackEffectAnimationDelayCount==iHeroAttackEffectAnimationDelayCountMax) {
			iHeroAttackEffectAnimationCount=(iHeroAttackEffectAnimationCount+1)%4;//5; //last hidden

			iHeroAttackEffectAnimationDelayCount=0;
		}
		else {
			iHeroAttackEffectAnimationDelayCount++;
		}
		
		//dustEffectImage.style.objectPosition = "-" + 0 + "px -" + 256 + "px";

		//alert("iDustEffectAnimationCount: "+iDustEffectAnimationCount);

/*
		//heroAttackEffectImage is 32px below dustEffectImage
		if (iHeroAttackEffectAnimationCount==0) { //%2
			heroAttackEffectImage.style.objectPosition = "-" + 0 + "px -" + (256+iImageDustEffectAnimationHeight) + "px";
		}
		else if (iHeroAttackEffectAnimationCount==1) {
			heroAttackEffectImage.style.objectPosition = "-" + iImageHeroAttackEffectAnimationWidth + "px -" + (256+iImageDustEffectAnimationHeight) + "px";
			//alert(">>>>");
		}
		else if (iHeroAttackEffectAnimationCount==2) {
			heroAttackEffectImage.style.objectPosition = "-" + iImageHeroAttackEffectAnimationWidth*2 + "px -" + (256+iImageDustEffectAnimationHeight) + "px";
			//alert(">>>>");
		}
////		else if (iExplosionEffectAnimationCount==3) {
////			explosionEffectImage.style.objectPosition = "-" + 128*3 + "px -" + 0 + "px";
////			//alert(">>>>");
////		}	
		else {
			heroAttackEffectImage.style.visibility="hidden";
		}		
*/
		if (iHeroAttackEffectAnimationCount==0) { //%2
			heroAttackEffectImage.style.objectPosition = "-" + 0 + "px -" + (0) + "px";
		}
		else if (iHeroAttackEffectAnimationCount==1) {
			heroAttackEffectImage.style.objectPosition = "-" + iImageHeroAttackEffectAnimationWidth + "px -" + (0) + "px";
			//alert(">>>>");
		}
		else if (iHeroAttackEffectAnimationCount==2) {
			heroAttackEffectImage.style.objectPosition = "-" + iImageHeroAttackEffectAnimationWidth*2 + "px -" + (0) + "px";
			//alert(">>>>");
		}
		else {
			heroAttackEffectImage.style.visibility="hidden";
		}		
	}		

	function isElapsedTimeUnderThreeMins() {	
		return true;
	
		dElapsedTimeInSeconds=(Date.now()-iStartTimeInMilliseconds)/1000;

		dCurrTimeSeconds=(dElapsedTimeInSeconds)%60;
		dCurrTimeMinutes=((dElapsedTimeInSeconds)/60)%60;
		dCurrTimeHours=(dElapsedTimeInSeconds)/60/60;

		//max reached
		if (dCurrTimeHours>=60) {
			dCurrTimeMinutes=99;
			dCurrTimeSeconds=99;
			dCurrTimeHours=99;
		}		
		
		if (dCurrTimeHours>0) {
			return false;
		}

		if (dCurrTimeMinutes<60) {
			return true;
		}		
		
		return false;
	}
		
	function executeTimeDisplay() {
		var textTimeDiv = document.getElementById("textTimeDivId");

		if (!bIsMissionDone) {
			dElapsedTimeInSeconds=(Date.now()-iStartTimeInMilliseconds)/1000;
		}
		//otherwise, use current value of dElapsedTimeInSeconds;
		
/*			
		dElapsedTimeInSeconds=60*59;
		dElapsedTimeInSeconds=60*60;
		dElapsedTimeInSeconds=60*45*59;
*/			

		dCurrTimeSeconds=(dElapsedTimeInSeconds)%60;
		dCurrTimeMinutes=((dElapsedTimeInSeconds)/60)%60;
		dCurrTimeHours=(dElapsedTimeInSeconds)/60/60;

		//max reached
		if (dCurrTimeHours>=60) {
			dCurrTimeMinutes=99;
			dCurrTimeSeconds=99;
			dCurrTimeHours=99;
		}		

		sCurrTimeSeconds=parseInt(dCurrTimeSeconds);			
		if (parseInt(dCurrTimeSeconds)<10) {
			sCurrTimeSeconds="0"+sCurrTimeSeconds;
		}

		sCurrTimeMinutes=parseInt(dCurrTimeMinutes);			
		if (parseInt(dCurrTimeMinutes)<10) {
			sCurrTimeMinutes="0"+sCurrTimeMinutes;
		}
		
		sCurrTimeHours=parseInt(dCurrTimeHours);			
		if (parseInt(dCurrTimeHours)<10) {
			sCurrTimeHours="0"+sCurrTimeHours;
		}

		
		//textTimeDiv.innerHTML = parseInt(dCurrTimeMinutes) + ":" + sCurrTimeSeconds;//sCurrTime;
		textTimeDiv.innerHTML = sCurrTimeHours + ":" + sCurrTimeMinutes + ":" + sCurrTimeSeconds;	
		textTimeDiv.style.visibility = "visible";
	}

	//function heroHitByMonster(mainImageTilePosX, mainImageTilePosY, iMonsterImageTilePosX, iMonsterImageTilePosY) {			
	function heroHitByMonster(mainImageTilePosX, mainImageTilePosY, iMonsterImageTilePosX, iMonsterImageTilePosY, iMonsterAttackDamage) {				
		if (iHeroInvincibileCount<iHeroInvincibileCountMax) {
			return;
		}

		bIsHeroAttacked=true;
		bIsExecutingShake=true;

		//iCurrHeroLife--;
		iCurrHeroLife-=iMonsterAttackDamage;
		
		if (iCurrHeroLife<0) {
			iCurrHeroLife=0;
		}
				
		iHeroInvincibileCount=0;
				
		resetProjectile();	
	}
	
	function monsterHitByHero(mainImageTilePosX, mainImageTilePosY, iMonsterImageTilePosX, iMonsterImageTilePosY) {	
		
		//+iImageFrameWidthDefault/2
		//iImageFrameHeightDefault/2
				
		setHeroAttackEffectPosition(iMonsterImageTilePosX,iMonsterImageTilePosY); 
		
		resetProjectile();
		
		var myAudioEffectCannonFire = document.getElementById("myAudioEffectCannonFireId");

		myAudioEffectCannonFire.setAttribute("src", sAudioEffectActionCannonFire);

		//fMyAudioEffectVolume=0.2;
		fMyAudioEffectCannonFireVolume=1.0;
		myAudioEffectCannonFire.volume=fMyAudioEffectCannonFireVolume;
		myAudioEffectCannonFire.loop=false;
		myAudioEffectCannonFire.play();
	}

	function grassMonsterHitByHero(mainImageTilePosX, mainImageTilePosY, iMonsterImageTilePosX, iMonsterImageTilePosY) {	
		
		//+iImageFrameWidthDefault/2
		//iImageFrameHeightDefault/2
				
		setHeroAttackEffectPosition(iMonsterImageTilePosX,iMonsterImageTilePosY); 
		
		resetProjectile();
		
		var myAudioEffectGrassCut = document.getElementById("myAudioEffectGrassCutId");

		myAudioEffectGrassCut.setAttribute("src", sAudioEffectGrassCut);

		//fMyAudioEffectVolume=0.2;
		fMyAudioEffectGrassCutVolume=1.0;
		myAudioEffectGrassCut.volume=fMyAudioEffectGrassCutVolume;
		myAudioEffectGrassCut.loop=false;
		myAudioEffectGrassCut.play();
	}

	function monsterHitByHeroFireball(mainImageTileFireballProjectilePosX, mainImageTileFireballProjectilePosY, iMonsterImageTilePosX, iMonsterImageTilePosY) {	
		
		//+iImageFrameWidthDefault/2
		//iImageFrameHeightDefault/2
		
		setHeroAttackEffectPosition(iMonsterImageTilePosX,iMonsterImageTilePosY); 
		
		resetProjectile();
		resetFireballProjectile();
		
		var myAudioEffectCannonFire = document.getElementById("myAudioEffectCannonFireId");

		myAudioEffectCannonFire.setAttribute("src", sAudioEffectActionCannonFire);

		//fMyAudioEffectVolume=0.2;
		fMyAudioEffectCannonFireVolume=1.0;
		myAudioEffectCannonFire.volume=fMyAudioEffectCannonFireVolume;
		myAudioEffectCannonFire.loop=false;
		myAudioEffectCannonFire.play();		
	}
	
	function verifyHeroCollideWithRiver() {
		var riverImageTile = document.getElementById("riverImageRightId");

		var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");
		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");
		
		//alert(mainImageTilePosX);
		
		var iRiverImagePosXOffset=iImageFrameWidth/2;
		var iRiverImagePosYOffset=0;
		
		if (isPointsOfRectIntersectingPointsOfRectMonster(mainImageTilePosX,mainImageTilePosY, iRiverImagePosX+iRiverImagePosXOffset, iRiverImagePosY+iRiverImagePosYOffset, iImageFrameWidth, iImageFrameHeight, iRiverImageFrameWidth, iRiverImageFrameHeight)) {			
			//alert("HALLO"); 	

			//heroHitByMonster(mainImageTilePosX,mainImageTilePosY, batMonsterImageTilePosX,batMonsterImageTilePosY);
			
			if (!bIsHeroInRiver) {
				myAudioWater.play();
			}
			
			bIsHeroInRiver=true;	
			bIsHeroDash=false;

			//alert("Dito");
		}
		else {
			bIsHeroInRiver=false;
		}
	}
	
	function verifySnakeCollideWithRiver(inputArraySnakeMonsterWithIdCount) {
		var riverImageTile = document.getElementById("riverImageRightId");

		var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");
		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");
		
		//alert(mainImageTilePosX);
		
		var iRiverImagePosXOffset=iImageFrameWidth/2;
		var iRiverImagePosYOffset=0;
		
		if (!inputArraySnakeMonsterWithIdCount[MONSTER_IS_ACTIVE]) {
				return;
		}		
		else { //if (isBatMonsterTileActive) {						

			if (bIsHeroAttacked) {
				//bIsHeroAttacked=false;
				return;
			}
			
			if (isPointsOfRectIntersectingPointsOfRectMonster(inputArraySnakeMonsterWithIdCount[MONSTER_POSX],inputArraySnakeMonsterWithIdCount[MONSTER_POSY], iRiverImagePosX+iRiverImagePosXOffset, iRiverImagePosY+iRiverImagePosYOffset,iImageFrameWidth, iImageFrameHeight, iRiverImageFrameWidth, iRiverImageFrameHeight)) {	
				
				if (!inputArraySnakeMonsterWithIdCount[MONSTER_IS_IN_RIVER]) {
					myAudioWater.play();
				}
				inputArraySnakeMonsterWithIdCount[MONSTER_IS_IN_RIVER]=true;	
			}
			else {
				inputArraySnakeMonsterWithIdCount[MONSTER_IS_IN_RIVER]=false;			
			}
		}
	}		
	
	function verifyHeroCollideWithBatMonsters() {
		var batMonsterImageTile = document.getElementById("batMonsterImageId");

		var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");
		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");	

		if (!isBatMonsterTileActive) {
			return;
		}		
		//if (batMonsterImageTile.style.visibility!=="hidden") {						
		else { //if (isBatMonsterTileActive) {						

			if (bIsHeroAttacked) {
				//bIsHeroAttacked=false;
				return;
			}
			
			//bIsHeroAttacked=false;		

			//+iImageFrameWidthDefault/2; iImageFrameHeightDefault/2
			if (isPointsOfRectIntersectingPointsOfRectMonster(mainImageTilePosX,mainImageTilePosY, batMonsterImageTilePosX,batMonsterImageTilePosY, iImageFrameWidth, iImageFrameHeight, iImageFrameWidthDefault, iImageFrameHeightDefault)) {			
				//alert("HALLO"); 	
				
				//verify if hero attacked
				if (bHasFired && (isPointsOfRectIntersectingPointsOfRectMonster(mainImageTileProjectileStepDestinationX-iImageFrameWidthDefault/2,mainImageTileProjectileStepDestinationY-iImageFrameHeightDefault/2, batMonsterImageTilePosX,batMonsterImageTilePosY, iImageFrameWidth, iImageFrameHeight, iImageFrameWidthDefault, iImageFrameHeightDefault))) {
					monsterHitByHero(mainImageTilePosX,mainImageTilePosY, batMonsterImageTilePosX,batMonsterImageTilePosY);
										
					setExplosionEffectPosition(batMonsterImageTilePosX,batMonsterImageTilePosY);
					
					batMonsterImageTile.style.visibility="hidden";				
					isBatMonsterTileActive=false;
					iCurrMonsterDeathCount++;
				}
				else {			
/*				
					if (iHeroInvincibileCount<iHeroInvincibileCountMax) {
						return;
					}

					bIsHeroAttacked=true;
					bIsExecutingShake=true;
*/

					//Usbong SFZ
					//TODO: -add: hitBy(...)
					//heroHitByMonster(mainImageTilePosX,mainImageTilePosY, batMonsterImageTilePosX,batMonsterImageTilePosY);
					heroHitByMonster(mainImageTilePosX,mainImageTilePosY, batMonsterImageTilePosX,batMonsterImageTilePosY, iMonsterAttackDamageDefault);
				}
				
				//batMonsterImageTile.style.visibility="hidden";
				
				//isBatMonsterTileActive=false;
/*				
				if (bIsHeroInTank) {
					mainImageTileTankBody.style.visibility="hidden";				
				}
				else {
					mainImageTileHeroBody.style.visibility="hidden";
				}				
*/				
			}
/*			
			else {
				if (bIsHeroAttacked) {
					//alert("DITO");
				}
				bIsHeroAttacked=false;		
			}
*/			
		}
	}
	
	function verifyHeroFireballCollideWithBatMonsters() {
		var batMonsterImageTile = document.getElementById("batMonsterImageId");

		var mainImageTileFireballProjectile = document.getElementById("mainImageTileFireballProjectileImageId");

		var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");
		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");	

		if (!isBatMonsterTileActive) {
			return;
		}		
		else {
			if (bIsHeroAttacked) {
				//bIsHeroAttacked=false;
				return;
			}
			
			//bIsHeroAttacked=false;		

			//+iImageFrameWidthDefault/2; iImageFrameHeightDefault/2
			if (isPointsOfRectIntersectingPointsOfRectMonster(parseInt(mainImageTileFireballProjectilePosX),parseInt(mainImageTileFireballProjectilePosY), batMonsterImageTilePosX,batMonsterImageTilePosY, iImageFrameWidth, iImageFrameHeight, iImageFrameWidthDefault, iImageFrameHeightDefault)) {			
				
				//verify if hero attacked
				//if (bHasFired && bHasHeroShotFireball) {
				if (bHasHeroShotFireball) {
				
					//alert("HALLO"); 	
				
					monsterHitByHeroFireball(parseInt(mainImageTileFireballProjectilePosX),parseInt(mainImageTileFireballProjectilePosY), batMonsterImageTilePosX,batMonsterImageTilePosY);
					//setExplosionEffectPosition(batMonsterImageTilePosX,batMonsterImageTilePosY);
					
					setFireballExplosionEffectPosition(batMonsterImageTilePosX,batMonsterImageTilePosY);
					
					batMonsterImageTile.style.visibility="hidden";				
					isBatMonsterTileActive=false;
					iCurrMonsterDeathCount++;					
				}
			}
		}
	}

	function verifyHeroCollideWithBossMonster() {
		var bossMonsterImageTile = document.getElementById("bossMonsterImageId");

		var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");
		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");	

		if (!isBossMonsterTileActive) {
			return;
		}		
		else { 

			if (bIsHeroAttacked) {
				//bIsHeroAttacked=false;
				return;
			}
			
			//bIsHeroAttacked=false;		

			//note iImageFrameWidthLarge*2;  iImageFrameHeightLarge*2
			if (isPointsOfRectIntersectingPointsOfRectMonsterLarge(mainImageTilePosX,mainImageTilePosY, bossMonsterImageTilePosX,bossMonsterImageTilePosY, iImageFrameWidth, iImageFrameHeight, iImageFrameWidthLarge*2, iImageFrameHeightLarge*2)) {			
				//alert("HALLO"); 	
				
				//verify if hero attacked
				if (bHasFired && (isPointsOfRectIntersectingPointsOfRectMonster(mainImageTileProjectileStepDestinationX-iImageFrameWidthDefault/2,mainImageTileProjectileStepDestinationY-iImageFrameHeightDefault/2, bossMonsterImageTilePosX,bossMonsterImageTilePosY, iImageFrameWidth, iImageFrameHeight, iImageFrameWidthLarge*2, iImageFrameHeightLarge*2))) {
					
					//large
					monsterHitByHero(mainImageTilePosX,mainImageTilePosY, bossMonsterImageTilePosX+iImageFrameWidthLarge/2*2,bossMonsterImageTilePosY+iImageFrameHeightLarge/2*2);
	
	//monsterHitByHeroFireball(parseInt(mainImageTileFireballProjectilePosX),parseInt(mainImageTileFireballProjectilePosY), bossMonsterImageTilePosX+iImageFrameWidthLarge/2*2,bossMonsterImageTilePosY+iImageFrameHeightLarge/2*2);
										
					setExplosionEffectPositionLarge(bossMonsterImageTilePosX+iImageFrameWidthLarge/2,bossMonsterImageTilePosY+iImageFrameHeightLarge/2);
					
					bIsBossMonsterHit=true;
					
					iCurrBossMonsterLife--;
										
					//remove this temporarily; debug
					if (iCurrBossMonsterLife<=0) {					
						bossMonsterImageTile.style.visibility="hidden";				
						isBossMonsterTileActive=false;
						iCurrMonsterDeathCount++;
					}						
				}
				else {			
					heroHitByMonster(mainImageTilePosX,mainImageTilePosY, bossMonsterImageTilePosX,bossMonsterImageTilePosY,iMonsterAttackDamageBoss);
				}
			}
		}
	}
	
	function verifyHeroFireballCollideWithBossMonster() {
		var bossMonsterImageTile = document.getElementById("bossMonsterImageId");

		var mainImageTileFireballProjectile = document.getElementById("mainImageTileFireballProjectileImageId");

		var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");
		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");	

		if (!isBossMonsterTileActive) {
			return;
		}		
		else {
			if (bIsHeroAttacked) {
				return;
			}
			
			if (isPointsOfRectIntersectingPointsOfRectMonster(parseInt(mainImageTileFireballProjectilePosX),parseInt(mainImageTileFireballProjectilePosY), bossMonsterImageTilePosX,bossMonsterImageTilePosY, iImageFrameWidth, iImageFrameHeight, iImageFrameWidthLarge*2, iImageFrameHeightLarge*2)) {			

				//verify if hero attacked
				//if (bHasFired && bHasHeroShotFireball) {
				if (bHasHeroShotFireball) {
				
					//alert("HALLO"); 	
					
					//large
					monsterHitByHeroFireball(parseInt(mainImageTileFireballProjectilePosX),parseInt(mainImageTileFireballProjectilePosY), bossMonsterImageTilePosX+iImageFrameWidthLarge/2*2,bossMonsterImageTilePosY+iImageFrameHeightLarge/2*2);
					
					setFireballExplosionEffectPositionLarge(bossMonsterImageTilePosX+iImageFrameWidthLarge/2,bossMonsterImageTilePosY+iImageFrameHeightLarge/2);
					
					bIsBossMonsterHit=true;
					
					iCurrBossMonsterLife--;
					
					if (iCurrBossMonsterLife<=0) {										
						bossMonsterImageTile.style.visibility="hidden";				
						isBossMonsterTileActive=false;
						iCurrMonsterDeathCount++;					
					}
				}
			}
		}
	}			
		
	function verifyHeroCollideWithMiniBossMonsters(inputArrayMiniBossMonsterWithIdCount) {			
		var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");
		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");	
	
		//alert(inputArraySnakeMonsterWithIdCount[MONSTER_IS_ACTIVE]);

			if (!inputArrayMiniBossMonsterWithIdCount[MONSTER_IS_ACTIVE]) {
				return;
			}		
			else { //if (isBatMonsterTileActive) {						

				if (bIsHeroAttacked) {
					//bIsHeroAttacked=false;
					return;
				}
			
			//bIsHeroAttacked=false;		

			//+iImageFrameWidthDefault/2; iImageFrameHeightDefault/2
				if (isPointsOfRectIntersectingPointsOfRectMonster(mainImageTilePosX,mainImageTilePosY, inputArrayMiniBossMonsterWithIdCount[MONSTER_POSX],inputArrayMiniBossMonsterWithIdCount[MONSTER_POSY], iImageFrameWidth, iImageFrameHeight, iImageFrameWidthDefault, iImageFrameHeightDefault)) {			
					//alert("HALLO"); 	
					
					//verify if hero attacked
					if (bHasFired && (isPointsOfRectIntersectingPointsOfRectMonster(mainImageTileProjectileStepDestinationX-iImageFrameWidthDefault/2,mainImageTileProjectileStepDestinationY-iImageFrameHeightDefault/2, inputArrayMiniBossMonsterWithIdCount[MONSTER_POSX],inputArrayMiniBossMonsterWithIdCount[MONSTER_POSY], iImageFrameWidth, iImageFrameHeight, iImageFrameWidthDefault, iImageFrameHeightDefault))) {
						monsterHitByHero(mainImageTilePosX,mainImageTilePosY, inputArrayMiniBossMonsterWithIdCount[MONSTER_POSX],inputArrayMiniBossMonsterWithIdCount[MONSTER_POSY]);
												
						setExplosionEffectPosition(inputArrayMiniBossMonsterWithIdCount[MONSTER_POSX],inputArrayMiniBossMonsterWithIdCount[MONSTER_POSY]);
						
						inputArrayMiniBossMonsterWithIdCount[MONSTER_OBJECT].style.visibility="hidden";				
						inputArrayMiniBossMonsterWithIdCount[MONSTER_IS_ACTIVE]=false;
						iCurrMonsterDeathCount++;		

						//prepare next miniBossMonster
						iMiniBossMonsterMovementDelayCount=0;
					}
					else {			
						heroHitByMonster(mainImageTilePosX,mainImageTilePosY, inputArrayMiniBossMonsterWithIdCount[MONSTER_POSX],inputArrayMiniBossMonsterWithIdCount[MONSTER_POSY],iMonsterAttackDamageDefault);
					}
				}
			}
	}

	function verifyHeroFireballCollideWithMiniBossMonsters(inputArrayMiniBossMonsterWithIdCount) {			
		var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");
		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");	
	
		//alert(inputArraySnakeMonsterWithIdCount[MONSTER_IS_ACTIVE]);

		if (!inputArrayMiniBossMonsterWithIdCount[MONSTER_IS_ACTIVE]) {
			return;
		}		
		else { //if (isBatMonsterTileActive) {						

			if (bIsHeroAttacked) {
				//bIsHeroAttacked=false;
				return;
			}
			
			//bIsHeroAttacked=false;		
			
			if (isPointsOfRectIntersectingPointsOfRectMonster(parseInt(mainImageTileFireballProjectilePosX),parseInt(mainImageTileFireballProjectilePosY), inputArrayMiniBossMonsterWithIdCount[MONSTER_POSX],inputArrayMiniBossMonsterWithIdCount[MONSTER_POSY], iImageFrameWidth, iImageFrameHeight, iImageFrameWidthDefault, iImageFrameHeightDefault)) {			
				//verify if hero attacked
				//if (bHasFired && bHasHeroShotFireball) {
				if (bHasHeroShotFireball) {
					//alert("HALLO"); 	
					monsterHitByHeroFireball(parseInt(mainImageTileFireballProjectilePosX),parseInt(mainImageTileFireballProjectilePosY), inputArrayMiniBossMonsterWithIdCount[MONSTER_POSX],inputArrayMiniBossMonsterWithIdCount[MONSTER_POSY]);
					//setExplosionEffectPosition(batMonsterImageTilePosX,batMonsterImageTilePosY);
					
					setFireballExplosionEffectPosition(inputArrayMiniBossMonsterWithIdCount[MONSTER_POSX],inputArrayMiniBossMonsterWithIdCount[MONSTER_POSY]);
					
					inputArrayMiniBossMonsterWithIdCount[MONSTER_OBJECT].style.visibility="hidden";				
					inputArrayMiniBossMonsterWithIdCount[MONSTER_IS_ACTIVE]=false;
					iCurrMonsterDeathCount++;
				}
			}
		}
	}			

			
	function verifyHeroCollideWithSnakeMonsters(inputArraySnakeMonsterWithIdCount) {
			
		var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");
		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");	
	
		//alert(inputArraySnakeMonsterWithIdCount[MONSTER_IS_ACTIVE]);

	
//		for (iCount=0; iCount<iSnakeMonsterCountMax; iCount++) {
			//inputArraySnakeMonsterWithIdCount[MONSTER_OBJECT]= document.getElementById("snakeMonsterImageId"+iCount);

			//alert(arraySnakeMonsterCountId[iCount][MONSTER_IS_ACTIVE]);

			if (!inputArraySnakeMonsterWithIdCount[MONSTER_IS_ACTIVE]) {
				return;
			}		
			else { //if (isBatMonsterTileActive) {						

				if (bIsHeroAttacked) {
					//bIsHeroAttacked=false;
					return;
				}
			
			//bIsHeroAttacked=false;		

			//+iImageFrameWidthDefault/2; iImageFrameHeightDefault/2
				if (isPointsOfRectIntersectingPointsOfRectMonster(mainImageTilePosX,mainImageTilePosY, inputArraySnakeMonsterWithIdCount[MONSTER_POSX],inputArraySnakeMonsterWithIdCount[MONSTER_POSY], iImageFrameWidth, iImageFrameHeight, iImageFrameWidthDefault, iImageFrameHeightDefault)) {			
					//alert("HALLO"); 	
					
					//verify if hero attacked
					if (bHasFired && (isPointsOfRectIntersectingPointsOfRectMonster(mainImageTileProjectileStepDestinationX-iImageFrameWidthDefault/2,mainImageTileProjectileStepDestinationY-iImageFrameHeightDefault/2, inputArraySnakeMonsterWithIdCount[MONSTER_POSX],inputArraySnakeMonsterWithIdCount[MONSTER_POSY], iImageFrameWidth, iImageFrameHeight, iImageFrameWidthDefault, iImageFrameHeightDefault))) {
						monsterHitByHero(mainImageTilePosX,mainImageTilePosY, inputArraySnakeMonsterWithIdCount[MONSTER_POSX],inputArraySnakeMonsterWithIdCount[MONSTER_POSY]);
												
						setExplosionEffectPosition(inputArraySnakeMonsterWithIdCount[MONSTER_POSX],inputArraySnakeMonsterWithIdCount[MONSTER_POSY]);
						
						inputArraySnakeMonsterWithIdCount[MONSTER_OBJECT].style.visibility="hidden";				
						inputArraySnakeMonsterWithIdCount[MONSTER_IS_ACTIVE]=false;
						iCurrMonsterDeathCount++;						
					}
					else {			
/*					
						bIsHeroAttacked=true;
						bIsExecutingShake=true;
*/
						//Usbong SFZ
						//TODO: -add: hitBy(...)
						heroHitByMonster(mainImageTilePosX,mainImageTilePosY, inputArraySnakeMonsterWithIdCount[MONSTER_POSX],inputArraySnakeMonsterWithIdCount[MONSTER_POSY],iMonsterAttackDamageDefault);
					}
				}
			}
		//}
	}		
	
	function verifyHeroFireballCollideWithSnakeMonsters(inputArraySnakeMonsterWithIdCount) {
			
		var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");
		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");	
	
		//alert(inputArraySnakeMonsterWithIdCount[MONSTER_IS_ACTIVE]);

		if (!inputArraySnakeMonsterWithIdCount[MONSTER_IS_ACTIVE]) {
			return;
		}		
		else { //if (isBatMonsterTileActive) {						

			if (bIsHeroAttacked) {
				//bIsHeroAttacked=false;
				return;
			}
			
			//bIsHeroAttacked=false;		
			
			if (isPointsOfRectIntersectingPointsOfRectMonster(parseInt(mainImageTileFireballProjectilePosX),parseInt(mainImageTileFireballProjectilePosY), inputArraySnakeMonsterWithIdCount[MONSTER_POSX],inputArraySnakeMonsterWithIdCount[MONSTER_POSY], iImageFrameWidth, iImageFrameHeight, iImageFrameWidthDefault, iImageFrameHeightDefault)) {			
				//verify if hero attacked
				//if (bHasFired && bHasHeroShotFireball) {
				if (bHasHeroShotFireball) {
					//alert("HALLO"); 	
					monsterHitByHeroFireball(parseInt(mainImageTileFireballProjectilePosX),parseInt(mainImageTileFireballProjectilePosY), inputArraySnakeMonsterWithIdCount[MONSTER_POSX],inputArraySnakeMonsterWithIdCount[MONSTER_POSY]);
					//setExplosionEffectPosition(batMonsterImageTilePosX,batMonsterImageTilePosY);
					
					setFireballExplosionEffectPosition(inputArraySnakeMonsterWithIdCount[MONSTER_POSX],inputArraySnakeMonsterWithIdCount[MONSTER_POSY]);
					
					inputArraySnakeMonsterWithIdCount[MONSTER_OBJECT].style.visibility="hidden";				
					inputArraySnakeMonsterWithIdCount[MONSTER_IS_ACTIVE]=false;
					iCurrMonsterDeathCount++;
				}
			}
		}
	}			
	
	function verifyHeroCollideWithGrassMonsters(inputArrayGrassMonsterWithIdCount) {
		var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");
		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");	
	
		if (!inputArrayGrassMonsterWithIdCount[MONSTER_IS_ACTIVE]) {
			return;
		}		
		else { //if (isBatMonsterTileActive) {						

			if (bIsHeroAttacked) {
				//bIsHeroAttacked=false;
				return;
			}

/*		
			if (isPointsOfRectIntersectingPointsOfRectMonster(mainImageTilePosX,mainImageTilePosY, inputArrayGrassMonsterWithIdCount[MONSTER_POSX],inputArrayGrassMonsterWithIdCount[MONSTER_POSY], iImageFrameWidth, iImageFrameHeight, iImageFrameWidthDefault, iImageFrameHeightDefault)) {			
*/
			var iGrassXOffset=iImageFrameWidthDefault*0.5;
			var iGrassYOffset=iImageFrameHeightDefault*0.5;
			
			if (isPointsOfRectIntersectingPointsOfRectMonster(mainImageTilePosX,mainImageTilePosY, inputArrayGrassMonsterWithIdCount[MONSTER_POSX]+iGrassXOffset,inputArrayGrassMonsterWithIdCount[MONSTER_POSY]+iGrassYOffset, iImageFrameWidth, iImageFrameHeight, iImageFrameWidthDefault-iGrassXOffset, iImageFrameHeightDefault-iGrassYOffset)) {
				//alert("HALLO"); 	
				
				//verify if hero attacked
/*				
				if (bHasFired && (isPointsOfRectIntersectingPointsOfRectMonster(mainImageTileProjectileStepDestinationX-iImageFrameWidthDefault/2,mainImageTileProjectileStepDestinationY-iImageFrameHeightDefault/2, inputArrayGrassMonsterWithIdCount[MONSTER_POSX],inputArrayGrassMonsterWithIdCount[MONSTER_POSY], iImageFrameWidth, iImageFrameHeight, iImageFrameWidthDefault, iImageFrameHeightDefault))) {
*/				
				//no need to cut grass if destination is at different location
				if (bHasFired && (isPointsOfRectIntersectingPointsOfRectMonster(mainImageTileProjectileStepDestinationX-iImageFrameWidthDefault/2,mainImageTileProjectileStepDestinationY-iImageFrameHeightDefault/2, inputArrayGrassMonsterWithIdCount[MONSTER_POSX]+iGrassXOffset,inputArrayGrassMonsterWithIdCount[MONSTER_POSY]+iGrassYOffset, iImageFrameWidth, iImageFrameHeight, iImageFrameWidthDefault-iGrassXOffset, iImageFrameHeightDefault-iGrassYOffset))) {

					if (bHasFired) {
						//monsterHitByHero(mainImageTilePosX,mainImageTilePosY, inputArrayGrassMonsterWithIdCount[MONSTER_POSX],inputArrayGrassMonsterWithIdCount[MONSTER_POSY]);
							
						grassMonsterHitByHero(mainImageTilePosX,mainImageTilePosY, inputArrayGrassMonsterWithIdCount[MONSTER_POSX],inputArrayGrassMonsterWithIdCount[MONSTER_POSY]);
							
						setGrassCutEffectPosition(inputArrayGrassMonsterWithIdCount[MONSTER_POSX],inputArrayGrassMonsterWithIdCount[MONSTER_POSY]);
						
						inputArrayGrassMonsterWithIdCount[MONSTER_OBJECT].style.visibility="hidden";				
						inputArrayGrassMonsterWithIdCount[MONSTER_IS_ACTIVE]=false;					
					}
				}
			}
		}
	}			
	
	function verifyHeroCollideWithSlimeMonsters(iSlimeCount, inputArraySlimeMonsterWithIdCount) {
			
		var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");
		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");	
	
		//alert(inputArraySnakeMonsterWithIdCount[MONSTER_IS_ACTIVE]);

	
//		for (iCount=0; iCount<iSnakeMonsterCountMax; iCount++) {
			//inputArraySnakeMonsterWithIdCount[MONSTER_OBJECT]= document.getElementById("snakeMonsterImageId"+iCount);

			//alert(arraySnakeMonsterCountId[iCount][MONSTER_IS_ACTIVE]);

			if (!inputArraySlimeMonsterWithIdCount[MONSTER_IS_ACTIVE]) {
				return;
			}		
			else { //if (isBatMonsterTileActive) {						

				if (bIsHeroAttacked) {
					//bIsHeroAttacked=false;
					return;
				}
			
			//bIsHeroAttacked=false;		
			
			if (isPointsOfRectIntersectingPointsOfRectMonster(parseInt(mainImageTileFireballProjectilePosX),parseInt(mainImageTileFireballProjectilePosY), inputArraySlimeMonsterWithIdCount[MONSTER_POSX],inputArraySlimeMonsterWithIdCount[MONSTER_POSY], iImageFrameWidth, iImageFrameHeight, iImageFrameWidthDefault, iImageFrameHeightDefault)) {			
				//verify if hero attacked
				//if (bHasFired && bHasHeroShotFireball) {
				if (bHasHeroShotFireball) {
					//alert("HALLO"); 	
					monsterHitByHeroFireball(parseInt(mainImageTileFireballProjectilePosX),parseInt(mainImageTileFireballProjectilePosY), inputArraySlimeMonsterWithIdCount[MONSTER_POSX],inputArraySlimeMonsterWithIdCount[MONSTER_POSY]);
					//setExplosionEffectPosition(batMonsterImageTilePosX,batMonsterImageTilePosY);
					
					setFireballExplosionEffectPosition(inputArraySlimeMonsterWithIdCount[MONSTER_POSX],inputArraySlimeMonsterWithIdCount[MONSTER_POSY]);
					
					inputArraySlimeMonsterWithIdCount[MONSTER_OBJECT].style.visibility="hidden";				
					inputArraySlimeMonsterWithIdCount[MONSTER_IS_ACTIVE]=false;
					iCurrMonsterDeathCount++;
										
					if (iSlimeCount==0) {
						//show the rest of the children slime
						arraySlimeMonsterCountId[1][MONSTER_OBJECT].style.visibility="visible";
						arraySlimeMonsterCountId[1][MONSTER_IS_ACTIVE]=true;
						arraySlimeMonsterCountId[1][MONSTER_POSX]=inputArraySlimeMonsterWithIdCount[MONSTER_POSX]+iImageFrameWidthDefault*1; //3
						arraySlimeMonsterCountId[1][MONSTER_POSY]=inputArraySlimeMonsterWithIdCount[MONSTER_POSY];
						
						arraySlimeMonsterCountId[2][MONSTER_OBJECT].style.visibility="visible";
						arraySlimeMonsterCountId[2][MONSTER_IS_ACTIVE]=true;
						arraySlimeMonsterCountId[2][MONSTER_POSX]=inputArraySlimeMonsterWithIdCount[MONSTER_POSX]-iImageFrameWidthDefault*1; //3
						arraySlimeMonsterCountId[2][MONSTER_POSY]=inputArraySlimeMonsterWithIdCount[MONSTER_POSY];
					}											
				}
			}
		}
	}		

	function verifyHeroFireballCollideWithSlimeMonsters(iSlimeCount, inputArraySlimeMonsterWithIdCount) {
			
		var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");
		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");	
	
		//alert(inputArraySnakeMonsterWithIdCount[MONSTER_IS_ACTIVE]);

	
//		for (iCount=0; iCount<iSnakeMonsterCountMax; iCount++) {
			//inputArraySnakeMonsterWithIdCount[MONSTER_OBJECT]= document.getElementById("snakeMonsterImageId"+iCount);

			//alert(arraySnakeMonsterCountId[iCount][MONSTER_IS_ACTIVE]);

			if (!inputArraySlimeMonsterWithIdCount[MONSTER_IS_ACTIVE]) {
				return;
			}		
			else { //if (isBatMonsterTileActive) {						

				if (bIsHeroAttacked) {
					//bIsHeroAttacked=false;
					return;
				}
			
			//bIsHeroAttacked=false;		

			//+iImageFrameWidthDefault/2; iImageFrameHeightDefault/2
				if (isPointsOfRectIntersectingPointsOfRectMonster(mainImageTilePosX,mainImageTilePosY, inputArraySlimeMonsterWithIdCount[MONSTER_POSX],inputArraySlimeMonsterWithIdCount[MONSTER_POSY], iImageFrameWidth, iImageFrameHeight, iImageFrameWidthDefault, iImageFrameHeightDefault)) {			
					//alert("HALLO"); 	
					
					//verify if hero attacked
					if (bHasFired && (isPointsOfRectIntersectingPointsOfRectMonster(mainImageTileProjectileStepDestinationX-iImageFrameWidthDefault/2,mainImageTileProjectileStepDestinationY-iImageFrameHeightDefault/2, inputArraySlimeMonsterWithIdCount[MONSTER_POSX],inputArraySlimeMonsterWithIdCount[MONSTER_POSY], iImageFrameWidth, iImageFrameHeight, iImageFrameWidthDefault, iImageFrameHeightDefault))) {
						monsterHitByHero(mainImageTilePosX,mainImageTilePosY, inputArraySlimeMonsterWithIdCount[MONSTER_POSX],inputArraySlimeMonsterWithIdCount[MONSTER_POSY]);
												
						setExplosionEffectPosition(inputArraySlimeMonsterWithIdCount[MONSTER_POSX],inputArraySlimeMonsterWithIdCount[MONSTER_POSY]);
						
						inputArraySlimeMonsterWithIdCount[MONSTER_OBJECT].style.visibility="hidden";				
						inputArraySlimeMonsterWithIdCount[MONSTER_IS_ACTIVE]=false;
						iCurrMonsterDeathCount++;						
						
						if (iSlimeCount==0) {
							//show the rest of the children slime
							arraySlimeMonsterCountId[1][MONSTER_OBJECT].style.visibility="visible";
							arraySlimeMonsterCountId[1][MONSTER_IS_ACTIVE]=true;
							arraySlimeMonsterCountId[1][MONSTER_POSX]=inputArraySlimeMonsterWithIdCount[MONSTER_POSX]+iImageFrameWidthDefault*1; //3
							arraySlimeMonsterCountId[1][MONSTER_POSY]=inputArraySlimeMonsterWithIdCount[MONSTER_POSY];
							
							arraySlimeMonsterCountId[2][MONSTER_OBJECT].style.visibility="visible";
							arraySlimeMonsterCountId[2][MONSTER_IS_ACTIVE]=true;
							arraySlimeMonsterCountId[2][MONSTER_POSX]=inputArraySlimeMonsterWithIdCount[MONSTER_POSX]-iImageFrameWidthDefault*1; //3
							arraySlimeMonsterCountId[2][MONSTER_POSY]=inputArraySlimeMonsterWithIdCount[MONSTER_POSY];
						}						
					}
					else {			
/*					
						bIsHeroAttacked=true;
						bIsExecutingShake=true;
*/
						//note: no need to destroy slime monster
						//slime attacks when attempted to be hit
						//if (inputArraySlimeMonsterWithIdCount[MONSTER_IS_ACTIVE]) {
							heroHitByMonster(mainImageTilePosX,mainImageTilePosY, inputArraySlimeMonsterWithIdCount[MONSTER_POSX],inputArraySlimeMonsterWithIdCount[MONSTER_POSY],iMonsterAttackDamageDefault);
						//}
					}
				}
			}
		//}
	}			
	
	function verifyHeroCollideWithPearl(pearlImageTileWithId) {
		var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");
		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");	

/*	
		if (!inputArrayGrassMonsterWithIdCount[MONSTER_IS_ACTIVE]) {
			return;
		}		
		else { //if (isBatMonsterTileActive) {						

			if (bIsHeroAttacked) {
				//bIsHeroAttacked=false;
				return;
			}
*/					
			if (isPointsOfRectIntersectingPointsOfRectMonster(mainImageTilePosX,mainImageTilePosY, parseInt(pearlImageTileWithId.style.left), parseInt(pearlImageTileWithId.style.top), iImageFrameWidth, iImageFrameHeight, iImageFrameWidthDefault, iImageFrameHeightDefault)) {		

				pearlImageTileWithId.style.visibility="hidden";
				//TODO: -set is_active to false

/*				
				//==========================================
				var myAudioEffectSolved = document.getElementById("myAudioEffectSolvedId");

				myAudioEffectSolved.setAttribute("src", sAudioEffectSolved);

				//fMyAudioEffectVolume=0.2;
				myAudioEffectSolvedVolume=1.0;
				myAudioEffectSolved.volume=myAudioEffectSolvedVolume;
				myAudioEffectSolved.loop=false;
				myAudioEffectSolved.play();
				//==========================================
*/
				
				iCurrPearlCount++;
				
				switch(iCurrMapLocation) {
					case 42:
						bHasObtainedPearlAtRoom42=true;
						break;
					case 41:
						bHasObtainedPearlAtRoom41=true;
						break;
					case 33:
						bHasObtainedPearlAtRoom33=true;
						break;						
					case 43:
						bHasObtainedPearlAtRoom43=true;
						break;						
					case 22:
						bHasObtainedPearlAtRoom22=true;
						break;						
					case 11: //KEY
						//bHasObtainedPearlAtRoom11=true;
						break;												
					case 12:
						bHasObtainedPearlAtRoom12=true;
						break;												
				}
			}
/*			
		}
*/		
	}		
	
	function verifyHeroCollideWithSpecialItem(specialItemImageTileWithId) {
		var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");
		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");	

		if (isPointsOfRectIntersectingPointsOfRectMonster(mainImageTilePosX,mainImageTilePosY, parseInt(specialItemImageTileWithId.style.left), parseInt(specialItemImageTileWithId.style.top), iImageFrameWidth, iImageFrameHeight, iImageFrameWidthDefault, iImageFrameHeightDefault)) {		

			specialItemImageTileWithId.style.visibility="hidden";
			//TODO: -set is_active to false

/*			
			//==========================================
			var myAudioEffectSolved = document.getElementById("myAudioEffectSolvedId");

			myAudioEffectSolved.setAttribute("src", sAudioEffectSolved);

			//fMyAudioEffectVolume=0.2;
			myAudioEffectSolvedVolume=1.0;
			myAudioEffectSolved.volume=myAudioEffectSolvedVolume;
			myAudioEffectSolved.loop=false;
			myAudioEffectSolved.play();
			//==========================================
*/
			
			//iCurrKeyCount++;
			
			switch(iCurrMapLocation) {
				case 1: //KEY
					bHasObtainedKeyAtRoom1=true;
					break;		
				case 32: //amulet
					bHasObtainedAmuletAtRoom32=true;
					break;						
			}
		}
	}			
	
	function myUpdateFunction() {
		//using square for main dungeon
		iHorizontalOffset=(640-iStageMaxHeight)/2;

		var myFavicon = document.getElementById("faviconImageId");
		var deathCountImageTile = document.getElementById("deathCountImageId");
		
		var textNewGameDiv = document.getElementById("textNewGameDivId");
		var textContinueGameDiv = document.getElementById("textContinueGameDivId");

		var mainImageTile = document.getElementById("mainImageTileImageId");

		//added by Mike, 20231124
		var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");

		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");

		//added by Mike, 20230427
		var mainImageTileProjectile = document.getElementById("mainImageTileProjectileImageId");

		var mainImageTileFireballProjectile = document.getElementById("mainImageTileFireballProjectileImageId");
		
		var mainImageTileFireballProjectileHold = document.getElementById("mainImageTileFireballProjectileHoldImageId");
		
		var bossBattleBgImage = document.getElementById("bossBattleBgImageId");
		var bossBattleBgImageBeach = document.getElementById("bossBattleBgImageBeachId");
		var bossBattleBgImageBeachPart2 = document.getElementById("bossBattleBgImageBeachPart2Id");

		var bossBattleBgImagePart2 = document.getElementById("bossBattleBgImagePart2Id");		
		var bossBattleBgImagePart3 = document.getElementById("bossBattleBgImagePart3Id");		

		//var grassBgImage = document.getElementById("grassBgImageId");	

		//added by Mike, 20231125
		var bossMonsterImageTile = document.getElementById("bossMonsterImageId");

/*
	var batMonsterImageTile = document.getElementById("batMonsterImageId");
	//var snakeMonsterImageTile = document.getElementById("snakeMonsterImageId");
	
	for (iCount=0; iCount<iSnakeMonsterCountMax; iCount++) {
		arraySnakeMonsterCountId[iCount][MONSTER_OBJECT]= document.getElementById("snakeMonsterImageId"+iCount);
	}
*/

		var textStatusDiv = document.getElementById("textStatusDivId");
		var textStatusBackgroundDiv = document.getElementById("textStatusBackgroundDivId");

		var textEnterDiv = document.getElementById("textEnterDivId");

		//added by Mike, 20231119
		var explosionEffectImage = document.getElementById("explosionEffectImageId");
		var fireballExplosionEffectImage = document.getElementById("explosionEffectImageId");
		
		var grassCutEffectImage = document.getElementById("grassCutEffectImageId");
				
		//added by Mike, 20231126
		var explosionEffectToMonsterImage = document.getElementById("explosionEffectToMonsterImageId");

		//added by Mike, 20231121
		var mouseInputImage = document.getElementById("mouseInputImageId");

		//added by Mike, 20231121
		var titleImage = document.getElementById("titleImageId");
		//titleImage.style.visibility="hidden";
		var titleImageFrame2 = document.getElementById("titleImageFrame2Id");
		//titleImage.style.visibility="hidden";

		//added by Mike, 20231122
		var howToPlayGuideImage = document.getElementById("howToPlayGuideImageId");

		//added by Mike, 20231129
		var howToPlayGuideImageFrame2 = document.getElementById("howToPlayGuideImageFrame2Id");

/*
	var textScoreDiv = document.getElementById("textScoreDivId");

	//note: correct sequence to cause correct OUTPUT
	textScoreDiv.innerHTML = iScore;

	iTextScoreDivWidth = (textScoreDiv.clientWidth)+iTextScoreDivWidthOffset;

	//added by Mike, 20231125
	var textScoreShadowDiv = document.getElementById("textScoreShadowDivId");
	textScoreShadowDiv.innerHTML = iScore;

	//textScoreShadowDiv.style.left = textScoreDiv.style.left;
	textScoreShadowDiv.style.left = parseInt(textScoreDiv.style.left)+iTextScoreShadowDivWidthOffset +"px";
*/

	var heroLifeBarStatusImageTile = document.getElementById("heroLifeBarStatusImageTileId");
	
	heroLifeBarStatusImageTile.style.left=0+iImageFrameWidthDefault*.1+"px"; 
	heroLifeBarStatusImageTile.style.top=0+iImageFrameWidthDefault*.1+"px";
	
	var textLifeBarDiv = document.getElementById("textLifeBarDivId");

	var textTimeDiv = document.getElementById("textTimeDivId");
	var textPearlStatusDiv = document.getElementById("textPearlStatusDivId");	
	var textMonsterDeathStatusDiv = document.getElementById("textMonsterDeathStatusDivId");

    //added by Mike, 20230313
    //reference: https://www.w3schools.com/tags/canvas_fillrect.asp;
    //last accessed: 2020911
    var myCanvas = document.getElementById("myCanvasId");
    var myCanvasContext = myCanvas.getContext("2d");
    //myCanvasContext.clearRect(0, 0, iStageMaxWidth, iStageMaxHeight)

    myCanvasContext.fillStyle = "#f3f3f3"; //"#f9f9f9"; //"#f3f3f3"; //"#ffffff"; //white background//stage
    myCanvasContext.fillRect(0, 0, iStageMaxWidth, iStageMaxHeight);


    //added by Mike, 20231126
    var myCanvasTwo = document.getElementById("myCanvasTwoId");
    var myCanvasTwoContext = myCanvasTwo.getContext("2d");
    //myCanvasContext.clearRect(0, 0, iStageMaxWidth, iStageMaxHeight)

    //edited by Mike, 20231126
    myCanvasTwoContext.fillStyle = "#000000"; //"#ffffff"; //white background//stage
    //myCanvasTwoContext.fillStyle = "#261912"; //brown background//stage


    //note: max is 150 for height?...
    //myCanvasTwoContext.fillRect(0, 0, iStageMaxWidth, 120);//iStageMaxHeight/2);
    myCanvasTwoContext.fillRect(0, 0, iStageMaxWidth, iStageMaxHeight);//iStageMaxHeight/2);

	//edited by Mike, 20241114	
	//iCurrSnowFlakeCountMax
	for (iCurrSnowFlakeCount=0; iCurrSnowFlakeCount<10; iCurrSnowFlakeCount++) {
		var myDivSnowEffect = document.getElementById("divSnowEffectId"+iCurrSnowFlakeCount);
		myDivSnowEffect.style.visibility="hidden";		

/*
		if (iCurrMapLocation==53) {
	////		var iCurrSnowFlakeCountPosX=0;
	////		var iCurrSnowFlakeCountPosY=0;
	
			//iCurrSnowFlakeCountPosX=window.parseInt(Math.random() * iStageMaxWidth)%iStageMaxWidth;
			iCurrSnowFlakeCountPosX=window.parseInt(Math.random() * iStageMaxHeight)%iStageMaxHeight;


			iCurrSnowFlakeCountPosY=window.parseInt(Math.random() * iStageMaxHeight)%iStageMaxHeight;

			//myDivSnowEffect.style.left=iCurrSnowFlakeCountPosX+iHorizontalOffset+"px";
			//myDivSnowEffect.style.left=iCurrSnowFlakeCountPosX+"px";
			myDivSnowEffect.style.left=iCurrSnowFlakeCountPosX+iHorizontalOffset+"px";
			
			myDivSnowEffect.style.top=iCurrSnowFlakeCountPosY+iVerticalOffsetInnerScreen+"px";	

			myDivSnowEffect.style.visibility="visible";		
		}
		else {
			myDivSnowEffect.style.visibility="hidden";		
		}
*/	
	}
	
	bossBattleBgImage.style.left=0+iHorizontalOffset+"px";
	bossBattleBgImage.style.top=0+iVerticalOffsetInnerScreen+"px";	

	bossBattleBgImageBeach.style.left=0+iHorizontalOffset+"px";
	bossBattleBgImageBeach.style.top=0+iVerticalOffsetInnerScreen+"px";	

	bossBattleBgImageBeachPart2.style.left=0+iHorizontalOffset+"px";
	bossBattleBgImageBeachPart2.style.top=0+iVerticalOffsetInnerScreen+"px";	
	

	if (bIsExecutingShake) {
		iShakeOffsetWidth=iShakeOffsetWidthMax;
		iShakeOffsetHeight=iShakeOffsetHeightMax;

		//alert("dito");

		if (iDestroyHumanShakeDelayCount==iDestroyHumanShakeDelayMax) {
			//myKeysDown[KEY_K] = FALSE;
    		bIsExecutingShake = false;
    		iDestroyHumanShakeDelayCount=0;
			
			//bIsHeroAttacked=false;
    	}
    	else {
				iDestroyHumanShakeDelayCount+=1;
    	}
	}
	else {
  			iShakeOffsetWidth=0;
			iShakeOffsetHeight=0;
	}

    myCanvas.style.top = (iVerticalOffsetInnerScreen+0)+iShakeOffsetHeight+"px";

    iHorizontalOffset=myCanvas.getBoundingClientRect().x+iShakeOffsetWidth;

    myCanvasTwo.style.top = myCanvas.style.top;
    myCanvasTwo.style.left = myCanvas.style.left;

		if (!bHasViewedTitle) {
			titleImage.style.visibility="visible";

/*			
			if (iTitleImageFrame2DelayCount<iTitleImageFrame2DelayCountMax) {
					iTitleImageFrame2DelayCount++;
			}
			else {
				iTitleImageFrame2DelayCount=0;

				if (titleImageFrame2.style.visibility == "visible") {
					titleImageFrame2.style.visibility = "hidden";
				}
				else {
					titleImageFrame2.style.visibility = "visible";
				}
			}
*/			
			//Game Off 2021; TUGON
			if (iTitleImageFrame2DelayCount<20) {//5) {
				titleImageFrame2.style.visibility = "visible";
			}
			else {
				if (iTitleImageFrame2DelayCount>40) {//10) {
					iTitleImageFrame2DelayCount=0;
				}
				titleImageFrame2.style.visibility = "hidden";
			}			
			iTitleImageFrame2DelayCount++;			


			executeEnterClickAnimation();
			////executeMouseClickAnimation();	
		}

		if (bHasPressedStart) {
			
			//add delay to solve inadvertent double tap
			iInputDelayCount++;
			
			titleImage.style.visibility="hidden";
			titleImageFrame2.style.visibility="hidden";

			bHasViewedTitle=true;

			textEnterDiv.style.visibility="hidden";
			
			if (!bHasViewedHowToPlayGuide) {
				mouseInputImage.style.visibility="hidden";
				howToPlayGuideImage.style.visibility = "visible";

				if (iHowToPlayGuideImageFrame2DelayCount<iHowToPlayGuideImageFrame2DelayCountMax) {
					iHowToPlayGuideImageFrame2DelayCount++;
				}
				else {
					iHowToPlayGuideImageFrame2DelayCount=0;

					if (howToPlayGuideImageFrame2.style.visibility == "visible") {
						howToPlayGuideImageFrame2.style.visibility = "hidden";
					}
					else {
						howToPlayGuideImageFrame2.style.visibility = "visible";
					}
				}
				
				var iHowToPlayGuideImageWidth = (howToPlayGuideImage.clientWidth);

				var iHowToPlayGuideImageHeight = (howToPlayGuideImage.clientHeight);

				howToPlayGuideImage.style.top = (iVerticalOffsetInnerScreen+0+iStageMaxHeight/2 -iHowToPlayGuideImageHeight/2)+"px";

				howToPlayGuideImage.style.left = 0+iHorizontalOffset+iStageMaxWidth/2 -iHowToPlayGuideImageWidth/2 +"px";

				//added by Mike, 20231129
				howToPlayGuideImageFrame2.style.top = howToPlayGuideImage.style.top;

				howToPlayGuideImageFrame2.style.left = howToPlayGuideImage.style.left;
				
				return;
			}
			else {
				//----------------------------------
				myCanvasTwo.style.visibility="visible";

				bossBattleBgImage.style.visibility = "visible"; //default
				bossBattleBgImageBeach.style.visibility = "hidden";
				bossBattleBgImageBeachPart2.style.visibility = "hidden";
				
				bossBattleBgImagePart2.style.visibility = "hidden";
				bossBattleBgImagePart2.style.left = 0+"px"; 			
				bossBattleBgImagePart2.style.top = 0+iStageMaxHeight-bossBattleBgImagePart2.clientHeight+"px";
				
				//cave; default
				bossBattleBgImagePart3.style.visibility = "visible";				
				bossBattleBgImagePart3.style.left = 0+"px"; 			
				bossBattleBgImagePart3.style.top = 0+iStageMaxHeight-bossBattleBgImagePart3.clientHeight+"px";

				howToPlayGuideImage.style.visibility = "hidden";
				howToPlayGuideImageFrame2.style.visibility = "hidden";
				
				if (bIsHeroInTank) {
					mainImageTileTankBody.style.visibility = "visible";			
				}
				else {
					mainImageTileHeroBody.style.visibility = "visible";
				}			
				
				//pearlStatusImageTile.style.visibility="visible";
				
				//----------------------------------
			}

		//executeTransitionEffect();

	  //debug
	  //bIsMissionDone=true;
	  bIsMissionStarted=true;

	  if (iCurrPearlCount>=iCurrPearlCountMax) {		
		if (!bIsMissionDone) {
			iCurrTextCharacterCount=0;
		}
		bIsMissionDone=true;
	  }
/*
	  //debug	  
	  bHasViewedMissionIntro=true;
	  bIsMissionDone=true;
	  iCurrMonsterDeathCount=9;//10;//999;//14;//16;					
	  iCurrHeroDeathCount=0;//1
*/					
      if (bIsMissionStarted) {
		if (!bHasViewedMissionIntro) {
		
			sText = "The river underground<br/>hides 6 precious pearls.<br/><br/>But only those who can<br/>find its amulet would be<br/>granted the river's power.";

			//var sCurrText="";
			
			iCurrTextCharacterCountMax=sText.length;
			
			//include last character
//			if (iCurrTextCharacterCount<iCurrTextCharacterCountMax) {
			if (iCurrTextCharacterCount<=iCurrTextCharacterCountMax) {
				sCurrText=sText.substring(0,iCurrTextCharacterCount);
			}
			iCurrTextCharacterCount++;

  			textStatusDiv.innerHTML = sCurrText;//sText;

  			//alert(sText.length);
  			var iTextStatusDivWidth = (textStatusDiv.clientWidth);
  			var iTextStatusDivHeight = (textStatusDiv.clientHeight);
			
			//added by Mike, 20231128
			var mainImageTileProjectile = document.getElementById("mainImageTileProjectileImageId");


  			//TODO: -update: this
  			//iOffsetWidth
  			//textStatusDiv.style.left = 0+iHorizontalOffset+iStageMaxWidth/2 -iTextStatusDivWidth/2 +"px";
			textStatusDiv.style.left=0+iStageMaxWidth/2-textStatusBackgroundDiv.clientWidth/2;

  				//textStatusDiv.style.left = 0+iHorizontalOffset+iOffsetWidth+"px";

  			//iOffsetHeight
  			//textStatusDiv.style.top = 0+iStageMaxHeight-iTextStatusDivHeight*1.5+"px";
  			//textStatusDiv.style.top = 0+"px";
			textStatusDiv.style.top = 0+(iStageMaxHeight*0.10)+"px";
  			
  			textStatusDiv.style.visibility="visible";
			mainImageTileProjectile.style.visibility="hidden";
			textStatusBackgroundDiv.style.top=textStatusDiv.style.top;
		
			textStatusBackgroundDiv.style.left=0+iStageMaxWidth/2-textStatusBackgroundDiv.clientWidth/2;//textStatusDiv.style.left;//0;

			textStatusBackgroundDiv.style.visibility="visible";

			//textStatusBackgroundDiv.style.width=iStageMaxWidth*0.65;
			textStatusBackgroundDiv.style.width=iStageMaxWidth*0.5;

			textStatusBackgroundDiv.style.height=iStageMaxHeight*0.5;	
			
			executeTimeDisplay();

			drawMiniMap(myCanvasTwoContext,iStageMaxHeight-iInnerHorizontalOffset*0.85, 0+iStageMaxHeight/10);
	
	
	
			heroLifeBarStatusImageTile.style.visibility="visible";

	
			//iCurrHeroLife=iCurrHeroLifeMax;
			drawHeroLifeBar(myCanvasTwoContext,parseInt(heroLifeBarStatusImageTile.style.left)+10, 0+iStageMaxHeight/60); 

			//iCurrHeroMana=iCurrHeroManaMax;		
			drawHeroManaBar(myCanvasTwoContext,parseInt(heroLifeBarStatusImageTile.style.left), 0+parseInt(textLifeBarDiv.style.bottom)+5); 			
	
			drawPearlStatus(myCanvasTwoContext,iInnerHorizontalOffset/6, 0+iStageMaxHeight/60); 

			if (bHasObtainedKeyAtRoom1) {
				drawKeyStatus(myCanvasTwoContext,iInnerHorizontalOffset/6, 0+iStageMaxHeight/60+iImageFrameHeightDefault); 
			}

			if (bHasObtainedAmuletAtRoom32) {
				drawAmuletStatus(myCanvasTwoContext,iInnerHorizontalOffset/6+iImageFrameWidthDefault, 0+iStageMaxHeight/60+iImageFrameHeightDefault); 
			}

			//drawMonsterDeathStatus(myCanvasTwoContext,iInnerHorizontalOffset/6, 0+iStageMaxHeight/60+iImageFrameHeightDefault*2); 
			
			//note: using "textTimeDiv.style.top", instead of "bottom"
			drawMonsterDeathStatus(myCanvasTwoContext,0+parseInt(textTimeDiv.style.left), 0+parseInt(textTimeDiv.style.top)); 					
		}
		else {
			textStatusBackgroundDiv.style.visibility="hidden";
			textStatusDiv.style.visibility="hidden";
		}
				
		if (bIsMissionDone) {
			var sTextEnd = "<br/>Congratulations!<br/><br/>But the portal opens only<br/>to those with less than<br/>15 monsters vanquished.";

			if (iCurrMonsterDeathCount<15) { //best is 9 at most
				sTextEnd = "\"Micah!\"<br/><br/>Meanwhile, written on<br/>a mysterious note:<br/> \"The best is 9 at most.\"<br/><br/>To be continued...";

				if (iCurrMonsterDeathCount<=9) {
					sTextEnd = "\"Micah, let's give this fella<br/> a life of its own too!<br/><br/>Double tap to dash!<br/>Keyboard press + attack!\"<br/><br/>To be continued...";
					
					if (iCurrHeroDeathCount==0) {
						sTextEnd = "\"Micah!<br/><br/>There's not a minute <br/>to lose! Let's finish this<br/>in under 3 mins!\"<br/><br/>To be continued...";
						
						if (isElapsedTimeUnderThreeMins()) {
							sTextEnd = "\"Micah, great work!<br/><br/>The portal's ready.<br/><br/>Time for us to be off to<br/> Space Galaxy 999!\"<br/>";
						}
					}
				}
			}

			if (iCurrMonsterDeathCount>=999) {
				sTextEnd = "<br/>Welcome Home, <br/>Commander! <br/><br/>And...<br/>Thank you for playing!";
			}
			
			iCurrTextCharacterCountMax=sTextEnd.length;
			
			//include last character
//			if (iCurrTextCharacterCount<iCurrTextCharacterCountMax) {
			if (iCurrTextCharacterCount<=iCurrTextCharacterCountMax) {
				sCurrText=sTextEnd.substring(0,iCurrTextCharacterCount);
			}
			iCurrTextCharacterCount++;

  			textStatusDiv.innerHTML = sCurrText;//sText;

  			//alert(sText.length);
  			var iTextStatusDivWidth = (textStatusDiv.clientWidth);
  			var iTextStatusDivHeight = (textStatusDiv.clientHeight);
			
			//added by Mike, 20231128
			var mainImageTileProjectile = document.getElementById("mainImageTileProjectileImageId");

			textStatusDiv.style.left=0+iStageMaxWidth/2-textStatusBackgroundDiv.clientWidth/2;
			textStatusDiv.style.top = 0+(iStageMaxHeight*0.10)+"px";
  			
  			textStatusDiv.style.visibility="visible";
			mainImageTileProjectile.style.visibility="hidden";
						
			//added by Mike, 20231128
			textStatusBackgroundDiv.style.top=textStatusDiv.style.top;
			//textStatusBackgroundDiv.style.left=0+iStageMaxWidth*0.15;//textStatusDiv.style.left;//0;
			//textStatusBackgroundDiv.style.left=0+iStageMaxWidth*0.22;//textStatusDiv.style.left;//0;
			textStatusBackgroundDiv.style.left=0+iStageMaxWidth/2-textStatusBackgroundDiv.clientWidth/2;//textStatusDiv.style.left;//0;

			textStatusBackgroundDiv.style.visibility="visible";

			//textStatusBackgroundDiv.style.width=iStageMaxWidth*0.65;
			textStatusBackgroundDiv.style.width=iStageMaxWidth*0.5;

			textStatusBackgroundDiv.style.height=iStageMaxHeight*0.6;	
			
			executeTimeDisplay();

			drawMiniMap(myCanvasTwoContext,iStageMaxHeight-iInnerHorizontalOffset*0.85, 0+iStageMaxHeight/10);
	
			heroLifeBarStatusImageTile.style.visibility="visible";
	
			//iCurrHeroLife=iCurrHeroLifeMax;
			drawHeroLifeBar(myCanvasTwoContext,parseInt(heroLifeBarStatusImageTile.style.left)+10, 0+iStageMaxHeight/60); 

			//iCurrHeroMana=iCurrHeroManaMax;		
			drawHeroManaBar(myCanvasTwoContext,parseInt(heroLifeBarStatusImageTile.style.left), 0+parseInt(textLifeBarDiv.style.bottom)+5); 			
	
			drawPearlStatus(myCanvasTwoContext,iInnerHorizontalOffset/6, 0+iStageMaxHeight/60); 

			if (bHasObtainedKeyAtRoom1) {
				drawKeyStatus(myCanvasTwoContext,iInnerHorizontalOffset/6, 0+iStageMaxHeight/60+iImageFrameHeightDefault); 
			}

			if (bHasObtainedAmuletAtRoom32) {
				drawAmuletStatus(myCanvasTwoContext,iInnerHorizontalOffset/6+iImageFrameWidthDefault, 0+iStageMaxHeight/60+iImageFrameHeightDefault); 
			}


	//drawMonsterDeathStatus(myCanvasTwoContext,iInnerHorizontalOffset/6, 0+iStageMaxHeight/60+iImageFrameHeightDefault*2); 
	
	//note: using "textTimeDiv.style.top", instead of "bottom"
	drawMonsterDeathStatus(myCanvasTwoContext,0+parseInt(textTimeDiv.style.left), 0+parseInt(textTimeDiv.style.top)); 			
			
	  }
      else {
	  
/*	  
		//INNER STAGE; MAX
		//iHorizontalOffset=(640-iStageMaxHeight)/2;
		iInnerHorizontalOffset=(640-iStageMaxHeight)/2;		
		iInnerVerticalOffset=iImageFrameHeight/4;//2;
*/	  
		if (iCurrHeroLife<=0) {
			
			bIsGameOver=true;
			
			executeTimeDisplay();
		
			myFavicon.style.left=mainImageTile.style.left;
			myFavicon.style.top=mainImageTile.style.top;
			myFavicon.style.visibility="visible";
		
			mainImageTile.style.visibility="hidden";
			mainImageTileTankBody.style.visibility="hidden";
			mainImageTileHeroBody.style.visibility="hidden";
			
			if (iInputDelayAtGameOverCount>=iInputDelayAtGameOverCountMax) {
				textNewGameDiv.style.visibility="visible";
				textContinueGameDiv.style.visibility="visible";
			}
			iInputDelayAtGameOverCount++;
			
			sText = "GAME OVER";
			//var sText = "CONTINUE?";
			
			//"The <font color='#4a50d9'>PEST</font> was destroyed.<br/>But not without heavy<br/> damage to the city...<br/>There is still a lot to learn<br/>and do. Thank you, and<br/> great work! Peace.";
 			
			bossBattleBgImage.style.opacity = "0.6";
			bossBattleBgImage.style.filter  = 'alpha(opacity=60)'; // IE fallback

			textStatusDiv.innerHTML = sText; //sCurrText

			textStatusDiv.style.left=iInnerHorizontalOffset+iStageMaxHeight/2-textStatusDiv.clientWidth/2;
			
			//textStatusDiv.style.top = 0+(iStageMaxHeight*0.30)+"px";
			textStatusDiv.style.top = 0+iInnerVerticalOffset+textStatusDiv.clientHeight+"px";
			
  			//textStatusDiv.style.visibility="visible";
  			textStatusDiv.style.visibility="hidden";

			//red tint
			myCanvasTwoContext.fillStyle = "#550000";
			myCanvasTwoContext.fillRect(0, 0, iStageMaxWidth, iStageMaxHeight);
						
			//fire; cat and hat;
			return;
		}
	  
	  	bossBattleBgImage.style.opacity = "1.0";
		bossBattleBgImage.style.filter  = 'alpha(opacity=100)'; // IE fallback
	
        bossMonsterImageTile.style.visibility = "hidden"; //"visible";

		executeExplosionEffect();
		executeFireballExplosionEffect();

		executeGrassCutEffect();

		executePearlAnimation();

		executePearlStatusAnimation();

		executeKeyAnimation();
		//executeKeyStatusAnimation();

		executeAmuletAnimation();
		
		executeHeroFireballProjectileAnimation();

		//executeHeroFireballProjectileHoldAnimation();
		updateHeroFireballProjectileHoldPositions();

	//executeExplosionEffectToMonsterBoss();

	executeDustEffect();
	executeHeroAttackEffect();
	executeInitFireballEffect();
	

	//alert("mainImageTileProjectileVelocityY: "+mainImageTileProjectileVelocityY);

/*
	if (mainImageTileProjectileStepY<mainImageTileProjectileStepYMax) {
		mainImageTileProjectileStepY+=mainImageTileProjectileVelocityY;//++;
	}

	if (mainImageTileProjectileStepX<mainImageTileProjectileStepXMax) {
		mainImageTileProjectileStepX+=mainImageTileProjectileVelocityX;//++;
	}
*/
	
	//AI; movement due to river
	if (bIsHeroInRiver) {
		//IF has reached bottom
		if (!bHasObtainedAmuletAtRoom32) {
			if (mainImageTilePosY+iImageFrameHeightDefault>iStageMaxHeight-iImageFrameHeightDefault) {
				mainImageTileProjectilePosY=mainImageTilePosY;
				//newMainImageTileProjectilePosY=mainImageTileProjectilePosY;

				//bHasHeroReachedTopOfRoomRiver=false;
				bHasHeroReachedBottomOfRoomRiver=true;
			}
			else {
/*			
				mainImageTilePosY+=mainImageTileStepY;						
				mainImageTileProjectilePosY=mainImageTilePosY;
*/
				if (mainImageTileFireballProjectile.style.visibility=="visible") {
					mainImageTileProjectilePosY=mainImageTilePosY;
					//newMainImageTileProjectilePosY=mainImageTileProjectilePosY;
				}
				else {
					mainImageTilePosY+=mainImageTileStepY;						
					mainImageTileProjectilePosY=mainImageTilePosY;
					//newMainImageTileProjectilePosY=mainImageTileProjectilePosY;
				}
			}
		}
		else {
			if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
				mainImageTileProjectilePosY=mainImageTilePosY;
				//newMainImageTileProjectilePosY=mainImageTileProjectilePosY;

				//bHasHeroReachedTopOfRoomRiver=false;
				bHasHeroReachedBottomOfRoomRiver=true;
			}
		}
/*
		if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
			mainImageTileProjectilePosY=mainImageTilePosY;

			//bHasHeroReachedTopOfRoomRiver=false;
			bHasHeroReachedBottomOfRoomRiver=true;
		}
		else {
			if (!bHasObtainedAmuletAtRoom32) {
				mainImageTilePosY+=mainImageTileStepY;						
				mainImageTileProjectilePosY=mainImageTilePosY;
			}
		}
*/		

		//IF has reached top
		if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2) {		
			mainImageTileProjectilePosY=mainImageTilePosY;
			//newMainImageTileProjectilePosY=mainImageTileProjectilePosY;
			
			bHasHeroReachedTopOfRoomRiver=true;
			//bHasHeroReachedBottomOfRoomRiver=false;
		}		
	}

	if (mainImageTileProjectileStepY<mainImageTileProjectileStepYMax) {
		mainImageTileProjectileStepY+=mainImageTileProjectileVelocityY;//++;
	}

	if (mainImageTileProjectileStepX<mainImageTileProjectileStepXMax) {
		mainImageTileProjectileStepX+=mainImageTileProjectileVelocityX;//++;
	}

/*
	if (arrayKeyPressed[iKEY_D]==true) {
		mainImageTilePosX+=mainImageTileStepX; //horizontal movement;
		arrayKeyPressed[iKEY_D]=false;
	}
	else if (arrayKeyPressed[iKEY_A]==true) {
		mainImageTilePosX-=mainImageTileStepX; //horizontal movement;
		arrayKeyPressed[iKEY_A]=false;
	}
*/


	if (iHeroInvincibileCount<iHeroInvincibileCountMax) {
		iHeroInvincibileCount++;
		bIsHeroAttacked=false;
	}
	else {
		//iHeroInvincibileCount=0;
		//bIsHeroAttacked=false;
	}

//--------------------
/*
	if (!bIsGameOver) {
		executeTimeDisplay();
	}
*/	
	executeTimeDisplay();


	drawMiniMap(myCanvasTwoContext,iStageMaxHeight-iInnerHorizontalOffset*0.85, 0+iStageMaxHeight/10);
	
	heroLifeBarStatusImageTile.style.visibility="visible";
	//heroLifeBarStatusImageTile.style.visibility="hidden";
	
	drawHeroLifeBar(myCanvasTwoContext,parseInt(heroLifeBarStatusImageTile.style.left)+10, 0+iStageMaxHeight/60); 
	
	drawPearlStatus(myCanvasTwoContext,iInnerHorizontalOffset/6, 0+iStageMaxHeight/60); 

	if (bHasObtainedKeyAtRoom1) {
		drawKeyStatus(myCanvasTwoContext,iInnerHorizontalOffset/6, 0+iStageMaxHeight/60+iImageFrameHeightDefault); 
	}

	//bHasObtainedAmuletAtRoom32=true;

	if (bHasObtainedAmuletAtRoom32) {
		drawAmuletStatus(myCanvasTwoContext,iInnerHorizontalOffset/6+iImageFrameWidthDefault, 0+iStageMaxHeight/60+iImageFrameHeightDefault); 
	}


	drawHeroManaBar(myCanvasTwoContext,parseInt(heroLifeBarStatusImageTile.style.left)+10, 0+iStageMaxHeight/60+5);

	//drawMonsterDeathStatus(myCanvasTwoContext,iInnerHorizontalOffset/6, 0+iStageMaxHeight/60+iImageFrameHeightDefault*2); 
	
	//note: using "textTimeDiv.style.top", instead of "bottom"
	drawMonsterDeathStatus(myCanvasTwoContext,0+parseInt(textTimeDiv.style.left), 0+parseInt(textTimeDiv.style.top)); //+iImageFrameHeightDefault/2 
		
	//alert(iHorizontalOffset);

	//buggy
	//drawGrid(myCanvasTwoContext,iInnerHorizontalOffset/2,0); 
		
//--------------------	
		var dustEffectImage = document.getElementById("dustEffectImageId");

		//added by Mike, 20241106
		var doorImageRight = document.getElementById("doorImageRightId");
		doorImageRight.style.top = 0+(iStageMaxHeight/2-iImageFrameHeightDefault)+"px";
		doorImageRight.style.left = 0+(iInnerHorizontalOffset+iStageMaxHeight-iImageFrameWidthDefault) +"px";
		doorImageRight.style.visibility="hidden";		
		doorImageRight.style.objectPosition = "-" + iImageFrameWidthLarge*3 + "px -" + 0 + "px";		
				
		var iDoorImageRightPosStartY=0+iStageMaxHeight/2-iImageFrameHeightDefault*1;
		var iDoorImageRightPosEndY=0+iStageMaxHeight/2+iImageFrameHeightDefault*1+iImageFrameHeightDefault/2; //+iImageFrameHeightDefault/2 is for feet
		var iDoorImageRightPosStartX=0+(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight;		

		//## --

		var doorLockedImageRight = document.getElementById("doorLockedImageRightId");
		doorLockedImageRight.style.top = 0+(iStageMaxHeight/2-iImageFrameHeightDefault)+"px";
		doorLockedImageRight.style.left = 0+(iInnerHorizontalOffset+iStageMaxHeight-iImageFrameWidthDefault) +"px";
		doorLockedImageRight.style.visibility="hidden";		
		doorLockedImageRight.style.objectPosition = "-" + iImageFrameWidthLarge*3 + "px -" + iImageFrameHeightLarge*1 + "px";						
		var iDoorLockedImageRightPosStartY=iDoorImageRightPosStartY;
		var iDoorLockdImageRightPosEndY=iDoorImageRightPosEndY;
		var iDoorLockedImageRightPosStartX=iDoorImageRightPosStartX;		

		//## --
		
		var riverImageRight = document.getElementById("riverImageRightId");
		riverImageRight.style.top = 0+iImageFrameHeightDefault+"px";
		riverImageRight.style.left = 0+(iInnerHorizontalOffset+iStageMaxHeight-riverImageRight.clientWidth/2) +"px"; //divide by 2 due to includes clipped portion
		riverImageRight.style.visibility="hidden";
		
		iRiverImagePosY=parseInt(riverImageRight.style.top);
		iRiverImagePosX=parseInt(riverImageRight.style.left);
		iRiverImageFrameWidth=riverImageRight.clientWidth/2;
		iRiverImageFrameHeight=riverImageRight.clientHeight;
	
		//## --

		var doorImageLeft = document.getElementById("doorImageLeftId");		
		doorImageLeft.style.top = 0+(iStageMaxHeight/2-iImageFrameHeightDefault)+"px";
		doorImageLeft.style.left = 0+(iInnerHorizontalOffset-iImageFrameWidthDefault) +"px";
		doorImageLeft.style.visibility="hidden";
		doorImageLeft.style.objectPosition = "-" + iImageFrameWidthLarge*2 + "px -" + 0 + "px";		

		var iDoorImageLeftPosStartY=iDoorImageRightPosStartY;
		var iDoorImageLeftPosEndY=iDoorImageRightPosEndY; 
		var iDoorImageLeftPosStartX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
																						
		//## --

		var doorImageTop = document.getElementById("doorImageTopId");
		//doorImageTop.style.top = 0+iInnerVerticalOffset-iImageFrameHeightDefault+"px";
		doorImageTop.style.top = 0+iInnerVerticalOffset+iImageFrameHeightDefault/4+"px";		
		doorImageTop.style.left = 0+(iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault) +"px";
		doorImageTop.style.visibility="hidden";				
		doorImageTop.style.objectPosition = "-" + iImageFrameWidthLarge*0 + "px -" + 0 + "px";
		
		var iDoorImageTopPosStartX=0+iStageMaxWidth/2-iImageFrameWidthDefault*1;
		var iDoorImageTopPosEndX=0+iStageMaxWidth/2+iImageFrameWidthDefault*1;
		var iDoorImageTopPosStartY=0+iInnerVerticalOffset+iImageFrameHeightDefault;//+iImageFrameHeightDefault/2;

		//## --

		var doorImageBottom = document.getElementById("doorImageBottomId");
		doorImageBottom.style.top = 0+iStageMaxHeight-iImageFrameHeightDefault+"px";
		doorImageBottom.style.left = 0+(iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault) +"px";
		doorImageBottom.style.visibility="hidden";
		doorImageBottom.style.objectPosition = "-" + iImageFrameWidthLarge*1 + "px -" + 0 + "px";
		
		var iDoorImageBottomPosStartX=iDoorImageTopPosStartX;
		var iDoorImageBottomPosEndX=iDoorImageTopPosEndX;
		var iDoorImageBottomPosStartY=0+iStageMaxHeight-iInnerVerticalOffset*2-iImageFrameHeightDefault;
		
		var batMonsterImageTile = document.getElementById("batMonsterImageId");
		batMonsterImageTile.style.visibility="hidden";

		var pearlImageTile = document.getElementById("pearlImageTileId");
		pearlImageTile.style.visibility="hidden";
/*
		var pearlStatusImageTile = document.getElementById("pearlStatusImageTileId");
		pearlStatusImageTile.style.visibility="hidden";
*/

		var keyImageTile = document.getElementById("keyImageTileId");
		keyImageTile.style.visibility="hidden";

		var amuletImageTile = document.getElementById("amuletImageTileId");
		amuletImageTile.style.visibility="hidden";


		//grassBgImage.style.visibility="hidden";
		
/*		
		snakeMonsterImageTile.style.visibility="hidden";
*/		

		for (iCount=0; iCount<iSnakeMonsterCountMax; iCount++) {
			arraySnakeMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="hidden";
		}					

		for (iCount=0; iCount<iGrassMonsterCountMax; iCount++) {
			arrayGrassMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="hidden";
		}	

		for (iCount=0; iCount<iSlimeMonsterCountMax; iCount++) {
			arraySlimeMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="hidden";
		}			
		
		for (iCount=0; iCount<iMiniBossMonsterCountMax; iCount++) {
			arrayMiniBossMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="hidden";
		}		

		//reminder: innerStageWidth uses iStageMaxHeight

		//hasInitMapLocation=false;
		//iCurrMapLocation=0;
/*
		if (bIsGameOver) {
			alert("iCurrMapLocation: "+iCurrMapLocation);
		}
*/

		//example: 53
		iRowCount=parseInt(iCurrMapLocation/10);
		iColumnCount=iCurrMapLocation-iRowCount*10;
/*		
		alert("iRowCount: "+iRowCount);
		alert("iColumnCount: "+iColumnCount);
*/
		arrayHasVisitedRoom[iColumnCount][iRowCount]=1;

		//debug
		//bHasObtainedKeyAtRoom11=true;
		//bHasObtainedAmuletAtRoom32=true;

		//iCurrMapLocation=11;
		//iCurrMapLocation=1;
		//iCurrMapLocation=32;
		//iCurrMapLocation=22;

		switch(iCurrMapLocation) {
			//OK; TOP DOOR; REST of the sides WALLS
			case 53:
			myAudio.play();
/*			
		//debug
		//------------
		//note: not played during onLoad(), unless in ITCH.IO...
		myAudio = document.getElementById("myAudioId");
		
        myAudio.setAttribute("src", sAudioBGM);

        var fMyAudioVolume=1.0;//0.4;
        myAudio.volume=fMyAudioVolume;
        myAudio.loop=true;		
        myAudio.play();
		//-----------			
*/
				//DOOR
				//top-most					
				doorImageTop.style.visibility="visible";
				
				bossBattleBgImage.style.visibility = "hidden"; //default
				bossBattleBgImageBeach.style.visibility = "visible";
				bossBattleBgImageBeachPart2.style.visibility = "visible";
				
				bossBattleBgImagePart2.style.visibility = "visible";
				bossBattleBgImagePart3.style.visibility = "hidden";		
				
				hasInitMapLocation=true;

/*
				executeRiverAnimation();
				verifyHeroCollideWithRiver();
				
				if (bHasHeroReachedTopOfRoomRiver) {
					//RIVER as DOOR
					//OK; wraps around
					mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						
					resetProjectile();		
						
					iCurrMapLocation=43;
					hasInitMapLocation=false;
					bHasHeroReachedTopOfRoomRiver=false;
					dustEffectImage.style.visibility="hidden";
					mainImageTileFireballProjectile.style.visibility="hidden";
					mainImageTileFireballProjectilePosY=0;
					mainImageTileFireballProjectilePosX=0;
				}
*/				
						
				//if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault/2) {					
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2) {					

					if (((mainImageTilePosX>=iDoorImageTopPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageTopPosEndX)) || 					
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY, iDoorImageTopPosStartX,iDoorImageTopPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault*2))) { 
												
						//OK; wraps around
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						
						mainImageTilePosX=iDoorImageTopPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=43;
						hasInitMapLocation=false;
						dustEffectImage.style.visibility="hidden";
					}			
					else {
						//OK;
						//mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault/2;
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;
											
						resetProjectile();						
					}					
				}
				//bottom wall
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
					//OK;
					mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
					
					//alert("mainImageTilePosX: "+mainImageTilePosX);				
					resetProjectile();
				}
								
				//WALL
				//right-most
				//square rooms; hence, iStageMaxHeight
				if (mainImageTilePosX+iImageFrameWidthDefault>(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight) {
					//OK;
					mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
					resetProjectile();			
				}
				//left-most
				else if (mainImageTilePosX<0+(iInnerHorizontalOffset+iImageFrameWidthDefault)) {
					//OK;
					mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
					resetProjectile();
				}					
				break;		
			//OK; TOP, LEFT, BOTTOM DOORS; REST of the sides WALLS
			case 43:			
				//arrayHasVisitedRoom[4][3]=1;

				doorImageTop.style.visibility="visible";
				doorImageBottom.style.visibility="visible";
				doorImageLeft.style.visibility="visible";
																
				if (!hasInitMapLocation) {
					iPearlInvincibileCount=0;
					bHasPlayedSolvedTune=false;
					
					pearlImageTile.style.left=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2-iImageFrameWidthDefault*4;					
					
					pearlImageTile.style.top=iImageFrameHeightDefault+iImageFrameHeightDefault/2*2;
									
									
					isBatMonsterTileActive=true;
					batMonsterImageTile.style.visibility="visible";
					
					//TilePosX; width; square based on iStageMaxHeight
					batMonsterImageTilePosX=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2;
					batMonsterImageTilePosY=iInnerVerticalOffset+iStageMaxHeight/2-iImageFrameHeightDefault/2;
					
					hasInitMapLocation=true;					
				}
								
				executeRiverAnimation();
				verifyHeroCollideWithRiver();	

				if (bHasHeroReachedBottomOfRoomRiver) {
/*				
					mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;	
					
					resetProjectile();	
*/
					
/*					
					//RIVER as DOOR
					//OK; wraps around
					mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;						
					
					//mainImageTilePosX=iDoorImageBottomPosStartX+iImageFrameWidthDefault/2;
						
					resetProjectile();		
						
					iCurrMapLocation=53;
					hasInitMapLocation=false;
					bHasHeroReachedBottomOfRoomRiver=false;
					dustEffectImage.style.visibility="hidden";
					mainImageTileFireballProjectile.style.visibility="hidden";
					mainImageTileFireballProjectilePosY=0;
					mainImageTileFireballProjectilePosX=0;					
*/					
				}
				
				if (bHasHeroReachedTopOfRoomRiver) {
					//RIVER as DOOR
					//OK; wraps around
					mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						
					resetProjectile();		
						
					iCurrMapLocation=33;
					hasInitMapLocation=false;
					bHasHeroReachedTopOfRoomRiver=false;
					dustEffectImage.style.visibility="hidden";
					mainImageTileFireballProjectile.style.visibility="hidden";
					mainImageTileFireballProjectilePosY=0;
					mainImageTileFireballProjectilePosX=0;					
				}
				
				
				if (isBatMonsterTileActive) {
					batMonsterImageTile.style.visibility="visible";

/*			
				batMonsterImageTile.style.top = 0+iInnerVerticalOffset+iStageMaxHeight/2-iImageFrameHeightDefault+"px";
				batMonsterImageTile.style.left = 0+(iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault) +"px";
*/				
					batMonsterImageTile.style.top = 0+batMonsterImageTilePosY+"px"; //iInnerVerticalOffset
					batMonsterImageTile.style.left = 0+batMonsterImageTilePosX+"px"; //iInnerHorizontalOffset
			
					executeBatMonsterWalkingAnimation();
					verifyHeroCollideWithBatMonsters();					
					verifyHeroFireballCollideWithBatMonsters();
				}
				
				//if has not yet obtained pearl item in this room
				if (!bHasObtainedPearlAtRoom43) {
					if (!isBatMonsterTileActive) {

						if (!bHasPlayedSolvedTune) {
							playSolvedTune();		
						}

						pearlImageTile.style.visibility="visible";
												
						if (iPearlInvincibileCount>=iPearlInvincibileCountMax) {
							verifyHeroCollideWithPearl(pearlImageTile);
						}
						
						iPearlInvincibileCount++;
					}
				}
				
				//top door
				//if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault/2) {					
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2) {					

					if (((mainImageTilePosX>=iDoorImageTopPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageTopPosEndX)) || 					
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageTopPosStartX,iDoorImageTopPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault))) { 
						//OK; wraps around
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
												
						mainImageTilePosX=iDoorImageTopPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();		
						
						//DOOR
						iCurrMapLocation=33;
						hasInitMapLocation=false;
						dustEffectImage.style.visibility="hidden";	
						mainImageTileFireballProjectile.style.visibility="hidden";
						mainImageTileFireballProjectilePosY=0;
						mainImageTileFireballProjectilePosX=0;					
					}			
					else {
						//OK;
						//mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault/2;
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;						
						resetProjectile();						
					}					
				}
				//bottom door
				//else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
					//alert("DITO");
						
					if ((((mainImageTilePosX>=iDoorImageBottomPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageBottomPosEndX))) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageBottomPosStartX,iDoorImageBottomPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault))) {						
						//OK; wraps around
						//mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;						
						mainImageTilePosX=iDoorImageBottomPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
												
						//DOOR
						iCurrMapLocation=53;
						hasInitMapLocation=false;
						dustEffectImage.style.visibility="hidden";	
						mainImageTileFireballProjectile.style.visibility="hidden";
						mainImageTileFireballProjectilePosY=0;
						mainImageTileFireballProjectilePosX=0;					
					}	
					//bottom wall
					else {
						//OK;
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						resetProjectile();					
					}				
				}					
				
				//left wall with door at center				
				if (mainImageTilePosX<iDoorImageLeftPosStartX) {					
					if (((mainImageTilePosY>=iDoorImageLeftPosStartY) && (mainImageTilePosY+iImageFrameWidthDefault<=iDoorImageLeftPosEndY)) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageLeftPosStartX,iDoorImageLeftPosStartY, iImageFrameWidthDefault, iImageFrameHeightDefault*2))) { 
											
						//OK; wraps around
						mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
						
						mainImageTilePosY=iDoorImageLeftPosStartY+iImageFrameHeightDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=42;
						hasInitMapLocation=false;
						dustEffectImage.style.visibility="hidden";
						mainImageTileFireballProjectile.style.visibility="hidden";
						mainImageTileFireballProjectilePosY=0;
						mainImageTileFireballProjectilePosX=0;					
					}			
					else {
						//OK;
						mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
						resetProjectile();						
					}					
				}
				//right wall only
				else if (mainImageTilePosX+iImageFrameWidthDefault>(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight) {
					//OK;
					mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
					
					//alert("mainImageTilePosX: "+mainImageTilePosX);				
					resetProjectile();			
				}		
				break;		
			//OK; TOP, BOTTOM DOORS; REST of the sides WALLS
			case 33:
				//doorImageTop.style.visibility="visible";
				doorImageBottom.style.visibility="visible";
								
				if (!hasInitMapLocation) {				
					iPearlInvincibileCount=0;
					bHasPlayedSolvedTune=false;
					
					pearlImageTile.style.left=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2-iImageFrameWidthDefault*0;			
					pearlImageTile.style.top=iInnerVerticalOffset+iStageMaxHeight/4-iImageFrameHeightDefault/2;
								
					for (iCount=0; iCount<iSnakeMonsterCountMax; iCount++) {
						arraySnakeMonsterCountId[iCount][MONSTER_IS_ACTIVE]=true;
						arraySnakeMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="visible";
						arraySnakeMonsterCountId[iCount][MONSTER_IS_IN_RIVER]=false;
					}
			
					arraySnakeMonsterCountId[0][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2-iImageFrameWidthDefault*2;
					arraySnakeMonsterCountId[0][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight/4-iImageFrameHeightDefault/2;
					
					arraySnakeMonsterCountId[1][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2+iImageFrameWidthDefault;
					arraySnakeMonsterCountId[1][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight/4-iImageFrameHeightDefault/2;
					
					arraySnakeMonsterCountId[1][MONSTER_STEPX]=1;
					arraySnakeMonsterCountId[1][MONSTER_STEPY]=1;					
					
					//alert("DITO");

					hasInitMapLocation=true;
				}

				executeRiverAnimation();
				verifyHeroCollideWithRiver();
				
				if (bHasHeroReachedBottomOfRoomRiver) {
					//RIVER as DOOR
					//OK; wraps around
					mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;						
					
					//mainImageTilePosX=iDoorImageBottomPosStartX+iImageFrameWidthDefault/2;
						
					resetProjectile();		
						
					iCurrMapLocation=43;
					hasInitMapLocation=false;
					bHasHeroReachedBottomOfRoomRiver=false;
					dustEffectImage.style.visibility="hidden";
					mainImageTileFireballProjectile.style.visibility="hidden";
					mainImageTileFireballProjectilePosY=0;
					mainImageTileFireballProjectilePosX=0;					
				}
				
				if (bHasHeroReachedTopOfRoomRiver) {
					//RIVER as DOOR
					//OK; wraps around
					mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						
					resetProjectile();		
						
					iCurrMapLocation=23;
					hasInitMapLocation=false;
					bHasHeroReachedTopOfRoomRiver=false;
					dustEffectImage.style.visibility="hidden";
					mainImageTileFireballProjectile.style.visibility="hidden";
					mainImageTileFireballProjectilePosY=0;
					mainImageTileFireballProjectilePosX=0;					
				}

				//if has not yet obtained pearl item in this room
				if (!bHasObtainedPearlAtRoom33) {
					//if both snakes are now inactive
					if ((!arraySnakeMonsterCountId[0][MONSTER_IS_ACTIVE]) && (!arraySnakeMonsterCountId[1][MONSTER_IS_ACTIVE])) {

						if (!bHasPlayedSolvedTune) {
							playSolvedTune();		
						}
						
						pearlImageTile.style.visibility="visible";
						
						if (iPearlInvincibileCount>=iPearlInvincibileCountMax) {
							verifyHeroCollideWithPearl(pearlImageTile);
						}
						
						iPearlInvincibileCount++;
					}
				}

				for (iCount=0; iCount<iSnakeMonsterCountMax; iCount++) {
					if (arraySnakeMonsterCountId[iCount][MONSTER_IS_ACTIVE]) {
						arraySnakeMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="visible";
						
						//alert(iCount);

						arraySnakeMonsterCountId[iCount][MONSTER_OBJECT].style.top = 0+arraySnakeMonsterCountId[iCount][MONSTER_POSY]+"px"; //iInnerVerticalOffset
						arraySnakeMonsterCountId[iCount][MONSTER_OBJECT].style.left = 0+arraySnakeMonsterCountId[iCount][MONSTER_POSX]+"px"; //iInnerHorizontalOffset
				
						executeSnakeMonsterWalkingAnimation(arraySnakeMonsterCountId[iCount]);					
						verifyHeroCollideWithSnakeMonsters(arraySnakeMonsterCountId[iCount]);
						verifyHeroFireballCollideWithSnakeMonsters(arraySnakeMonsterCountId[iCount]);
						
						verifySnakeCollideWithRiver(arraySnakeMonsterCountId[iCount]);
					}
				}
/*				
				//DEBUG; loads bat monster
				if (!hasInitMapLocation) {
					//alert("iCurrMapLocation: "+iCurrMapLocation);
				
					isBatMonsterTileActive=true;
					batMonsterImageTile.style.visibility="visible";
					
					//TilePosX; width; square based on iStageMaxHeight
					batMonsterImageTilePosX=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2;
					batMonsterImageTilePosY=iInnerVerticalOffset+iStageMaxHeight/2-iImageFrameHeightDefault/2;
				}
				
				hasInitMapLocation=true;

				if (isBatMonsterTileActive) {
					batMonsterImageTile.style.visibility="visible";

					batMonsterImageTile.style.top = 0+batMonsterImageTilePosY+"px"; //iInnerVerticalOffset
					batMonsterImageTile.style.left = 0+batMonsterImageTilePosX+"px"; //iInnerHorizontalOffset
			
					executeBatMonsterWalkingAnimation();
					verifyHeroCollideWithBatMonsters();
				}		
*/				
				
/*				//previously, DOOR TOP
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2) {					

					if (((mainImageTilePosX>=iDoorImageTopPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageTopPosEndX)) || 					
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageTopPosStartX,iDoorImageTopPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault))) { 
						//OK; wraps around
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						
						mainImageTilePosX=iDoorImageTopPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=23;
						hasInitMapLocation=false;
					}			
					else {
						//OK;
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;
						resetProjectile();						
					}					
				}
*/				
				//WALL
				//square rooms; hence, iStageMaxHeight				
				//top wall
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2) {		
					//OK
					mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;
					resetProjectile();
				}					
				//bottom door
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
						
					if ((((mainImageTilePosX>=iDoorImageBottomPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageBottomPosEndX))) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageBottomPosStartX,iDoorImageBottomPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault))) { 
						//OK; wraps around
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;
						
						mainImageTilePosX=iDoorImageBottomPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
												
						//DOOR
						iCurrMapLocation=43;
						hasInitMapLocation=false;
						dustEffectImage.style.visibility="hidden";
						mainImageTileFireballProjectile.style.visibility="hidden";
						mainImageTileFireballProjectilePosY=0;
						mainImageTileFireballProjectilePosX=0;					
					}			
					else {
						//OK;
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						resetProjectile();						
					}						
				}	

				//left wall with door at center
				if (mainImageTilePosX<0+(iInnerHorizontalOffset+iImageFrameWidthDefault)) {
					//OK;
					mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
					resetProjectile();
				}
				//WALL
				//right wall only
				//square rooms; hence, iStageMaxHeight
				else if (mainImageTilePosX+iImageFrameWidthDefault>(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight) {
					//OK;
					mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
					resetProjectile();			
				}
				break;
			//OK; TOP, BOTTOM DOORS; REST of the sides WALLS
			case 23: //SECRET PASSAGE
				doorImageTop.style.visibility="visible";
				//doorImageBottom.style.visibility="visible";
			
				executeRiverAnimation();
				verifyHeroCollideWithRiver();
				
				if (bHasHeroReachedBottomOfRoomRiver) {
					//RIVER as DOOR
					//OK; wraps around
					mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;						
					
					//mainImageTilePosX=iDoorImageBottomPosStartX+iImageFrameWidthDefault/2;
						
					resetProjectile();		
						
					iCurrMapLocation=33;
					hasInitMapLocation=false;
					bHasHeroReachedBottomOfRoomRiver=false;
					dustEffectImage.style.visibility="hidden";
					mainImageTileFireballProjectile.style.visibility="hidden";
					mainImageTileFireballProjectilePosY=0;
					mainImageTileFireballProjectilePosX=0;					
				}
				
				if (bHasHeroReachedTopOfRoomRiver) {
					//RIVER as DOOR
					//OK; wraps around
					mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						
					resetProjectile();		
						
					iCurrMapLocation=13;
					hasInitMapLocation=false;
					bHasHeroReachedTopOfRoomRiver=false;
					dustEffectImage.style.visibility="hidden";
					mainImageTileFireballProjectile.style.visibility="hidden";
					mainImageTileFireballProjectilePosY=0;
					mainImageTileFireballProjectilePosX=0;					
				}
				
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2) {					

					if (((mainImageTilePosX>=iDoorImageTopPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageTopPosEndX)) || 					
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageTopPosStartX,iDoorImageTopPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault))) { 
						//OK; wraps around
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						
						mainImageTilePosX=iDoorImageTopPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=13;
						hasInitMapLocation=false;
						dustEffectImage.style.visibility="hidden";
						mainImageTileFireballProjectile.style.visibility="hidden";
						mainImageTileFireballProjectilePosY=0;
						mainImageTileFireballProjectilePosX=0;					
					}			
					else {
						//OK;
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;
						resetProjectile();						
					}					
				}
				//bottom wall
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
					//OK;
					mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
					
					//alert("mainImageTilePosX: "+mainImageTilePosX);				
					resetProjectile();
				}
/*				
				//bottom door
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
						
					if ((((mainImageTilePosX>=iDoorImageBottomPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageBottomPosEndX))) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageBottomPosStartX,iDoorImageBottomPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault))) { 
						//OK; wraps around
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;
						
						mainImageTilePosX=iDoorImageBottomPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
												
						//DOOR
						iCurrMapLocation=33;
						hasInitMapLocation=false;
						dustEffectImage.style.visibility="hidden";
					}			
					else {
						//OK;
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						resetProjectile();						
					}						
				}					
*/
				
				//left wall
				if (mainImageTilePosX<0+(iInnerHorizontalOffset+iImageFrameWidthDefault)) {
					//OK;
					mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
					resetProjectile();
				}
				//WALL
				//right wall only
				//square rooms; hence, iStageMaxHeight
				else if (mainImageTilePosX+iImageFrameWidthDefault>(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight) {
					//OK;
					mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
					resetProjectile();			
				}
				break;		
			//OK; LEFT, BOTTOM DOORS; REST of the sides WALLS
			case 13: //SECRET PASSAGE			
				doorImageLeft.style.visibility="visible";
				doorImageBottom.style.visibility="visible";

				executeRiverAnimation();
				verifyHeroCollideWithRiver();
				
				if (bHasHeroReachedBottomOfRoomRiver) {
					//RIVER as DOOR
					//OK; wraps around
					mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;						
					
					//mainImageTilePosX=iDoorImageBottomPosStartX+iImageFrameWidthDefault/2;
						
					resetProjectile();		
						
					iCurrMapLocation=23;
					hasInitMapLocation=false;
					bHasHeroReachedBottomOfRoomRiver=false;
					dustEffectImage.style.visibility="hidden";
					mainImageTileFireballProjectile.style.visibility="hidden";
					mainImageTileFireballProjectilePosY=0;
					mainImageTileFireballProjectilePosX=0;					
				}
				
				//WALL
				//square rooms; hence, iStageMaxHeight				
				//top wall
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2) {		
					//OK
					mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;
					resetProjectile();
				}							
				//bottom wall
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
						
					if ((((mainImageTilePosX>=iDoorImageBottomPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageBottomPosEndX))) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageBottomPosStartX,iDoorImageBottomPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault))) { 
						//OK; wraps around
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;
						
						mainImageTilePosX=iDoorImageBottomPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
												
						//DOOR
						iCurrMapLocation=23;
						hasInitMapLocation=false;
						dustEffectImage.style.visibility="hidden";
						mainImageTileFireballProjectile.style.visibility="hidden";
						mainImageTileFireballProjectilePosY=0;
						mainImageTileFireballProjectilePosX=0;					
					}			
					else {
						//OK;
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						resetProjectile();						
					}						
				}							
				
				//left wall with door at center				
				if (mainImageTilePosX<iDoorImageLeftPosStartX) {					

					if (((mainImageTilePosY>=iDoorImageLeftPosStartY) && (mainImageTilePosY+iImageFrameWidthDefault<=iDoorImageLeftPosEndY)) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageLeftPosStartX,iDoorImageLeftPosStartY, iImageFrameWidthDefault, iImageFrameHeightDefault*2))) { 
											
						//OK; wraps around
						mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
						
						mainImageTilePosY=iDoorImageLeftPosStartY+iImageFrameHeightDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=12;
						hasInitMapLocation=false;
						dustEffectImage.style.visibility="hidden";
						mainImageTileFireballProjectile.style.visibility="hidden";
						mainImageTileFireballProjectilePosY=0;
						mainImageTileFireballProjectilePosX=0;					
					}			
					else {
						//OK;
						mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
						resetProjectile();						
					}					
				}				
				//right wall only
				else if (mainImageTilePosX+iImageFrameWidthDefault>(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight) {
					//OK;
					mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
					
					//alert("mainImageTilePosX: "+mainImageTilePosX);				
					resetProjectile();			
				}		
				break;				
			//OK; ALL of the sides WALLS
			case 12: //SECRET ROOM; BEST ENDING??
				doorImageRight.style.visibility="visible";
				
				if (!hasInitMapLocation) {
					iPearlInvincibileCount=0;
					bHasPlayedSolvedTune=false;
					
					pearlImageTile.style.left=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidth/2+"px";
					pearlImageTile.style.top=iInnerVerticalOffset+iStageMaxHeight/2-iImageFrameHeight/2+"px";
								
					hasInitMapLocation=true;
				}
				
				//if has not yet obtained pearl item in this room
				if (!bHasObtainedPearlAtRoom12) {
//					if ((!arraySnakeMonsterCountId[0][MONSTER_IS_ACTIVE]) && (!arraySnakeMonsterCountId[1][MONSTER_IS_ACTIVE])) {

						if (!bHasPlayedSolvedTune) {
							playSolvedTune();		
						}

						pearlImageTile.style.visibility="visible";
						
						if (iPearlInvincibileCount>=iPearlInvincibileCountMax) {
							verifyHeroCollideWithPearl(pearlImageTile);
						}
						
						iPearlInvincibileCount++;
//					}
				}
			
				//WALL
				//square rooms; hence, iStageMaxHeight				
				//top wall
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2) {		
					//OK
					mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;
					resetProjectile();
				}			
				//bottom wall
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
					//OK;
					mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
					resetProjectile();
				}
										
				//WALL
				//right-most
				//square rooms; hence, iStageMaxHeight
/*				
				if (mainImageTilePosX+iImageFrameWidthDefault>(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight) {
					//OK;
					mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
					resetProjectile();			
				}
*/
				if (mainImageTilePosX+iImageFrameWidthDefault>iDoorImageRightPosStartX) {		
					if (((mainImageTilePosY>=iDoorImageRightPosStartY) && (mainImageTilePosY+iImageFrameWidthDefault<=iDoorImageRightPosEndY)) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageRightPosStartX,iDoorImageRightPosStartY, iImageFrameWidthDefault, iImageFrameHeightDefault*2))) { 
						
						//OK; wraps around
						mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
						
						mainImageTilePosY=iDoorImageLeftPosStartY+iImageFrameHeightDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=13;
						hasInitMapLocation=false;
						dustEffectImage.style.visibility="hidden";
						mainImageTileFireballProjectile.style.visibility="hidden";
						mainImageTileFireballProjectilePosY=0;
						mainImageTileFireballProjectilePosX=0;					
					}			
					else {
						//OK;
						mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
						resetProjectile();						
					}					
				}					
				//left-most
				else if (mainImageTilePosX<0+(iInnerHorizontalOffset+iImageFrameWidthDefault)) {
					//OK;
					mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
					resetProjectile();
				}
				break;			
			//OK; LEFT, RIGHT DOORS; REST of the sides WALLS
			case 42:			
				doorImageRight.style.visibility="visible";
				doorImageLeft.style.visibility="visible";
				
				//alert("DITO");
				
				//pearlImageTile.style.visibility="visible";

				if (!hasInitMapLocation) {
					iPearlInvincibileCount=0;
					bHasPlayedSolvedTune=false;
					
					//at BOTTOM-RIGHT
					pearlImageTile.style.left=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2+iImageFrameWidthDefault*3;					
					
					pearlImageTile.style.top=iInnerVerticalOffset+iStageMaxHeight-iImageFrameHeightDefault*3-iImageFrameHeightDefault/2;
				
					for (iCount=0; iCount<iGrassMonsterCountMax; iCount++) {
						arrayGrassMonsterCountId[iCount][MONSTER_IS_ACTIVE]=true;
						arrayGrassMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="visible";
						
						arrayGrassMonsterCountId[iCount][MONSTER_STEPX]=0;
						arrayGrassMonsterCountId[iCount][MONSTER_STEPY]=0;
					}
					
					for (iCount=0; iCount<iSlimeMonsterCountMax; iCount++) {
						//arraySlimeMonsterCountId[iCount][MONSTER_IS_ACTIVE]=true;
						arraySlimeMonsterCountId[iCount][MONSTER_IS_ACTIVE]=false;
						arraySlimeMonsterCountId[0][MONSTER_OBJECT].style.visibility="hidden";
						
						arraySlimeMonsterCountId[iCount][MONSTER_STEPX]=1;
						arraySlimeMonsterCountId[iCount][MONSTER_STEPY]=1;
						
						arraySlimeMonsterCountId[iCount][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2+iImageFrameWidthDefault*1; //3
					
						arraySlimeMonsterCountId[iCount][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight-iImageFrameHeightDefault*3-iImageFrameHeightDefault/2;																			
					}	
					//the rest of the children slimes appear after slashing the head slime
					arraySlimeMonsterCountId[0][MONSTER_IS_ACTIVE]=true;
					arraySlimeMonsterCountId[0][MONSTER_OBJECT].style.visibility="visible";

			
					//TOP-LEFT
					arrayGrassMonsterCountId[0][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2-iImageFrameWidthDefault*3;
					arrayGrassMonsterCountId[0][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight/4-iImageFrameHeightDefault/2;

					//TOP-RIGHT					
					arrayGrassMonsterCountId[1][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2+iImageFrameWidthDefault*3;
					arrayGrassMonsterCountId[1][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight/4-iImageFrameHeightDefault/2;
					
					//BOTTOM-LEFT
					arrayGrassMonsterCountId[2][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2-iImageFrameWidthDefault*3;
					arrayGrassMonsterCountId[2][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight-iImageFrameHeightDefault*3-iImageFrameHeightDefault/2;

					//BOTTOM-RIGHT						
					arrayGrassMonsterCountId[3][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2+iImageFrameWidthDefault*3;
					arrayGrassMonsterCountId[3][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight-iImageFrameHeightDefault*3-iImageFrameHeightDefault/2;					
					
					//## --
/*
					//BOTTOM-RIGHT
					arraySlimeMonsterCountId[0][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2+iImageFrameWidthDefault*1; //3
					
					arraySlimeMonsterCountId[0][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight-iImageFrameHeightDefault*3-iImageFrameHeightDefault/2;							
*/					
					//alert("DITO");

					hasInitMapLocation=true;
				}
				
				//grass at BOTTOM-RIGHT
				//if has not yet obtained pearl item in this room
				if (!bHasObtainedPearlAtRoom42) {
					if (!arrayGrassMonsterCountId[3][MONSTER_IS_ACTIVE]) {
						
						if (!bHasPlayedSolvedTune) {
							playSolvedTune();		
						}
						
						pearlImageTile.style.visibility="visible";
						
						if (iPearlInvincibileCount>=iPearlInvincibileCountMax) {
							verifyHeroCollideWithPearl(pearlImageTile);
						}
						
						iPearlInvincibileCount++;
					}
				}

				for (iCount=0; iCount<iGrassMonsterCountMax; iCount++) {
					if (arrayGrassMonsterCountId[iCount][MONSTER_IS_ACTIVE]) {
						arrayGrassMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="visible";
						
						//alert(iCount);

						arrayGrassMonsterCountId[iCount][MONSTER_OBJECT].style.top = 0+arrayGrassMonsterCountId[iCount][MONSTER_POSY]+"px"; //iInnerVerticalOffset
						arrayGrassMonsterCountId[iCount][MONSTER_OBJECT].style.left = 0+arrayGrassMonsterCountId[iCount][MONSTER_POSX]+"px"; //iInnerHorizontalOffset
				
						executeGrassMonsterAnimation(arrayGrassMonsterCountId[iCount]);					
						verifyHeroCollideWithGrassMonsters(arrayGrassMonsterCountId[iCount]);
					}
				}
								
				for (iCount=0; iCount<iSlimeMonsterCountMax; iCount++) {
					if (arraySlimeMonsterCountId[iCount][MONSTER_IS_ACTIVE]) {
						arraySlimeMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="visible";
						
						//alert(iCount);

						arraySlimeMonsterCountId[iCount][MONSTER_OBJECT].style.top = 0+arraySlimeMonsterCountId[iCount][MONSTER_POSY]+"px"; //iInnerVerticalOffset
						arraySlimeMonsterCountId[iCount][MONSTER_OBJECT].style.left = 0+arraySlimeMonsterCountId[iCount][MONSTER_POSX]+"px"; //iInnerHorizontalOffset
				
						executeSlimeMonsterAnimation(arraySlimeMonsterCountId[iCount]);
						verifyHeroCollideWithSlimeMonsters(iCount, arraySlimeMonsterCountId[iCount]);
						verifyHeroFireballCollideWithSlimeMonsters(iCount, arraySlimeMonsterCountId[iCount]);
					}
				}
				
				//WALL
				//square rooms; hence, iStageMaxHeight				
				//top wall
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2) {		
					//OK
					mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;
					resetProjectile();
				}	
				//bottom wall
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
					//OK;
					mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
					resetProjectile();
				}	
										
				//left wall with door at center
				if (mainImageTilePosX<iDoorImageLeftPosStartX) {					

					if (((mainImageTilePosY>=iDoorImageLeftPosStartY) && (mainImageTilePosY+iImageFrameWidthDefault<=iDoorImageLeftPosEndY)) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageLeftPosStartX,iDoorImageLeftPosStartY, iImageFrameWidthDefault, iImageFrameHeightDefault*2))) { 
											
						//OK; wraps around
						mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
						
						mainImageTilePosY=iDoorImageLeftPosStartY+iImageFrameHeightDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=41;
						hasInitMapLocation=false;
						dustEffectImage.style.visibility="hidden";
						mainImageTileFireballProjectile.style.visibility="hidden";
						mainImageTileFireballProjectilePosY=0;
						mainImageTileFireballProjectilePosX=0;					
					}			
					else {
						//OK;
						mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
						resetProjectile();						
					}					
				}
				//square rooms; hence, iStageMaxHeight
				//right wall with door at center
				else if (mainImageTilePosX+iImageFrameWidthDefault>iDoorImageRightPosStartX) {		

					if (((mainImageTilePosY>=iDoorImageRightPosStartY) && (mainImageTilePosY+iImageFrameWidthDefault<=iDoorImageRightPosEndY)) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageRightPosStartX,iDoorImageRightPosStartY, iImageFrameWidthDefault, iImageFrameHeightDefault*2))) { 
						
						//OK; wraps around
						mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
						
						mainImageTilePosY=iDoorImageLeftPosStartY+iImageFrameHeightDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=43;
						hasInitMapLocation=false;
						dustEffectImage.style.visibility="hidden";
						mainImageTileFireballProjectile.style.visibility="hidden";
						mainImageTileFireballProjectilePosY=0;
						mainImageTileFireballProjectilePosX=0;					
					}			
					else {
						//OK;
						mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
						resetProjectile();						
					}					
				}	
				break;				
			//OK; TOP, RIGHT DOORS; REST of the sides WALLS
			case 41:			
				doorImageTop.style.visibility="visible";
				doorImageRight.style.visibility="visible";
				
				if (!hasInitMapLocation) {
					iPearlInvincibileCount=0;
					bHasPlayedSolvedTune=false;					

					//at BOTTOM-RIGHT
					pearlImageTile.style.left=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2-iImageFrameWidthDefault*2;					
					
					pearlImageTile.style.top=iInnerVerticalOffset+iStageMaxHeight-iImageFrameHeightDefault*4-iImageFrameHeightDefault/2;
									
					for (iCount=0; iCount<iGrassMonsterCountMax; iCount++) {
						arrayGrassMonsterCountId[iCount][MONSTER_IS_ACTIVE]=true;
						arrayGrassMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="visible";
						
						arrayGrassMonsterCountId[iCount][MONSTER_STEPX]=0;
						arrayGrassMonsterCountId[iCount][MONSTER_STEPY]=0;
					}
			
					for (iCount=0; iCount<iSnakeMonsterCountMax; iCount++) {
						arraySnakeMonsterCountId[iCount][MONSTER_IS_ACTIVE]=true;
						arraySnakeMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="visible";
						arraySnakeMonsterCountId[iCount][MONSTER_IS_IN_RIVER]=false;
					}
			
					//BOTTOM					
					arrayGrassMonsterCountId[0][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2-iImageFrameWidthDefault*2;
					arrayGrassMonsterCountId[0][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight-iImageFrameHeightDefault*3-iImageFrameHeightDefault/2;

					//RIGHT
					arrayGrassMonsterCountId[1][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2-iImageFrameWidthDefault*1;
					arrayGrassMonsterCountId[1][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight-iImageFrameHeightDefault*4-iImageFrameHeightDefault/2;
					
					//LEFT
					arrayGrassMonsterCountId[2][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2-iImageFrameWidthDefault*3;
					arrayGrassMonsterCountId[2][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight-iImageFrameHeightDefault*4-iImageFrameHeightDefault/2;

					//TOP					
					arrayGrassMonsterCountId[3][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2-iImageFrameWidthDefault*2;
					arrayGrassMonsterCountId[3][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight-iImageFrameHeightDefault*5-iImageFrameHeightDefault/2;				
					
					//SNAKE
					arraySnakeMonsterCountId[0][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2-iImageFrameWidthDefault*2-iImageFrameWidthDefault;
					arraySnakeMonsterCountId[0][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight-iImageFrameHeightDefault*3-iImageFrameHeightDefault/2;
					
					arraySnakeMonsterCountId[1][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2-iImageFrameWidthDefault*2+iImageFrameWidthDefault;
					arraySnakeMonsterCountId[1][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight-iImageFrameHeightDefault*3-iImageFrameHeightDefault/2;
					
					arraySnakeMonsterCountId[1][MONSTER_STEPX]=1;
					arraySnakeMonsterCountId[1][MONSTER_STEPY]=1;					
										
					//alert("DITO");
					
					isBatMonsterTileActive=true;
					batMonsterImageTile.style.visibility="visible";
					
					//TilePosX; width; square based on iStageMaxHeight
					batMonsterImageTilePosX=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2-iImageFrameWidthDefault*2;
					batMonsterImageTilePosY=iInnerVerticalOffset+iStageMaxHeight/2-iImageFrameHeightDefault/2-iImageFrameHeightDefault*2;					

					hasInitMapLocation=true;
				}
				
				//at center of field of grass
				//if has not yet obtained pearl item in this room
				if (!bHasObtainedPearlAtRoom41) {
					//if (!arrayGrassMonsterCountId[3][MONSTER_IS_ACTIVE]) {
					//if both snakes are now inactive
					if ((!arraySnakeMonsterCountId[0][MONSTER_IS_ACTIVE]) && (!arraySnakeMonsterCountId[1][MONSTER_IS_ACTIVE])) {
						
						if (!bHasPlayedSolvedTune) {
							playSolvedTune();		
						}
						
						pearlImageTile.style.visibility="visible";
						
						if (iPearlInvincibileCount>=iPearlInvincibileCountMax) {
							verifyHeroCollideWithPearl(pearlImageTile);
						}
						
						iPearlInvincibileCount++;
					}
				}

				for (iCount=0; iCount<iGrassMonsterCountMax; iCount++) {
					if (arrayGrassMonsterCountId[iCount][MONSTER_IS_ACTIVE]) {
						arrayGrassMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="visible";
						
						//alert(iCount);

						arrayGrassMonsterCountId[iCount][MONSTER_OBJECT].style.top = 0+arrayGrassMonsterCountId[iCount][MONSTER_POSY]+"px"; //iInnerVerticalOffset
						arrayGrassMonsterCountId[iCount][MONSTER_OBJECT].style.left = 0+arrayGrassMonsterCountId[iCount][MONSTER_POSX]+"px"; //iInnerHorizontalOffset
				
						executeGrassMonsterAnimation(arrayGrassMonsterCountId[iCount]);					
						verifyHeroCollideWithGrassMonsters(arrayGrassMonsterCountId[iCount]);
					}
				}
				
				for (iCount=0; iCount<iSnakeMonsterCountMax; iCount++) {
					if (arraySnakeMonsterCountId[iCount][MONSTER_IS_ACTIVE]) {
						arraySnakeMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="visible";
						
						//alert(iCount);

						arraySnakeMonsterCountId[iCount][MONSTER_OBJECT].style.top = 0+arraySnakeMonsterCountId[iCount][MONSTER_POSY]+"px"; //iInnerVerticalOffset
						arraySnakeMonsterCountId[iCount][MONSTER_OBJECT].style.left = 0+arraySnakeMonsterCountId[iCount][MONSTER_POSX]+"px"; //iInnerHorizontalOffset
				
						executeSnakeMonsterWalkingAnimation(arraySnakeMonsterCountId[iCount]);					
						verifyHeroCollideWithSnakeMonsters(arraySnakeMonsterCountId[iCount]);
						verifyHeroFireballCollideWithSnakeMonsters(arraySnakeMonsterCountId[iCount]);
					}
				}				
				
				if (isBatMonsterTileActive) {
					batMonsterImageTile.style.visibility="visible";
					batMonsterImageTile.style.top = 0+batMonsterImageTilePosY+"px"; //iInnerVerticalOffset
					batMonsterImageTile.style.left = 0+batMonsterImageTilePosX+"px"; //iInnerHorizontalOffset
			
					executeBatMonsterWalkingAnimation();
					verifyHeroCollideWithBatMonsters();					
					verifyHeroFireballCollideWithBatMonsters();
				}				

				//square rooms; hence, iStageMaxHeight				
				//top wall with door at center
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2) {					

					if (((mainImageTilePosX>=iDoorImageTopPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageTopPosEndX)) || 					
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageTopPosStartX,iDoorImageTopPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault))) { 
						//OK; wraps around
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						
						mainImageTilePosX=iDoorImageTopPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=31;
						hasInitMapLocation=false;
						dustEffectImage.style.visibility="hidden";
						mainImageTileFireballProjectile.style.visibility="hidden";
						mainImageTileFireballProjectilePosY=0;
						mainImageTileFireballProjectilePosX=0;					
					}			
					else {
						//OK;
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;
						resetProjectile();						
					}					
				}				
				//bottom wall
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
					//OK;
					mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
					
					//alert("mainImageTilePosX: "+mainImageTilePosX);				
					resetProjectile();
				}
										
				//left-most wall				
				if (mainImageTilePosX<0+(iInnerHorizontalOffset+iImageFrameWidthDefault)) {
					//OK;
					mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
					resetProjectile();
				}			
				//square rooms; hence, iStageMaxHeight
				//right wall with door at center
				else if (mainImageTilePosX+iImageFrameWidthDefault>iDoorImageRightPosStartX) {					
					
					if (((mainImageTilePosY>=iDoorImageRightPosStartY) && (mainImageTilePosY+iImageFrameWidthDefault<=iDoorImageRightPosEndY)) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageRightPosStartX,iDoorImageRightPosStartY, iImageFrameWidthDefault, iImageFrameHeightDefault*2))) { 
						
						//OK; wraps around
						mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
						
						mainImageTilePosY=iDoorImageLeftPosStartY+iImageFrameHeightDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=42;
						hasInitMapLocation=false;
						dustEffectImage.style.visibility="hidden";
						mainImageTileFireballProjectile.style.visibility="hidden";
						mainImageTileFireballProjectilePosY=0;
						mainImageTileFireballProjectilePosX=0;					
					}			
					else {
						//OK;
						mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
						resetProjectile();						
					}					
				}				
				break;
			//OK; TOP, BOTTOM, RIGHT DOORS; REST of the sides WALLS
			case 31:
				doorImageTop.style.visibility="visible";
				doorImageBottom.style.visibility="visible";
				
/*				//keep the key
				if (bHasUsedKeyAtRoom11) {
					doorImageRight.style.visibility="visible";
				}
				else {
					doorLockedImageRight.style.visibility="visible";
				}
*/				
				//------------
				if (!bHasObtainedAmuletAtRoom32) {
					myAudio.pause();
					myAudioPart3.pause();
									
					//alert(myAudioPart2.currentTime);
					
					//if (myAudioPart2.currentTime==0) {
						myAudioPart2.play();
					//}
				}
				else {
					myAudio.pause();
					myAudioPart2.pause();

					//if (myAudioPart3.currentTime==0) {
						myAudioPart3.play();
					//}
				}
				//-----------		

				doorLockedImageRight.style.visibility="visible";
				
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2) {					

					if (((mainImageTilePosX>=iDoorImageTopPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageTopPosEndX)) || 					
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageTopPosStartX,iDoorImageTopPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault*2))) { 
						//OK; wraps around
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						
						mainImageTilePosX=iDoorImageTopPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=21;
						hasInitMapLocation=false;
						dustEffectImage.style.visibility="hidden";
						mainImageTileFireballProjectile.style.visibility="hidden";
						mainImageTileFireballProjectilePosY=0;
						mainImageTileFireballProjectilePosX=0;					
					}			
					else {
						//OK;
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;
						resetProjectile();						
					}					
				}
				//bottom door
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
						
					if ((((mainImageTilePosX>=iDoorImageBottomPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageBottomPosEndX))) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageBottomPosStartX,iDoorImageBottomPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault))) { 
						//OK; wraps around
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;
						
						mainImageTilePosX=iDoorImageBottomPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
												
						//DOOR
						iCurrMapLocation=41;
						hasInitMapLocation=false;
						dustEffectImage.style.visibility="hidden";
						mainImageTileFireballProjectile.style.visibility="hidden";
						mainImageTileFireballProjectilePosY=0;
						mainImageTileFireballProjectilePosX=0;					
					}			
					else {
						//OK;
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						resetProjectile();						
					}						
				}	

				//left wall with door at center
				if (mainImageTilePosX<0+(iInnerHorizontalOffset+iImageFrameWidthDefault)) {
					//OK;
					mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
					resetProjectile();
				}				
				//square rooms; hence, iStageMaxHeight
				//right wall with door at center
				else if (mainImageTilePosX+iImageFrameWidthDefault>iDoorImageRightPosStartX) {										
					if (((mainImageTilePosY>=iDoorImageRightPosStartY) && (mainImageTilePosY+iImageFrameWidthDefault<=iDoorImageRightPosEndY)) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageRightPosStartX,iDoorImageRightPosStartY, iImageFrameWidthDefault, iImageFrameHeightDefault*2))) { 
						
						if (bHasObtainedKeyAtRoom1) {						
							//OK; wraps around
							mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
							
							mainImageTilePosY=iDoorImageLeftPosStartY+iImageFrameHeightDefault/2;
							
							resetProjectile();			
							
							//DOOR
							iCurrMapLocation=32;
							hasInitMapLocation=false;
							dustEffectImage.style.visibility="hidden";
							mainImageTileFireballProjectile.style.visibility="hidden";
							mainImageTileFireballProjectilePosY=0;
							mainImageTileFireballProjectilePosX=0;					
							
							bHasUsedKeyAtRoom11=true;
						}
						//locked door becomes right wall
						else {
							//OK;
							mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
							resetProjectile();		
						}
					}			
					else {
						//OK;
						mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
						resetProjectile();						
					}					
				}	
				break;
			//OK; LEFT DOOR, REST of the sides WALLS
			case 32: //BOSS ROOM; BOSS KEY NECESSARY
				doorImageLeft.style.visibility="visible";
				//bossMonsterImageTile.style.visibility = "visible";
			
				if (!hasInitMapLocation) {
					iAmuletInvincibileCount=0;
					bHasPlayedSolvedTune=false;					
					
					//amuletImageTile.style.visibility="visible";
					amuletImageTile.style.left=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidth/2+"px";
					amuletImageTile.style.top=iInnerVerticalOffset+iStageMaxHeight/2-iImageFrameHeight/2+"px";
				
					//if Boss Monster already slain
					if (iCurrBossMonsterLife<=0) {
					}
					else {					
						isBossMonsterTileActive=true;
						bossMonsterImageTile.style.visibility="visible";
						
						//TilePosX; width; square based on iStageMaxHeight
						bossMonsterImageTilePosX=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthLarge/2;
						bossMonsterImageTilePosY=iInnerVerticalOffset+iStageMaxHeight/2-iImageFrameHeightLarge/2;
					}
					
					//------------
					//myAudioBossScreechId = document.getElementById("myAudioBossScreechId");
					myAudioBossScreech.play();
					//-----------						
										
					//alert("DITO");

					hasInitMapLocation=true;
				}
				
				//if has not yet obtained KEY item in this room
				if (!bHasObtainedAmuletAtRoom32) {
				
					if (!isBossMonsterTileActive) {
					
						if (!bHasPlayedSolvedTune) {
							playSolvedTune();							
						}
/*						
						//------------
						//TODO: -verify: this
						myAudio.pause();
						myAudioPart2.pause();
										
						//alert(myAudioPart2.currentTime);
						
						if (myAudioPart3.currentTime==0) {
							myAudioPart3.play();
						}
						//-----------	
*/						
						amuletImageTile.style.visibility="visible";
						
						if (iAmuletInvincibileCount>=iAmuletInvincibileCountMax) {
							verifyHeroCollideWithSpecialItem(amuletImageTile);
						}
						
						iAmuletInvincibileCount++;
					}
				}
	
/*
				for (iCount=0; iCount<iSnakeMonsterCountMax; iCount++) {
					if (arraySnakeMonsterCountId[iCount][MONSTER_IS_ACTIVE]) {
						arraySnakeMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="visible";
						
						//alert(iCount);

						arraySnakeMonsterCountId[iCount][MONSTER_OBJECT].style.top = 0+arraySnakeMonsterCountId[iCount][MONSTER_POSY]+"px"; //iInnerVerticalOffset
						arraySnakeMonsterCountId[iCount][MONSTER_OBJECT].style.left = 0+arraySnakeMonsterCountId[iCount][MONSTER_POSX]+"px"; //iInnerHorizontalOffset
				
						executeSnakeMonsterWalkingAnimation(arraySnakeMonsterCountId[iCount]);					
						verifyHeroCollideWithSnakeMonsters(arraySnakeMonsterCountId[iCount]);
						verifyHeroFireballCollideWithSnakeMonsters(arraySnakeMonsterCountId[iCount]);
					}
				}	
*/

				if (isBossMonsterTileActive) {
					bossMonsterImageTile.style.visibility="visible";

					bossMonsterImageTile.style.top = 0+bossMonsterImageTilePosY+"px"; //iInnerVerticalOffset
					bossMonsterImageTile.style.left = 0+bossMonsterImageTilePosX+"px"; //iInnerHorizontalOffset
			
					executeBossMonsterWalkingAnimation();
					verifyHeroCollideWithBossMonster();					
					verifyHeroFireballCollideWithBossMonster();
				}
				
			
				//WALL
				//square rooms; hence, iStageMaxHeight				
				//top wall
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2) {		
					//OK
					mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;
					resetProjectile();
				}			
				//bottom wall
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
					//OK;
					mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
					resetProjectile();
				}
										
				//WALL
				//right-most
				//square rooms; hence, iStageMaxHeight
				if (mainImageTilePosX+iImageFrameWidthDefault>(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight) {
					//OK;
					mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
					resetProjectile();			
				}
				//left wall with door at center
				else if (mainImageTilePosX<iDoorImageLeftPosStartX) {					

					if (((mainImageTilePosY>=iDoorImageLeftPosStartY) && (mainImageTilePosY+iImageFrameWidthDefault<=iDoorImageLeftPosEndY)) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageLeftPosStartX,iDoorImageLeftPosStartY, iImageFrameWidthDefault, iImageFrameHeightDefault*2))) { 
											
						//OK; wraps around
						mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
						
						mainImageTilePosY=iDoorImageLeftPosStartY+iImageFrameHeightDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=31;
						hasInitMapLocation=false;
						dustEffectImage.style.visibility="hidden";
						mainImageTileFireballProjectile.style.visibility="hidden";
						mainImageTileFireballProjectilePosY=0;
						mainImageTileFireballProjectilePosX=0;					
					}			
					else {
						//OK;
						mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
						resetProjectile();						
					}					
				}				
				break;		
			//OK; TOP, BOTTOM, RIGHT DOORS; REST of the sides WALLS
			case 21:
				//secret; top door
				doorImageTop.style.visibility="hidden";//"visible";
				doorImageBottom.style.visibility="visible";
				doorImageRight.style.visibility="visible";
				
				if (!hasInitMapLocation) {
					for (iCount=0; iCount<iGrassMonsterCountMax; iCount++) {
						arrayGrassMonsterCountId[iCount][MONSTER_IS_ACTIVE]=true;
						arrayGrassMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="visible";
						
						arrayGrassMonsterCountId[iCount][MONSTER_STEPX]=0;
						arrayGrassMonsterCountId[iCount][MONSTER_STEPY]=0;
					}
			
					//BOTTOM					
					arrayGrassMonsterCountId[0][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2;
					arrayGrassMonsterCountId[0][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight-iImageFrameHeightDefault*3-iImageFrameHeightDefault/2;

					//RIGHT
					arrayGrassMonsterCountId[1][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2+iImageFrameWidthDefault*3;
					arrayGrassMonsterCountId[1][MONSTER_POSY]=iInnerVerticalOffset+iImageFrameWidthDefault*4+iImageFrameHeightDefault/2;
					
					//LEFT
					arrayGrassMonsterCountId[2][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2-iImageFrameWidthDefault*3;
					arrayGrassMonsterCountId[2][MONSTER_POSY]=iInnerVerticalOffset+iImageFrameWidthDefault*4+iImageFrameHeightDefault/2;

					//TOP					
					arrayGrassMonsterCountId[3][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2;
					arrayGrassMonsterCountId[3][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight/2-iImageFrameWidthDefault*2-iImageFrameHeightDefault*1;						

					hasInitMapLocation=true;
				}
			
				for (iCount=0; iCount<iGrassMonsterCountMax; iCount++) {
					if (arrayGrassMonsterCountId[iCount][MONSTER_IS_ACTIVE]) {
						arrayGrassMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="visible";
						
						//alert(iCount);

						arrayGrassMonsterCountId[iCount][MONSTER_OBJECT].style.top = 0+arrayGrassMonsterCountId[iCount][MONSTER_POSY]+"px"; //iInnerVerticalOffset
						arrayGrassMonsterCountId[iCount][MONSTER_OBJECT].style.left = 0+arrayGrassMonsterCountId[iCount][MONSTER_POSX]+"px"; //iInnerHorizontalOffset
				
						executeGrassMonsterAnimation(arrayGrassMonsterCountId[iCount]);					
						verifyHeroCollideWithGrassMonsters(arrayGrassMonsterCountId[iCount]);
					}
				}				
				
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2) {					
					if (((mainImageTilePosX>=iDoorImageTopPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageTopPosEndX)) || 					
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageTopPosStartX,iDoorImageTopPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault*2))) { 
						//OK; wraps around
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						
						mainImageTilePosX=iDoorImageTopPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=11;
						hasInitMapLocation=false;
						dustEffectImage.style.visibility="hidden";
						mainImageTileFireballProjectile.style.visibility="hidden";
						mainImageTileFireballProjectilePosY=0;
						mainImageTileFireballProjectilePosX=0;					
					}			
					else {
						//OK;
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;
						resetProjectile();						
					}					
				}
				//bottom door
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
						
					if ((((mainImageTilePosX>=iDoorImageBottomPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageBottomPosEndX))) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageBottomPosStartX,iDoorImageBottomPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault))) { 
						//OK; wraps around
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;
						
						mainImageTilePosX=iDoorImageBottomPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
												
						//DOOR
						iCurrMapLocation=31;
						hasInitMapLocation=false;
						dustEffectImage.style.visibility="hidden";
						mainImageTileFireballProjectile.style.visibility="hidden";
						mainImageTileFireballProjectilePosY=0;
						mainImageTileFireballProjectilePosX=0;					
					}			
					else {
						//OK;
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						resetProjectile();						
					}						
				}	

				//left wall with door at center
				if (mainImageTilePosX<0+(iInnerHorizontalOffset+iImageFrameWidthDefault)) {
					//OK;
					mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
					resetProjectile();
				}				
				//square rooms; hence, iStageMaxHeight
				//right wall with door at center
				else if (mainImageTilePosX+iImageFrameWidthDefault>iDoorImageRightPosStartX) {					
					
					if (((mainImageTilePosY>=iDoorImageRightPosStartY) && (mainImageTilePosY+iImageFrameWidthDefault<=iDoorImageRightPosEndY)) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageRightPosStartX,iDoorImageRightPosStartY, iImageFrameWidthDefault, iImageFrameHeightDefault*2))) { 
						
						//OK; wraps around
						mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
						
						mainImageTilePosY=iDoorImageLeftPosStartY+iImageFrameHeightDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=22;
						hasInitMapLocation=false;
						dustEffectImage.style.visibility="hidden";
						mainImageTileFireballProjectile.style.visibility="hidden";
						mainImageTileFireballProjectilePosY=0;
						mainImageTileFireballProjectilePosX=0;					
					}			
					else {
						//OK;
						mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
						resetProjectile();						
					}					
				}	
				break;		
			//OK; LEFT DOOR, REST of the sides WALLS
			case 22:
				doorImageLeft.style.visibility="visible";
			
				if (!hasInitMapLocation) {
					iPearlInvincibileCount=0;
					bHasPlayedSolvedTune=false;
					
					//at center of field of grass
					pearlImageTile.style.left=iInnerHorizontalOffset+iStageMaxHeight/2+iImageFrameWidthDefault*3;					
					
					pearlImageTile.style.top=iInnerVerticalOffset+iStageMaxHeight-iImageFrameHeightDefault*2-iImageFrameHeightDefault/2;
					
					for (iCount=0; iCount<iMiniBossMonsterCountMax; iCount++) {
					//for (iCount=iMiniBossMonsterCountMax-1; iCount>=0; iCount--) {

						arrayMiniBossMonsterCountId[iCount][MONSTER_IS_ACTIVE]=true;
						arrayMiniBossMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="visible";
	
						arrayMiniBossMonsterCountId[iCount][MONSTER_STEPX]=2;//1+iCount;
						arrayMiniBossMonsterCountId[iCount][MONSTER_STEPY]=2;//1+iCount;	

						arrayMiniBossMonsterCountId[iCount][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight-iImageFrameWidthDefault*2-iImageFrameWidthDefault/2*(iCount%2); //3

						arrayMiniBossMonsterCountId[iCount][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight/2+iImageFrameHeightDefault*2-iImageFrameHeightDefault/2*(iCount);

/*												
						if (iCount<iMiniBossMonsterCountMax/2) {
							arrayMiniBossMonsterCountId[iCount][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight-iImageFrameWidthDefault*2-iImageFrameWidthDefault/2*(1+1);
						}
						else {
							arrayMiniBossMonsterCountId[iCount][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight-iImageFrameWidthDefault*2-iImageFrameWidthDefault/2*(0+1);
						}
																	
						arrayMiniBossMonsterCountId[iCount][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight/2+iImageFrameHeightDefault*2-iImageFrameHeightDefault/2*(iCount%6);				
*/						
						var iMiniBossMonsterImageTileStepAngle=-90; //facing left door of MiniBoss Room
						//flip vertically;
						iMiniBossMonsterImageTileStepAngle=(iMiniBossMonsterImageTileStepAngle+180)%360;		
						arrayMiniBossMonsterCountId[iCount][MONSTER_OBJECT].style.transform = "rotate("+iMiniBossMonsterImageTileStepAngle+"deg)";	
						arrayMiniBossMonsterCountId[iCount][MONSTER_OBJECT].style.transformOrigin = "12.5% 12.5%"; 
						
					}			
/*									
					for (iCount=0; iCount<iGrassMonsterCountMax; iCount++) {
						arrayGrassMonsterCountId[iCount][MONSTER_IS_ACTIVE]=true;
						arrayGrassMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="visible";
						
						arrayGrassMonsterCountId[iCount][MONSTER_STEPX]=0;
						arrayGrassMonsterCountId[iCount][MONSTER_STEPY]=0;
					}
			
					for (iCount=0; iCount<iSnakeMonsterCountMax; iCount++) {
						arraySnakeMonsterCountId[iCount][MONSTER_IS_ACTIVE]=true;
						arraySnakeMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="visible";
					}
*/
/*			
					//BOTTOM					
					arrayGrassMonsterCountId[0][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2+iImageFrameWidthDefault*2;
					arrayGrassMonsterCountId[0][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight-iImageFrameHeightDefault*2-iImageFrameHeightDefault/2;

					//RIGHT
					arrayGrassMonsterCountId[1][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2+iImageFrameWidthDefault*1;
					arrayGrassMonsterCountId[1][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight-iImageFrameHeightDefault*3-iImageFrameHeightDefault/2;
					
					//LEFT
					arrayGrassMonsterCountId[2][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2+iImageFrameWidthDefault*3;
					arrayGrassMonsterCountId[2][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight-iImageFrameHeightDefault*3-iImageFrameHeightDefault/2;

					//TOP					
					arrayGrassMonsterCountId[3][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2+iImageFrameWidthDefault*2;
					arrayGrassMonsterCountId[3][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight-iImageFrameHeightDefault*4-iImageFrameHeightDefault/2;				
*/
/*					
					//SNAKE
					arraySnakeMonsterCountId[0][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2+iImageFrameWidthDefault*2-iImageFrameWidthDefault;
					arraySnakeMonsterCountId[0][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight-iImageFrameHeightDefault*3-iImageFrameHeightDefault/2;
					
					arraySnakeMonsterCountId[1][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2+iImageFrameWidthDefault*2+iImageFrameWidthDefault;
					arraySnakeMonsterCountId[1][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight-iImageFrameHeightDefault*3-iImageFrameHeightDefault/2;
					
					arraySnakeMonsterCountId[1][MONSTER_STEPX]=1;
					arraySnakeMonsterCountId[1][MONSTER_STEPY]=1;					
*/										
					//alert("DITO");

					hasInitMapLocation=true;
				}
			
				//at center of field of grass
				//if has not yet obtained pearl item in this room
				if (!bHasObtainedPearlAtRoom22) {
					//if (!arrayGrassMonsterCountId[3][MONSTER_IS_ACTIVE]) {
					//if both snakes are now inactive
					//if ((!arraySnakeMonsterCountId[0][MONSTER_IS_ACTIVE]) && (!arraySnakeMonsterCountId[1][MONSTER_IS_ACTIVE])) {
					//if last miniboss is inactive
					if (!(arrayMiniBossMonsterCountId[iMiniBossMonsterCountMax-1][MONSTER_IS_ACTIVE])) {

						if (!bHasPlayedSolvedTune) {
							playSolvedTune();							
						}
						
						pearlImageTile.style.visibility="visible";
						
						if (iPearlInvincibileCount>=iPearlInvincibileCountMax) {
							verifyHeroCollideWithPearl(pearlImageTile);
						}
						
						iPearlInvincibileCount++;
					}
				}

				for (iCount=0; iCount<iMiniBossMonsterCountMax; iCount++) {
					if (arrayMiniBossMonsterCountId[iCount][MONSTER_IS_ACTIVE]) {
						arrayMiniBossMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="visible";
						
						//alert(iCount);

						arrayMiniBossMonsterCountId[iCount][MONSTER_OBJECT].style.top = 0+arrayMiniBossMonsterCountId[iCount][MONSTER_POSY]+"px"; //iInnerVerticalOffset
						arrayMiniBossMonsterCountId[iCount][MONSTER_OBJECT].style.left = 0+arrayMiniBossMonsterCountId[iCount][MONSTER_POSX]+"px"; //iInnerHorizontalOffset
										
						executeMiniBossMonsterWalkingAnimation(iCount,arrayMiniBossMonsterCountId);//[iCount]);
						
						verifyHeroCollideWithMiniBossMonsters(arrayMiniBossMonsterCountId[iCount]);
						verifyHeroFireballCollideWithMiniBossMonsters(arrayMiniBossMonsterCountId[iCount]);
					}
				}
			
/*				
				for (iCount=0; iCount<iGrassMonsterCountMax; iCount++) {
					if (arrayGrassMonsterCountId[iCount][MONSTER_IS_ACTIVE]) {
						arrayGrassMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="visible";
						
						//alert(iCount);

						arrayGrassMonsterCountId[iCount][MONSTER_OBJECT].style.top = 0+arrayGrassMonsterCountId[iCount][MONSTER_POSY]+"px"; //iInnerVerticalOffset
						arrayGrassMonsterCountId[iCount][MONSTER_OBJECT].style.left = 0+arrayGrassMonsterCountId[iCount][MONSTER_POSX]+"px"; //iInnerHorizontalOffset
				
						executeGrassMonsterAnimation(arrayGrassMonsterCountId[iCount]);					
						verifyHeroCollideWithGrassMonsters(arrayGrassMonsterCountId[iCount]);
					}
				}
*/				

/*				
				for (iCount=0; iCount<iSnakeMonsterCountMax; iCount++) {
					if (arraySnakeMonsterCountId[iCount][MONSTER_IS_ACTIVE]) {
						arraySnakeMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="visible";
						
						//alert(iCount);

						arraySnakeMonsterCountId[iCount][MONSTER_OBJECT].style.top = 0+arraySnakeMonsterCountId[iCount][MONSTER_POSY]+"px"; //iInnerVerticalOffset
						arraySnakeMonsterCountId[iCount][MONSTER_OBJECT].style.left = 0+arraySnakeMonsterCountId[iCount][MONSTER_POSX]+"px"; //iInnerHorizontalOffset
				
						executeSnakeMonsterWalkingAnimation(arraySnakeMonsterCountId[iCount]);					
						verifyHeroCollideWithSnakeMonsters(arraySnakeMonsterCountId[iCount]);
						verifyHeroFireballCollideWithSnakeMonsters(arraySnakeMonsterCountId[iCount]);
					}
				}			
*/			
				//WALL
				//square rooms; hence, iStageMaxHeight				
				//top wall
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2) {		
					//OK
					mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;
					resetProjectile();
				}			
				//bottom wall
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
					//OK;
					mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
					resetProjectile();
				}
										
				//WALL
				//right-most
				//square rooms; hence, iStageMaxHeight
				if (mainImageTilePosX+iImageFrameWidthDefault>(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight) {
					//OK;
					mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
					resetProjectile();			
				}
				//left wall with door at center
				else if (mainImageTilePosX<iDoorImageLeftPosStartX) {					

					if (((mainImageTilePosY>=iDoorImageLeftPosStartY) && (mainImageTilePosY+iImageFrameWidthDefault<=iDoorImageLeftPosEndY)) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageLeftPosStartX,iDoorImageLeftPosStartY, iImageFrameWidthDefault, iImageFrameHeightDefault*2))) { 
											
						//OK; wraps around
						mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
						
						mainImageTilePosY=iDoorImageLeftPosStartY+iImageFrameHeightDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=21;
						hasInitMapLocation=false;
						dustEffectImage.style.visibility="hidden";
						mainImageTileFireballProjectile.style.visibility="hidden";
						mainImageTileFireballProjectilePosY=0;
						mainImageTileFireballProjectilePosX=0;					
					}			
					else {
						//OK;
						mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
						resetProjectile();						
					}					
				}				
				break;		
			//OK; TOP, BOTTOM DOOR; REST of the sides WALLS
			//secret passage
			case 11:				
				bossBattleBgImage.style.visibility="hidden";
				doorImageTop.style.visibility="visible";
				doorImageBottom.style.visibility="visible";
				//doorImageRight.style.visibility="visible";
				
				if (!hasInitMapLocation) {
					for (iCount=0; iCount<iGrassMonsterCountMax; iCount++) {
						arrayGrassMonsterCountId[iCount][MONSTER_IS_ACTIVE]=true;
						arrayGrassMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="visible";
						
						arrayGrassMonsterCountId[iCount][MONSTER_STEPX]=0;
						arrayGrassMonsterCountId[iCount][MONSTER_STEPY]=0;
					}
			
					//BOTTOM					
					arrayGrassMonsterCountId[0][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2;
					arrayGrassMonsterCountId[0][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight-iImageFrameHeightDefault*2-iImageFrameHeightDefault/2;

					//RIGHT
					arrayGrassMonsterCountId[1][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2;
					arrayGrassMonsterCountId[1][MONSTER_POSY]=iInnerVerticalOffset+iImageFrameWidthDefault*4+iImageFrameHeightDefault/2;
					
					//LEFT
					arrayGrassMonsterCountId[2][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2;
					arrayGrassMonsterCountId[2][MONSTER_POSY]=iInnerVerticalOffset+iImageFrameWidthDefault*6+iImageFrameHeightDefault/2;

					//TOP					
					arrayGrassMonsterCountId[3][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2;
					arrayGrassMonsterCountId[3][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight/2-iImageFrameWidthDefault*2-iImageFrameHeightDefault*1;						

					hasInitMapLocation=true;
				}
			
				for (iCount=0; iCount<iGrassMonsterCountMax; iCount++) {
					if (arrayGrassMonsterCountId[iCount][MONSTER_IS_ACTIVE]) {
						arrayGrassMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="visible";
						
						//alert(iCount);

						arrayGrassMonsterCountId[iCount][MONSTER_OBJECT].style.top = 0+arrayGrassMonsterCountId[iCount][MONSTER_POSY]+"px"; //iInnerVerticalOffset
						arrayGrassMonsterCountId[iCount][MONSTER_OBJECT].style.left = 0+arrayGrassMonsterCountId[iCount][MONSTER_POSX]+"px"; //iInnerHorizontalOffset
				
						executeGrassMonsterAnimation(arrayGrassMonsterCountId[iCount]);					
						verifyHeroCollideWithGrassMonsters(arrayGrassMonsterCountId[iCount]);
					}
				}				
				
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2) {					
					if (((mainImageTilePosX>=iDoorImageTopPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageTopPosEndX)) || 					
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageTopPosStartX,iDoorImageTopPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault*2))) { 
						//OK; wraps around
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						
						mainImageTilePosX=iDoorImageTopPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=1;
						hasInitMapLocation=false;
						dustEffectImage.style.visibility="hidden";
						mainImageTileFireballProjectile.style.visibility="hidden";
						mainImageTileFireballProjectilePosY=0;
						mainImageTileFireballProjectilePosX=0;					
					}			
					else {
						//OK;
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;
						resetProjectile();						
					}					
				}
				//bottom door
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
						
					if ((((mainImageTilePosX>=iDoorImageBottomPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageBottomPosEndX))) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageBottomPosStartX,iDoorImageBottomPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault))) { 
						//OK; wraps around
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;
						
						mainImageTilePosX=iDoorImageBottomPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
												
						//DOOR
						iCurrMapLocation=21;
						hasInitMapLocation=false;
						dustEffectImage.style.visibility="hidden";
						mainImageTileFireballProjectile.style.visibility="hidden";
						mainImageTileFireballProjectilePosY=0;
						mainImageTileFireballProjectilePosX=0;					
					}			
					else {
						//OK;
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						resetProjectile();						
					}						
				}	

				//left wall with door at center
				if (mainImageTilePosX<0+(iInnerHorizontalOffset+iImageFrameWidthDefault)) {
					//OK;
					mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
					resetProjectile();
				}	
				//WALL
				//right-most
				//square rooms; hence, iStageMaxHeight
				else if (mainImageTilePosX+iImageFrameWidthDefault>(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight) {
					//OK;
					mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
					resetProjectile();			
				}
				break;
			//OK; BOTTOM DOOR; REST of the sides WALLS
			case 1:
				doorImageBottom.style.visibility="visible";
				
				if (!hasInitMapLocation) {					
					iKeyInvincibileCount=0;
					bHasPlayedSolvedTune=false;
					
					//at center of field of grass
					keyImageTile.style.left=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2;					
					keyImageTile.style.top=iInnerVerticalOffset+iImageFrameWidthDefault*4+iImageFrameHeightDefault/2;
									
					for (iCount=0; iCount<iGrassMonsterCountMax; iCount++) {
						arrayGrassMonsterCountId[iCount][MONSTER_IS_ACTIVE]=true;
						arrayGrassMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="visible";
						
						arrayGrassMonsterCountId[iCount][MONSTER_STEPX]=0;
						arrayGrassMonsterCountId[iCount][MONSTER_STEPY]=0;
					}
			
					for (iCount=0; iCount<iSnakeMonsterCountMax; iCount++) {
						arraySnakeMonsterCountId[iCount][MONSTER_IS_ACTIVE]=true;
						arraySnakeMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="visible";
					}
			
					//BOTTOM					
					arrayGrassMonsterCountId[0][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2;
					arrayGrassMonsterCountId[0][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight-iImageFrameHeightDefault*4-iImageFrameHeightDefault/2;

					//RIGHT
					arrayGrassMonsterCountId[1][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2+iImageFrameWidthDefault*3;
					arrayGrassMonsterCountId[1][MONSTER_POSY]=iInnerVerticalOffset+iImageFrameWidthDefault*4+iImageFrameHeightDefault/2;
					
					//LEFT
					arrayGrassMonsterCountId[2][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2-iImageFrameWidthDefault*3;
					arrayGrassMonsterCountId[2][MONSTER_POSY]=iInnerVerticalOffset+iImageFrameWidthDefault*4+iImageFrameHeightDefault/2;

					//TOP					
					arrayGrassMonsterCountId[3][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2;
					arrayGrassMonsterCountId[3][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight/2-iImageFrameWidthDefault*2-iImageFrameHeightDefault*1;				
					
					//SNAKE
					arraySnakeMonsterCountId[0][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2-iImageFrameWidthDefault*2;	
					arraySnakeMonsterCountId[0][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight/2-iImageFrameWidthDefault*2-iImageFrameHeightDefault*1;
					
					arraySnakeMonsterCountId[1][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2+iImageFrameWidthDefault*2;	
					arraySnakeMonsterCountId[1][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight/2-iImageFrameWidthDefault*2-iImageFrameHeightDefault*1;			
					
					arraySnakeMonsterCountId[1][MONSTER_STEPX]=1;
					arraySnakeMonsterCountId[1][MONSTER_STEPY]=1;					
										
					isBatMonsterTileActive=true;
					batMonsterImageTile.style.visibility="visible";
					
					//TilePosX; width; square based on iStageMaxHeight
					batMonsterImageTilePosX=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2;
					batMonsterImageTilePosY=iInnerVerticalOffset+iStageMaxHeight/2-iImageFrameHeightDefault/2;
					
					for (iCount=0; iCount<iSlimeMonsterCountMax; iCount++) {
						//arraySlimeMonsterCountId[iCount][MONSTER_IS_ACTIVE]=true;
						arraySlimeMonsterCountId[iCount][MONSTER_IS_ACTIVE]=false;
						arraySlimeMonsterCountId[0][MONSTER_OBJECT].style.visibility="hidden";
						
						arraySlimeMonsterCountId[iCount][MONSTER_STEPX]=1;
						arraySlimeMonsterCountId[iCount][MONSTER_STEPY]=1;
						
						arraySlimeMonsterCountId[iCount][MONSTER_POSX]=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2+iImageFrameWidthDefault*1; //3
					
						arraySlimeMonsterCountId[iCount][MONSTER_POSY]=iInnerVerticalOffset+iStageMaxHeight-iImageFrameHeightDefault*3-iImageFrameHeightDefault/2;
					}
					
					//the rest of the children slimes appear after slashing the head slime
					arraySlimeMonsterCountId[0][MONSTER_IS_ACTIVE]=true;
					arraySlimeMonsterCountId[0][MONSTER_OBJECT].style.visibility="visible";
					
					hasInitMapLocation=true;
				}
			
				//if has not yet obtained KEY item in this room
				if (!bHasObtainedKeyAtRoom1) {
					//if (!arrayGrassMonsterCountId[3][MONSTER_IS_ACTIVE]) {
					//if both snakes are now inactive
					if ((!arraySnakeMonsterCountId[0][MONSTER_IS_ACTIVE]) && (!arraySnakeMonsterCountId[1][MONSTER_IS_ACTIVE])) {
						
						if (!bHasPlayedSolvedTune) {
							playSolvedTune();							
						}
					
						keyImageTile.style.visibility="visible";
						
						if (iKeyInvincibileCount>=iKeyInvincibileCountMax) {
							verifyHeroCollideWithSpecialItem(keyImageTile);
						}
						
						iKeyInvincibileCount++;
					}
				}

				for (iCount=0; iCount<iGrassMonsterCountMax; iCount++) {
					if (arrayGrassMonsterCountId[iCount][MONSTER_IS_ACTIVE]) {
						arrayGrassMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="visible";
						
						//alert(iCount);

						arrayGrassMonsterCountId[iCount][MONSTER_OBJECT].style.top = 0+arrayGrassMonsterCountId[iCount][MONSTER_POSY]+"px"; //iInnerVerticalOffset
						arrayGrassMonsterCountId[iCount][MONSTER_OBJECT].style.left = 0+arrayGrassMonsterCountId[iCount][MONSTER_POSX]+"px"; //iInnerHorizontalOffset
				
						executeGrassMonsterAnimation(arrayGrassMonsterCountId[iCount]);					
						verifyHeroCollideWithGrassMonsters(arrayGrassMonsterCountId[iCount]);
					}
				}
				
				for (iCount=0; iCount<iSnakeMonsterCountMax; iCount++) {
					if (arraySnakeMonsterCountId[iCount][MONSTER_IS_ACTIVE]) {
						arraySnakeMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="visible";
						
						//alert(iCount);

						arraySnakeMonsterCountId[iCount][MONSTER_OBJECT].style.top = 0+arraySnakeMonsterCountId[iCount][MONSTER_POSY]+"px"; //iInnerVerticalOffset
						arraySnakeMonsterCountId[iCount][MONSTER_OBJECT].style.left = 0+arraySnakeMonsterCountId[iCount][MONSTER_POSX]+"px"; //iInnerHorizontalOffset
				
						executeSnakeMonsterWalkingAnimation(arraySnakeMonsterCountId[iCount]);					
						verifyHeroCollideWithSnakeMonsters(arraySnakeMonsterCountId[iCount]);
						verifyHeroFireballCollideWithSnakeMonsters(arraySnakeMonsterCountId[iCount]);
					}
				}			
				
				if (isBatMonsterTileActive) {
					batMonsterImageTile.style.visibility="visible";
					batMonsterImageTile.style.top = 0+batMonsterImageTilePosY+"px"; //iInnerVerticalOffset
					batMonsterImageTile.style.left = 0+batMonsterImageTilePosX+"px"; //iInnerHorizontalOffset
			
					executeBatMonsterWalkingAnimation();
					verifyHeroCollideWithBatMonsters();					
					verifyHeroFireballCollideWithBatMonsters();
				}

				for (iCount=0; iCount<iSlimeMonsterCountMax; iCount++) {
					if (arraySlimeMonsterCountId[iCount][MONSTER_IS_ACTIVE]) {
						arraySlimeMonsterCountId[iCount][MONSTER_OBJECT].style.visibility="visible";
						
						//alert(iCount);

						arraySlimeMonsterCountId[iCount][MONSTER_OBJECT].style.top = 0+arraySlimeMonsterCountId[iCount][MONSTER_POSY]+"px"; //iInnerVerticalOffset
						arraySlimeMonsterCountId[iCount][MONSTER_OBJECT].style.left = 0+arraySlimeMonsterCountId[iCount][MONSTER_POSX]+"px"; //iInnerHorizontalOffset
				
						executeSlimeMonsterAnimation(arraySlimeMonsterCountId[iCount]);
						verifyHeroCollideWithSlimeMonsters(iCount, arraySlimeMonsterCountId[iCount]);
						verifyHeroFireballCollideWithSlimeMonsters(iCount, arraySlimeMonsterCountId[iCount]);
					}
				}				
				
				//WALL
				//square rooms; hence, iStageMaxHeight				
				//top wall
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2) {		
					//OK
					mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;
					resetProjectile();
				}		
				//bottom door
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
						
					if ((((mainImageTilePosX>=iDoorImageBottomPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageBottomPosEndX))) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageBottomPosStartX,iDoorImageBottomPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault))) { 
						//OK; wraps around
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault+iImageFrameHeightDefault/2;
						
						mainImageTilePosX=iDoorImageBottomPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
												
						//DOOR
						iCurrMapLocation=11;
						hasInitMapLocation=false;
						dustEffectImage.style.visibility="hidden";
						mainImageTileFireballProjectile.style.visibility="hidden";
						mainImageTileFireballProjectilePosY=0;
						mainImageTileFireballProjectilePosX=0;					
					}			
					else {
						//OK;
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						resetProjectile();						
					}						
				}	

				//WALL
				//right-most
				//square rooms; hence, iStageMaxHeight
				if (mainImageTilePosX+iImageFrameWidthDefault>(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight) {
					//OK;
					mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
					resetProjectile();			
				}
				//left wall with door at center
				else if (mainImageTilePosX<0+(iInnerHorizontalOffset+iImageFrameWidthDefault)) {
					//OK;
					mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
					resetProjectile();
				}
				break;				
		}

		//STAGE; MAX
		if (mainImageTilePosX+iImageFrameWidthDefault>iStageMaxWidth) {
			mainImageTilePosX=iStageMaxWidth-iImageFrameWidthDefault;
		}
		else if (mainImageTilePosX<0) {
			mainImageTilePosX=0;
		}

		if (mainImageTilePosY+iImageFrameHeightDefault>iStageMaxHeight) {
			//edited by Mike, 20231126
			//mainImageTilePosY=iStageMaxHeight-iImageFrameHeightDefault;
			mainImageTilePosY=iStageMaxHeight-iImageFrameHeightDefault-iImageFrameHeightDefault*0.25;
		}
		else if (mainImageTilePosY<0) {
			mainImageTilePosY=0;
		}
						
		//--------------------------------------		
		var bossBattleBgImage = document.getElementById("bossBattleBgImageId");

/*			
		//edited by Mike, 20241103
		//alert("iAnimationCount: "+iAnimationCount);
		if (iAnimationDelayCount==iAnimationDelayCountMax) {
			iAnimationCount=(iAnimationCount+1)%3; //2; //iAnimationCountMax
			iAnimationDelayCount=0;
		}
		else {
			iAnimationDelayCount++;
		}
*/		

/*
    if (bIsBossMonsterHit) {
      //alert(iAnimationCount);
      bossMonsterImageTile.style.objectPosition = "-" + 128*(iBossMonsterAnimationCount) + "px -" + 128 + "px";

      if (iAnimationCount==1) {
        bIsBossMonsterHit=false;
        
		//edited by Mike, 20231128
		//iBossLife--;
		if (iScore==1) {
			iBossLife--;
		}
		

		//edited by Mike, 20231128
//		if (bossMonsterImageTile.style.visibility!="hidden") {
		if (!bIsMissionDone) {
			setMonsterExplosionEffectPosition(parseInt(bossMonsterImageTile.style.left)+iMonsterBossTileWidth/4,parseInt(bossMonsterImageTile.style.top)+iMonsterBossTileHeight/4);
		}

        if (iBossLife<=0) {
            //alert("MISSION COMPLETE!");
			bossMonsterImageTile.style.visibility="hidden";
			bIsMissionDone=true;
        }
      }
    }
    else {
      bossMonsterImageTile.style.objectPosition = "-" + 128*(iBossMonsterAnimationCount) + "px -" + 0 + "px";
    }
*/

		mainImageTile.style.left = (iHorizontalOffset+mainImageTilePosX)+"px";
		mainImageTile.style.top = (iVerticalOffsetInnerScreen+mainImageTilePosY)+"px";

		//added by Mike, 20231125
		mainImageTileTankBody.style.left = mainImageTile.style.left;
		mainImageTileTankBody.style.top = mainImageTile.style.top;

		mainImageTileHeroBody.style.left = mainImageTile.style.left;
		mainImageTileHeroBody.style.top = mainImageTile.style.top;

/*
    mainImageMonster.style.left = (iHorizontalOffset+mainImageMonsterPosX)+"px";
    mainImageMonster.style.top = (iVerticalOffsetInnerScreen+mainImageMonsterPosY)+"px";
*/

/*
    bossMonsterImageTile.style.left = (iHorizontalOffset+bossMonsterImageTilePosX)+"px";
    bossMonsterImageTile.style.top = (iVerticalOffsetInnerScreen+bossMonsterImageTilePosY)+"px";
*/

//-----------------------

		//added by Mike, 20230427			
		if (bHasHeroShotFireball) {		
			resetProjectile();
		
			mainImageTileFireballProjectile.style.visibility = "visible";
			
			mainImageTileFireballProjectilePosY=parseInt(mainImageTileFireballProjectilePosY)+newMainImageTileFireballProjectilePosY;
			
			mainImageTileFireballProjectilePosX=parseInt(mainImageTileFireballProjectilePosX)+newMainImageTileFireballProjectilePosX;

			mainImageTileFireballProjectile.style.left = mainImageTileFireballProjectilePosX+"px";
			mainImageTileFireballProjectile.style.top = mainImageTileFireballProjectilePosY+"px";
		
			//alert (mainImageTileFireballProjectilePosY);
		
			//return;
		}
		
		if (mainImageTileFireballProjectilePosX+iImageFrameWidth>iStageMaxWidth-iInnerHorizontalOffset) {//iHorizontalOffset		
			//alert("DITO");
			resetFireballProjectile();
		}
		else if (mainImageTileFireballProjectilePosX<0+iInnerHorizontalOffset){ //iHorizontalOffset
			resetFireballProjectile();
		}

		//iImageFrameHeight is offset
		if (mainImageTileFireballProjectilePosY+iImageFrameHeight/2>iStageMaxHeight-iImageFrameHeight) {
			resetFireballProjectile();
		}
		else if (mainImageTileFireballProjectilePosY<0+iImageFrameHeight) {
			//alert ("DITO");
			resetFireballProjectile();
		}
		
		
			//movement
			if (bHasFired) {
/*			
				if (bIsActionKeyPressed) {
					//alert("DITO");
					
					mainImageTileProjectile.style.visibility = "visible";					
				}
				else {
					//mainImageTileProjectile.style.visibility = "visible";
					mainImageTileProjectile.style.visibility = "hidden";
				}
*/				
				mainImageTileProjectile.style.visibility = "hidden";


mainImageTileProjectilePosY=parseInt(mainImageTileProjectilePosY)+newMainImageTileProjectilePosY;

					mainImageTileProjectilePosX=parseInt(mainImageTileProjectilePosX)+newMainImageTileProjectilePosX;
		

		mainImageTileProjectile.style.left = mainImageTileProjectilePosX+"px";

		mainImageTileProjectile.style.top = mainImageTileProjectilePosY+"px";
		
		if (bHasHeroShotFireball) {
/*
			resetProjectile();
		
			mainImageTileFireballProjectile.style.visibility = "visible";
			mainImageTileFireballProjectilePosY=parseInt(mainImageTileFireballProjectilePosY)+newMainImageTileFireballProjectilePosY;
			mainImageTileFireballProjectilePosX=parseInt(mainImageTileFireballProjectilePosX)+newMainImageTileFireballProjectilePosX;

			mainImageTileFireballProjectile.style.left = mainImageTileFireballProjectilePosX+"px";
			mainImageTileFireballProjectile.style.top = mainImageTileFireballProjectilePosY+"px";
		
			//return;
*/			
		}
		else {				
			if ((mainImageTilePosX==mainImageTileProjectilePosX) && (mainImageTilePosY==mainImageTileProjectilePosY)) {
				resetProjectile();
				return;
			}

			mainImageTilePosX=mainImageTileProjectilePosX;		
			mainImageTilePosY=mainImageTileProjectilePosY;
			
			
			if (bIsHeroInTank) {
				executeTankWalkingAnimation();
			}
			else {
				executeHeroWalkingAnimation();
			}
		}

//-----------------
/*
    if (isPointsOfRectIntersectingPointsOfRect(mainImageTileProjectilePosX,mainImageTileProjectilePosY, parseInt(mainImageMonster.style.left),parseInt(mainImageMonster.style.top))) {
//        alert("HIT!");
      mainImageMonster.style.visibility="hidden";
    }
*/


/*
	//edited by Mike, 20231128
	if (!bIsMissionDone) {
		if (isPointsOfRectIntersectingPointsOfRect(mainImageTileProjectilePosX,mainImageTileProjectilePosY, parseInt(bossMonsterImageTile.style.left),parseInt(bossMonsterImageTile.style.top))) {
	//        alert("HIT!");
		  //bossMonsterImageTile.style.visibility="hidden";
		  //added by Mike, 20231126
		  bIsBossMonsterHit=true;

		  //added by Mike, 20231126
		  resetProjectile();
		}
	}
*/

/*
		if ((bHasFireballReachedDestinationX) && (bHasFireballReachedDestinationY)) {
				resetFireballProjectile();				
		}				
*/


//-----------------

		if (bIsHeroInTank) {
			iImageFrameWidth=iImageFrameWidthLarge;
		}
		else {
			iImageFrameWidth=iImageFrameWidthDefault;
		}

		//destination to the left of hero projectile
		//if (!bHasReachedDestinationX) {
			if (newMainImageTileProjectilePosX<0) {
				if (mainImageTileProjectilePosX+iImageFrameWidth/2<=mainImageTileProjectileStepDestinationX) {
						
				  mainImageTileProjectilePosX=mainImageTileProjectileStepDestinationX-iImageFrameWidth/2;
				  bHasReachedDestinationX=true;
				  //resetProjectile();
				}
				else {
				  bHasReachedDestinationX=false;
				}
			}
			//destination to the right of hero projectile
			else {
				if (mainImageTileProjectilePosX+iImageFrameWidth/2>=mainImageTileProjectileStepDestinationX) {
					mainImageTileProjectilePosX=mainImageTileProjectileStepDestinationX-iImageFrameWidth/2;
					bHasReachedDestinationX=true;
					//resetProjectile();
				}		
				else {
				  bHasReachedDestinationX=false;
				}				
			}
		//}
		
		//if (!bHasReachedDestinationY) {		
			//destination to the top of hero projectile
			if (newMainImageTileProjectilePosY<0) {
				if (mainImageTileProjectilePosY+iImageFrameHeight/2<=mainImageTileProjectileStepDestinationY) {
										
				mainImageTileProjectilePosY=mainImageTileProjectileStepDestinationY-iImageFrameHeight/2;
				bHasReachedDestinationY=true;
				//resetProjectile();
				}
				else {
				  bHasReachedDestinationY=false;
				}				
			}
			//destination to the bottom of hero projectile
			else {
				if (mainImageTileProjectilePosY+iImageFrameHeight/2>=mainImageTileProjectileStepDestinationY) {
					mainImageTileProjectilePosY=mainImageTileProjectileStepDestinationY-iImageFrameHeight/2;
					bHasReachedDestinationY=true;
					//resetProjectile();
				}			
				else {
				  bHasReachedDestinationY=false;
				}								
			}			
		//}
		
							
			if ((bHasReachedDestinationX) && (bHasReachedDestinationY)) {
				resetProjectile();				
			}				

			if (mainImageTileProjectilePosX+iImageFrameWidth>iStageMaxWidth+iHorizontalOffset) {
	//+iImageFrameWidth
				resetProjectile();
			}
			else if (mainImageTileProjectilePosX<0+iHorizontalOffset){
					resetProjectile();
			}

			if (mainImageTileProjectilePosY+iImageFrameHeight/2>iStageMaxHeight) {
				resetProjectile();
			}
			else if (mainImageTileProjectilePosY<0) {
				resetProjectile();
			}		
		
			}

		  }	 
		  		  
// if (bIsMissionDone==false)
		}
	  } //if bIsMissionStarted;	
	}

  function processResultFromInput(iXPos, iYPos) {
      if (!bIsMissionDone) {
        processBossBattleResultFromInput(iXPos, iYPos);
      }
  }
  
  function processResultFromInputRightMouseClickClick(iXPos, iYPos) {
	var mainImageTile = document.getElementById("mainImageTileImageId");
	var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");
	var mainImageTileProjectile = document.getElementById("mainImageTileProjectileImageId");
	
    if (!bHasFired) {

		mainImageTileProjectileStepY=mainImageTileProjectileVelocityY;
		mainImageTileProjectileStepX=mainImageTileProjectileVelocityX;

		//reference: https://stackoverflow.com/questions/15994194/how-to-convert-x-y-coordinates-to-an-angle; last accessed: 20230428;
		//--> answer by: Mohsen, 20130413T2357; from 20150322T2246;
		//start position @center
		//note: subtract margine offset
		var iDeltaX=(iXPos-iHorizontalOffset)-(mainImageTilePosX+iImageFrameWidth/2);
		var iDeltaY=(iYPos-iVerticalOffset)-(mainImageTilePosY+iImageFrameHeight/2);

		iDeltaY*=-1;

		var fMainImageTileStepAngleRad=Math.atan2(iDeltaX,iDeltaY);

		iMainImageTileStepAngle=fMainImageTileStepAngleRad*(180/Math.PI);

		//clockwise
		iMainImageTileStepAngle=(iMainImageTileStepAngle)%360;

		mainImageTile.style.transform = "rotate("+ (iMainImageTileStepAngle % 360) +"deg)";

		newMainImageTileProjectilePosY=mainImageTileProjectileStepY*Math.cos(fMainImageTileStepAngleRad).toFixed(3);

    	newMainImageTileProjectilePosY*=-1;
		newMainImageTileProjectilePosX=mainImageTileProjectileStepX*Math.sin(fMainImageTileStepAngleRad).toFixed(3);

		mainImageTileProjectilePosX = mainImageTile.style.left;
		mainImageTileProjectilePosY = mainImageTile.style.top;

		bHasFired=true;

/*		//TODO: -use: movement sound
		var myAudioEffectCannonFire = document.getElementById("myAudioEffectCannonFireId");

		myAudioEffectCannonFire.setAttribute("src", sAudioEffectActionCannonFire);

		//fMyAudioEffectVolume=0.2;
		fMyAudioEffectCannonFireVolume=1.0;
		myAudioEffectCannonFire.volume=fMyAudioEffectCannonFireVolume;
		myAudioEffectCannonFire.loop=false;
		myAudioEffectCannonFire.play();
*/	
	}
  }


  function processBossBattleResultFromInput(iXPos, iYPos) {		
		
/*
if (iMouseClickStartTime!=0) {
alert(Date.now()-iMouseClickStartTime);
}
*/

	//added by Mike, 20231124
	var mainImageTile = document.getElementById("mainImageTileImageId");
	//removed by Mike, 20231128
	//mainImageTile.style.visibility = "visible";

	//added by Mike, 20231124
	var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");

	var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");

	//removed by Mike, 20231128
	//mainImageTileTankBody.style.visibility = "visible";
	
	//added by Mike, 20231130
	var mainImageTileProjectile = document.getElementById("mainImageTileProjectileImageId");
	
	//added by Mike, 20241113
	var heroAttackEffectImage = document.getElementById("heroAttackEffectImageId");
	
	//edited by Mike, 20241105; 20241103
	bHasFiredTemp = bHasFired;
	
	//note: resets also bHasFired;
	resetProjectile();
	
	if (bIsActionKeyPressed) {
		if (iCurrHeroMana!=iCurrHeroManaMax) {	//if no mana
			return;	
		}
	}
	
/*	
	if ((!bHasReachedDestinationX) || (!bHasReachedDestinationY)) {
		resetProjectile();				
	}	
*/
	
	if (bIsHeroInTank) {
		if (isPointsOfRectIntersectingPointsOfRect(iXPos,iYPos, parseInt(mainImageTileTankBody.style.left),parseInt(mainImageTileTankBody.style.top))) {
			if ((iXPos==iPrevMouseXPos) && (iYPos==iPrevMouseYPos)) {	
				//TODO: -add: hit wall animation;
				return;
			}
		}
		
		if (isPointsOfRectIntersectingPointsOfRect(iXPos,iYPos, iPrevMouseXPos,iPrevMouseYPos)) {
			
			//do this only if at the borders of the inner stage		
			//INNER STAGE; MAX
			//iHorizontalOffset=(640-iStageMaxHeight)/2;
			//var iInnerHorizontalOffset=(640-iStageMaxHeight)/2;
			var iInnerVerticalOffset=iImageFrameHeightLarge/2;


			//reminder: innerStageWidth uses iStageMaxHeight
		
			if (mainImageTilePosX+iImageFrameWidthLarge>=iInnerHorizontalOffset+iStageMaxHeight) {
				return;
			}
			else if (mainImageTilePosX<=0+iInnerHorizontalOffset) {
				return;
			}		
			
			if (mainImageTilePosY+iImageFrameHeightLarge>=0+iStageMaxHeight-iInnerVerticalOffset) {
				return;
			}
			else if (mainImageTilePosY<=0) {
				return;
			}	
		}		
	}
	else {	
/*	
		if (isPointsOfRectIntersectingPointsOfRect(iXPos,iYPos, parseInt(mainImageTileHeroBody.style.left),parseInt(mainImageTileHeroBody.style.top))) {
			//alert("HIT!");
			//no change
			//if ((bHasReachedDestinationX) && (bHasReachedDestinationY)) {
				if ((iXPos==iPrevMouseXPos) && (iYPos==iPrevMouseYPos)) {	
					//TODO: -add: hit wall animation;
					return;
				}
			//}	
		}	
*/	
		//added by Mike, 20241104
		if (isPointsOfRectIntersectingPointsOfRect(iXPos,iYPos, iPrevMouseXPos,iPrevMouseYPos)) {
			//TODO: -add: hit wall animation;
			//return;
			
			//do this only if at the borders of the inner stage
		
			//INNER STAGE; MAX
			//iHorizontalOffset=(640-iStageMaxHeight)/2;
			//var iInnerHorizontalOffset=(640-iStageMaxHeight)/2;
			var iInnerVerticalOffset=iImageFrameHeight/2;

			//reminder: innerStageWidth uses iStageMaxHeight
		
			if (mainImageTilePosX+iImageFrameWidth>=iInnerHorizontalOffset+iStageMaxHeight) {
				return;
			}
			else if (mainImageTilePosX<=0+iInnerHorizontalOffset) {
				return;
			}		
			
			if (mainImageTilePosY+iImageFrameHeight>=0+iStageMaxHeight-iInnerVerticalOffset) {
				return;
			}
			else if (mainImageTilePosY<=0) {
				return;
			}	
		}
	}	

/*		
	iPrevMouseXPos=iXPos;
	iPrevMouseYPos=iYPos;
*/
	//--------------------------------
	bIsHeroDash=false;
	//bHasHeroShotFireball=false;

	if ((!bIsHeroInRiver) || (bHasObtainedAmuletAtRoom32)){
/*	
		//TODO: -reverify: this
		if (bHasFiredTemp) {
			if ((Date.now()-iMouseClickStartTime)<=iMouseClickMaxElapsedTime) {
				//alert(Date.now()-iMouseClickStartTime);
				
				//bIsHeroDash=true;

				if ((iPrevMouseXPos==iXPos) && (iPrevMouseYPos=iYPos)) {
					bIsHeroDash=true;
				}
				else {
					bIsHeroDash=false;
					mainImageTileProjectileStepY=mainImageTileProjectileStepYMin;
					mainImageTileProjectileStepX=mainImageTileProjectileStepXMin;
				}
			}
		}
*/
		if ((Date.now()-iMouseClickStartTime)<=iMouseClickMaxElapsedTime) {
			//alert(Date.now()-iMouseClickStartTime);
			bIsHeroDash=true;
		}			
	}
	
	iMouseClickStartTime=Date.now(); //in milliseconds
	//--------------------------------

	iPrevMouseXPos=iXPos;
	iPrevMouseYPos=iYPos;
	
	//resetProjectile() sets bHasFired to false;
	//if (!bHasFired) {
	//becomes DASH attack;
	if (bHasFiredTemp) {
			//quick double mouse click; within 1/4 second
			if (bIsHeroDash) {
				mainImageTileProjectileStepY=mainImageTileProjectileStepYMax;
				mainImageTileProjectileStepX=mainImageTileProjectileStepXMax;

	/*			//part of command to create fireball
				mainImageTileProjectilePosY=mainImageTilePosY;
				mainImageTileProjectilePosX=mainImageTilePosX;

				resetProjectile();
				
				iMouseClickStartTime=iMouseClickMaxElapsedTime+1;
				return;
	*/			
			}
	}
	else {

/*	//edited by Mike, 20231125
    mainImageTileStepY=10;
    mainImageTileStepX=10;
*/
		mainImageTileProjectileStepY=mainImageTileProjectileVelocityY;
		mainImageTileProjectileStepX=mainImageTileProjectileVelocityX;
	}
	
/*	
	if (bIsActionKeyPressed) {
		if (!bHasHeroShotFireball) {
			//part of command to create fireball
			mainImageTileProjectilePosY=mainImageTilePosY;
			mainImageTileProjectilePosX=mainImageTilePosX;

			resetProjectile();
			
			iMouseClickStartTime=iMouseClickMaxElapsedTime+1;
			
			//bHasHeroShotFireball=true;
			//return;
		}
	}
*/	

    //reference: https://stackoverflow.com/questions/15994194/how-to-convert-x-y-coordinates-to-an-angle; last accessed: 20230428;
    //--> answer by: Mohsen, 20130413T2357; from 20150322T2246;

    //start position @center
    //note: subtract margine offset
    /*
    var iDeltaX=iXPos-mainImageTilePosX;
    var iDeltaY=iYPos-mainImageTilePosY;
    */
    /*
    var iDeltaX=(iXPos-iHorizontalOffset)-mainImageTilePosX;
    var iDeltaY=(iYPos-iVerticalOffset)-mainImageTilePosY;
    */

	var iDeltaX=(iXPos-iHorizontalOffset)-(mainImageTilePosX+iImageFrameWidth/2);
	var iDeltaY=(iYPos-iVerticalOffset)-(mainImageTilePosY+iImageFrameHeight/2);
	
	if (bIsHeroInTank) {
		iDeltaX=(iXPos-iHorizontalOffset)-(mainImageTilePosX+iImageFrameWidthLarge/2);
		iDeltaY=(iYPos-iVerticalOffset)-(mainImageTilePosY+iImageFrameHeightLarge/2);
	}

    //alert("iXPos: "+iXPos);

    /*
    alert("mainImageTilePosX: "+mainImageTilePosX);
    alert("iDeltaX: "+iDeltaX);
    */


    iDeltaY*=-1;

    var fMainImageTileStepAngleRad=Math.atan2(iDeltaX,iDeltaY);

    iMainImageTileStepAngle=fMainImageTileStepAngleRad*(180/Math.PI);

    //					newMainImageTileProjectilePosY*=-1;

    //clockwise
    iMainImageTileStepAngle=(iMainImageTileStepAngle)%360;
    /*
    alert(iMainImageTileStepAngle);
    */

    mainImageTile.style.transform = "rotate("+ (iMainImageTileStepAngle % 360) +"deg)";


	
		newMainImageTileProjectilePosY=mainImageTileProjectileStepY*Math.cos(fMainImageTileStepAngleRad).toFixed(3);

		newMainImageTileProjectilePosY*=-1;
		newMainImageTileProjectilePosX=mainImageTileProjectileStepX*Math.sin(fMainImageTileStepAngleRad).toFixed(3);

		//added by Mike, 20231125
		mainImageTileProjectilePosX = mainImageTile.style.left;
		mainImageTileProjectilePosY = mainImageTile.style.top;


		//added by Mike, 20241103
		mainImageTileProjectileStepDestinationX=iXPos;//iDeltaX;//newMainImageTileProjectilePosX;//.iDeltaX;
		mainImageTileProjectileStepDestinationY=iYPos;//iDeltaY;//newMainImageTileProjectilePosY;//iDeltaY;


	if (bIsActionKeyPressed) {
/*	
		if (iCurrHeroMana!=iCurrHeroManaMax) {	//if no mana
			resetProjectile();	
		}
		else {
*/		
			if (!bHasHeroShotFireball) {
				//part of command to create fireball
				//mainImageTileProjectilePosY=mainImageTilePosY;
				//mainImageTileProjectilePosX=mainImageTilePosX;

				resetProjectile();			
				iMouseClickStartTime=iMouseClickMaxElapsedTime+1;	
				bHasHeroShotFireball=true;		
				
				iCurrHeroMana=0;//set to empty
			
				newMainImageTileFireballProjectilePosY=mainImageTileFireballProjectileStepY*Math.cos(fMainImageTileStepAngleRad).toFixed(3);

				newMainImageTileFireballProjectilePosY*=-1;
				newMainImageTileFireballProjectilePosX=mainImageTileFireballProjectileStepX*Math.sin(fMainImageTileStepAngleRad).toFixed(3);

				mainImageTileFireballProjectilePosX = mainImageTile.style.left;
				mainImageTileFireballProjectilePosY = mainImageTile.style.top;

				mainImageTileFireballProjectileStepDestinationX=iXPos;
				mainImageTileFireballProjectileStepDestinationY=iYPos;
				
				setInitFireballEffectPosition(mainImageTilePosX,mainImageTilePosY);
				//AI; movement due to river
/*				
				if (bIsHeroInRiver) {
					//IF has reached bottom
					if (!bHasObtainedAmuletAtRoom32) {
						setInitFireballEffectPosition(mainImageTilePosX,mainImageTilePosY+mainImageTileStepY*5);
					}
					else {
						setInitFireballEffectPosition(mainImageTilePosX,mainImageTilePosY);
					}
				}
				else {
					setInitFireballEffectPosition(mainImageTilePosX,mainImageTilePosY);
				}
*/				
			}
/*			
		}
*/		
	}
	
	
    					bHasFired=true;
						
						//added by Mike, 20241104
						//start at second frame; due to at present, no idle animation yet;
						//need to also display movement in animation;
						iHeroAnimationCount=1;
				
/*	//TODO: -update: to use fireball sound
				var myAudioEffectCannonFire = document.getElementById("myAudioEffectCannonFireId");

				myAudioEffectCannonFire.setAttribute("src", sAudioEffectActionCannonFire);

				//fMyAudioEffectVolume=0.2;
				fMyAudioEffectCannonFireVolume=1.0;
				myAudioEffectCannonFire.volume=fMyAudioEffectCannonFireVolume;
				myAudioEffectCannonFire.loop=false;
				myAudioEffectCannonFire.play();
*/				

/*
		if (newMainImageTileProjectilePosX+iImageFrameWidth/2<0) {
			bIsHeroFacingLeft=true;
		}
		else if (newMainImageTileProjectilePosX>0) {
			bIsHeroFacingLeft=false;
		}
		else {// if (newMainImageTileProjectilePosX==0) {
			//bIsHeroFacingLeft=true;
			//keep current facing direction
		}
*/		
		if (iDeltaX<0) {
			bIsHeroFacingLeft=true;
		}
		else if (iDeltaX>0) {
			bIsHeroFacingLeft=false;
		}
		else {
			//bIsHeroFacingLeft=false;
		}					
				
		//added by Mike, 20241105
		setDustEffectPosition(mainImageTilePosX,mainImageTilePosY);
		
		
//added by Mike, 20241113
setHeroAttackEffectPosition(mainImageTileProjectileStepDestinationX-iImageFrameWidthDefault/2,mainImageTileProjectileStepDestinationY-iImageFrameHeightDefault/2); //mainImageTilePosX,mainImageTilePosY);

////heroAttackEffectImage.style.left = mainImageTile.style.left;
////heroAttackEffectImage.style.top = mainImageTile.style.top;

/*		
    }
*/
  }
  
	function playSolvedTune() {
		var myAudioEffectSolved = document.getElementById("myAudioEffectSolvedId");

		myAudioEffectSolved.setAttribute("src", sAudioEffectSolved);

		//fMyAudioEffectVolume=0.2;
		myAudioEffectSolvedVolume=1.0;
		myAudioEffectSolved.volume=myAudioEffectSolvedVolume;
		myAudioEffectSolved.loop=false;
		myAudioEffectSolved.play();
		
		bHasPlayedSolvedTune=true;
	}

	function executeHeroContinue(bIsContinue) {
		//CONTINUE
		iCurrHeroLife=iCurrHeroLifeMax;
		iCurrHeroMana=iCurrHeroManaMax;
		bIsGameOver=false;
		iInputDelayAtGameOverCount=0;
		
		iCurrHeroDeathCount++;

		iHeroInvincibileCount=0;
		bIsHeroAttacked=false;
		bIsExecutingShake=false;
		iDestroyHumanShakeDelayCount=0;
		
		var myFavicon = document.getElementById("faviconImageId");						
		var textStatusDiv = document.getElementById("textStatusDivId");	
		var textNewGameDiv = document.getElementById("textNewGameDivId");
		var textContinueGameDiv = document.getElementById("textContinueGameDivId");
		
		var mainImageTile = document.getElementById("mainImageTileImageId");
		var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");
		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");
		
		explosionEffectImage = document.getElementById("explosionEffectImageId");
		
		var keyStatusImageTile = document.getElementById("keyStatusImageTileId");
		var amuletStatusImageTile = document.getElementById("amuletStatusImageTileId"); 
		
		myFavicon.style.visibility="hidden";	
		textStatusDiv.style.visibility="hidden";
		textNewGameDiv.style.visibility="hidden";		
		textContinueGameDiv.style.visibility="hidden";
		explosionEffectImage.style.visibility="hidden";
		
		if (!bIsContinue) {		
			//NEW GAME
			iCurrBossMonsterLife=iCurrBossMonsterLifeMax;
			
			mainImageTilePosX=iStageMaxWidth/2-iImageFrameWidth/2;
			mainImageTilePosY=iStageMaxHeight/2-iImageFrameHeight;
			
			mainImageTile.style.left = (iHorizontalOffset+mainImageTilePosX)+"px";
			mainImageTile.style.top = (iVerticalOffsetInnerScreen+mainImageTilePosY)+"px";
			
			mainImageTileTankBody.style.left = mainImageTile.style.left;
			mainImageTileTankBody.style.top = mainImageTile.style.top;

			mainImageTileHeroBody.style.left = mainImageTile.style.left;
			mainImageTileHeroBody.style.top = mainImageTile.style.top;

			//start from the beginning;
			//reset; new game
			dElapsedTimeInSeconds=0;

			iCurrMapLocation=53;		
			iStartTimeInMilliseconds=Date.now();	

			bHasObtainedPearlAtRoom42=false;
			bHasObtainedPearlAtRoom41=false;
			bHasObtainedPearlAtRoom33=false;
			bHasObtainedPearlAtRoom43=false;			
			bHasObtainedPearlAtRoom22=false;			
			//bHasObtainedPearlAtRoom11=false; //KEY
			bHasObtainedKeyAtRoom1=false;
			bHasUsedKeyAtRoom11=false;
			bHasObtainedAmuletAtRoom32=false;
			bHasObtainedPearlAtRoom12=false;
						
			keyStatusImageTile.style.visibility="hidden";
			amuletStatusImageTile.style.visibility="hidden";
			
			iInputDelayAtGameOverCount=0;
			bHasFired=false;
			bIsHeroAttacked=false;			
			iCurrHeroDeathCount=0;
			iCurrPearlCount=0;
			iCurrMonsterDeathCount=0;

			bIsHeroInRiver=false;
			bHasHeroReachedBottomOfRoomRiver=false;
			bHasHeroReachedTopOfRoomRiver=false;
			bIsActionKeyPressed=false;
			bHasPlayedSolvedTune=false;			
			
			myAudio.play();
			myAudioPart2.pause();
			myAudioPart3.pause();

			for (iRowCount=0; iRowCount<iRowCountMax; iRowCount++) {				
				for (iColumnCount=0; iColumnCount<iColumnCountMax; iColumnCount++) {
					arrayHasVisitedRoom[iColumnCount][iRowCount]=0;
				}
			}			
			
		}
	}

	//added by Mike, 20231125
	function initKeyboardInput() {
		var mainImageTileFireballProjectileHold = document.getElementById("mainImageTileFireballProjectileHoldImageId");
	
		document.body.onkeydown = function(e){
			//alert("e.keyCode: "+e.keyCode);
			
/*			
			if (!bHasFired) {
				executeHeroFireballProjectileHoldAnimation();
			}
*/
			bIsActionKeyPressed=true;

			if ((!bIsGameOver) && (bHasPressedStart)) {
				executeHeroFireballProjectileHoldAnimation();
			}
/*
				//added by Mike, 20221121
				bIsActionKeyPressed=false;

				//RIGHT ARROW; 39
				//LEFT ARROW; 37
				//UP ARROW; 38
				//DOWN ARROW; 40
				//alert(e.keyCode);


				//OK; //note: unicode keycode, where: key d : 100?
				//note: auto-accepts keyhold; however, with noticeable delay
				//solved: via bKeyDownRight = false; et cetera
				if (e.keyCode==68) { //key d
			//			alert("dito");
					arrayKeyPressed[iKEY_D]=true;
				}
				else if (e.keyCode==65) { //key a
					arrayKeyPressed[iKEY_A]=true;
				}

				if (e.keyCode==39) { //key RIGHT
					arrayKeyPressed[iKEY_D]=true;
				}
				else if (e.keyCode==37) { //key LEFT
					arrayKeyPressed[iKEY_A]=true;
				}
*/

/*
				if (e.keyCode==87) { //key w
					arrayKeyPressed[iKEY_W]=true;
				}
				else if (e.keyCode==83) { //key s
					arrayKeyPressed[iKEY_S]=true;
				}
*/

/*
				//added by Mike, 20221101
				//notes: RIGHT-SIDE BUTTONS to already accept
				//both capital and small letters

				//RIGHT-SIDE BUTTONS
				if (e.keyCode==73) { //key i
					arrayKeyPressed[iKEY_I]=true;

					//added by Mike, 20221121
					bIsActionKeyPressed=true;
				}
				else if (e.keyCode==75) { //key k
					arrayKeyPressed[iKEY_K]=true;

					//added by Mike, 20221121
					bIsActionKeyPressed=true;
				}

				if (e.keyCode==74) { //key j
					arrayKeyPressed[iKEY_J]=true;

					//added by Mike, 20221121
					bIsActionKeyPressed=true;
				}
				else if (e.keyCode==76) { //key l
					arrayKeyPressed[iKEY_L]=true;

					//added by Mike, 20221121
					bIsActionKeyPressed=true;
				}
*/
			}

			//added by Mike, 20220822
			document.body.onkeyup = function(e){
				//alert("KEYUP; e.keyCode: "+e.keyCode);
				
				bIsActionKeyPressed=false;
				
				mainImageTileFireballProjectileHold.style.visibility="hidden";
				iHeroFireballProjectileHoldAnimationDelayCount=0;
				
				
/*				
				if (e.keyCode==68) { //key d
					//edited by Mike, 20220823
					//bKeyDownRight=false;
					arrayKeyPressed[iKEY_D]=false;
				}
				else if (e.keyCode==65) { //key a
					arrayKeyPressed[iKEY_A]=false;
				}

				//added by Mike, 20220823
				if (e.keyCode==87) { //key w
					arrayKeyPressed[iKEY_W]=false;
				}
				else if (e.keyCode==83) { //key s
					arrayKeyPressed[iKEY_S]=false;
				}
*/				
				
/*
				//added by Mike, 20221101
				//RIGHT-SIDE BUTTONS
				if (e.keyCode==73) { //key i
					arrayKeyPressed[iKEY_I]=false;

					//added by Mike, 20221121
					bIsActionKeyPressed=false;
				}
				else if (e.keyCode==75) { //key k
					arrayKeyPressed[iKEY_K]=false;

					//added by Mike, 20221121
					bIsActionKeyPressed=false;
				}

				if (e.keyCode==74) { //key j
					arrayKeyPressed[iKEY_J]=false;

					//added by Mike, 20221121
					bIsActionKeyPressed=false;
				}
				else if (e.keyCode==76) { //key l
					arrayKeyPressed[iKEY_L]=false;

					//added by Mike, 20221121
					bIsActionKeyPressed=false;
				}
*/
			}
	}

	//added by Mike, 20230423
	function initMouseInput() {

/*		//TODO: -update: this		
		//reference: https://www.w3schools.com/jsref/tryit.asp?filename=tryjsref_onmousedown_addeventlistener;
		//last accessed: 20241122
		document.body.addEventListener('mouseup', (event) => {		
		  //alert("DITO!!!");
		  
			//reference Usbong SFZ
			for (int i=0; i<MAX_PLASMA_COUNT; i++) {
				if (!myPlasmaContainer[i].isActive()) {
					if (iPlasmaCharge==iPlasmaChargeMax) {
					  myPlasmaContainer[i].setChargedPlasma(true);
					  bIsPlasmaChargeReleased=true;
						  
					  System.out.println("Plasma Charge Released!: "+iPlasmaCharge);  
					}
					  
					myPlasmaContainer[i].processMouseInput(iMouseXPos, iMouseYPos, myRobotShip.getX(),myRobotShip.getY());
						
					bIsFiring=true;				    
					break;
				}
			}		  	  
				  
		    iPlasmaCharge=0;	
		    bHasPressedFiring=false;
		});
*/		
	
		//reference: https://stackoverflow.com/questions/70827887/detect-click-vs-touch-in-javascript;
		//last accessed: 20221110
		//answer by:  Jacob, 20220124T0110
		document.body.addEventListener('pointerdown', (event) => {
			if (bIsGameOver) {
				if (iInputDelayAtGameOverCount<iInputDelayAtGameOverCountMax) {
					return;
				}
			}

			//reference: https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/pointerType;
			//last accessed: 20221122
			switch(event.pointerType) {
				case 'mouse':
					//note: ZOOM function causes position ERROR via screenX
					var iXPos = event.clientX;//screenX;

					//note: screenY includes BROWSER address bar, et cetera;
					var iYPos = event.pageY; //screenY;

					//alert(event.which);
					
					if (event.which===3) { //right-click
						break;						
					}
					else { //if 1; left-click
/*
        //edited by Mike, 20230423
        alert("iXPos: "+iXPos);
        alert("iYPos: "+iYPos);
*/
						if (bIsGameOver) {
							var textNewGameDiv = document.getElementById("textNewGameDivId");
							var textContinueGameDiv = document.getElementById("textContinueGameDivId");

							textNewGameDiv.style.visibility="visible";
							textContinueGameDiv.style.visibility="visible";
						
							//init(); //note: error; iCurrMapLocation could not be set;
							//restarts where hero died;						
							//current working solution
							//executeHeroContinue();
							//return;
							
							//alert("iXPos"+iXPos);
													
							if (isPointsOfRectIntersectingPointsOfRectDoor(iXPos,iYPos, parseInt(textNewGameDiv.style.left),parseInt(textNewGameDiv.style.top),textNewGameDiv.clientWidth,textNewGameDiv.clientHeight)) {
							
								executeHeroContinue(false);
							
								return;
							}
							else if (isPointsOfRectIntersectingPointsOfRectDoor(iXPos,iYPos, parseInt(textContinueGameDiv.style.left),parseInt(textContinueGameDiv.style.top),textContinueGameDiv.clientWidth,textContinueGameDiv.clientHeight)) {
							
								executeHeroContinue(true);
							
								return;
							}

							return;
						}

						//added by Mike, 20231122
						if (bHasPressedStart) {
						
						if (iInputDelayCount<iInputDelayCountMax) {
							//iInputDelayCount++;
							return;
						}
			
						  //alert(">");
						  if (!bHasViewedHowToPlayGuide) {
							bHasViewedHowToPlayGuide=true;
							playSolvedTune();
							
							iInputDelayCount=0;
							return;
						  }
						  else {
							  if (!bHasViewedMissionIntro) {
								bHasViewedMissionIntro=true;
								return;
							  }
						  }
						}
						else {
						  bHasPressedStart=true;
						  playSolvedTune();
						  iInputDelayCount=0;
						  return;
						}

						//added by Mike, 20231107
						processResultFromInput(iXPos, iYPos);
					
						//alert(">>>>>: "+iCurrMapLocation);
					}
					break;
				case 'touch':
/*
					//alert("TOUCH");
					if (bIsUsingAppleWebKit) {
					  //added by Mike, 20221111; removed by Mike, 20221118
					  //note: NOT yet set
					  if (bIsUsingAppleMac) {
						toggleFullScreen();
					  }

					  bIsUsingAppleMac=false;
					  bIsMobile=true; //added by Mike, 20221110

					  //added by Mike, 20230111
					  bHasSetMaxWidthHeight=true;
					}
*/
//note: ZOOM function causes position ERROR via screenX
					var iXPos = event.clientX;//screenX;

					//note: screenY includes BROWSER address bar, et cetera;
					var iYPos = event.pageY; //screenY;

					//alert(event.which);
					
					if (event.which===3) { //right-click
						break;						
					}
					else { //if 1; left-click
/*
        //edited by Mike, 20230423
        alert("iXPos: "+iXPos);
        alert("iYPos: "+iYPos);
*/
						if (bIsGameOver) {
							var textNewGameDiv = document.getElementById("textNewGameDivId");
							var textContinueGameDiv = document.getElementById("textContinueGameDivId");

							textNewGameDiv.style.visibility="visible";
							textContinueGameDiv.style.visibility="visible";
						
							//init(); //note: error; iCurrMapLocation could not be set;
							//restarts where hero died;						
							//current working solution
							//executeHeroContinue();
							//return;
							
							//alert("iXPos"+iXPos);
													
							if (isPointsOfRectIntersectingPointsOfRectDoor(iXPos,iYPos, parseInt(textNewGameDiv.style.left),parseInt(textNewGameDiv.style.top),textNewGameDiv.clientWidth,textNewGameDiv.clientHeight)) {
							
								executeHeroContinue(false);
							
								return;
							}
							else if (isPointsOfRectIntersectingPointsOfRectDoor(iXPos,iYPos, parseInt(textContinueGameDiv.style.left),parseInt(textContinueGameDiv.style.top),textContinueGameDiv.clientWidth,textContinueGameDiv.clientHeight)) {
							
								executeHeroContinue(true);
							
								return;
							}

							return;
						}

						//added by Mike, 20231122
						if (bHasPressedStart) {
						
						if (iInputDelayCount<iInputDelayCountMax) {
							//iInputDelayCount++;
							return;
						}
			
						  //alert(">");
						  if (!bHasViewedHowToPlayGuide) {
							bHasViewedHowToPlayGuide=true;
							playSolvedTune();
							
							iInputDelayCount=0;
							return;
						  }
						  else {
							  if (!bHasViewedMissionIntro) {
								bHasViewedMissionIntro=true;
								return;
							  }
						  }
						}
						else {
						  bHasPressedStart=true;
						  playSolvedTune();
						  iInputDelayCount=0;
						  return;
						}

						//added by Mike, 20231107
						processResultFromInput(iXPos, iYPos);
					
						//alert(">>>>>: "+iCurrMapLocation);
					}								
					break;
			}
		});
	}


	//TODO: -fix: touch-and-hold image displayed problem
function initTouchInput() {
	//added by Mike, 20231107
	//reference: https://stackoverflow.com/questions/62823062/adding-a-simple-left-right-swipe-gesture/62825217#62825217;
	//answer by: smmehrab, 20200709T2330; edited 20200711T0355
	document.body.addEventListener('touchstart', function (event) {

		//added by Mike, 20231114
		if (iInputDelayCount<iInputDelayCountMax) {
			iInputDelayCount++;
			return;
		}


		iEventChangedTouchCount = event.changedTouches.length;

		for (iCount=0; iCount<iEventChangedTouchCount; iCount++) {

				//edited by Mike, 20221121
				//note: ZOOM function causes position ERROR via screenX
				var iXPos = event.changedTouches[iCount].clientX;//screenX;

				//note: screenY includes BROWSER address bar, et cetera;
				var iYPos = event.changedTouches[iCount].pageY; //screenY;

				//alert(iYPos);
/*
				alert("iXPos: "+iXPos);
				alert("iYPos: "+iYPos);
*/
				processResultFromInput(iXPos, iYPos);


		}
	});
}


  //added by Mike, 20221123
  //@return bool
  function isPointsOfRectIntersectingPointsOfRect(iXPos1, iYPos1, iXPos2, iYPos2) {
  		//alert("iPuzzleTileWidth: "+iPuzzleTileWidth);

  	let mdo1XPos = iXPos1;
  	let mdo1YPos = iYPos1;

  	//edited by Mike, 20230524
  	//set as a point; not a tile
  	let mdo1Width = 1;//iPuzzleTileWidth;
  	let mdo1Height = 1;//iPuzzleTileHeight;

  	let mdo2XPos = iXPos2;
  	let mdo2YPos = iYPos2;

	//TODO: -verify: this with LARGE

  	let mdo2Width = iImageFrameWidth; //iPuzzleTileWidth;
  	let mdo2Height = iImageFrameHeight; //iPuzzleTileHeight;

  	let iOffsetXPosAsPixel = 0;
  	let iOffsetYPosAsPixel = 0;

  	//alert("mdo1XPos: "+mdo1XPos);

  /*
  	alert("mdo1XPos: "+mdo1XPos+"; "+"mdo1Width: "+mdo1Width);
  	alert("mdo2XPos: "+mdo2XPos+"; "+"mdo2Width: "+mdo2Width);
  */

  	if ((mdo2YPos+mdo2Height < mdo1YPos+iOffsetYPosAsPixel) || //is the bottom of mdo2 above the top of mdo1?
  		(mdo2YPos > mdo1YPos+mdo1Height-iOffsetYPosAsPixel) || //is the top of mdo2 below the bottom of mdo1?
  		(mdo2XPos+mdo2Width < mdo1XPos+iOffsetXPosAsPixel) || //is the right of mdo2 to the left of mdo1?
  		(mdo2XPos > mdo1XPos+mdo1Width-iOffsetXPosAsPixel)) //is the left of mdo2 to the right of mdo1?
  	{
  		//no collision
  		return false;
  	}

  	return true;
  }

  //added by Mike, 20241109
  //@return bool
  //TODO: -add: iImageFrameWidth; iImageFrameWidthLarge
  function isPointsOfRectIntersectingPointsOfRectDoor(iXPos1, iYPos1, iXPos2, iYPos2, iDoorImageFrameWidth, iDoorImageFrameHeight) {
  	let mdo1XPos = iXPos1;
  	let mdo1YPos = iYPos1;

	//TODO: -update: this

  	//edited by Mike, 20230524
  	//set as a point; not a tile
  	let mdo1Width = 1;//iPuzzleTileWidth;
  	let mdo1Height = 1;//iPuzzleTileHeight;

  	let mdo2XPos = iXPos2;
  	let mdo2YPos = iYPos2;

  	let mdo2Width = iDoorImageFrameWidth; //iImageFrameWidth; //iPuzzleTileWidth;
  	let mdo2Height = iDoorImageFrameHeight; //iImageFrameHeight; //iPuzzleTileHeight;

  	let iOffsetXPosAsPixel = 0;
  	let iOffsetYPosAsPixel = 0;

  	//alert("mdo1XPos: "+mdo1XPos);

  /*
  	alert("mdo1XPos: "+mdo1XPos+"; "+"mdo1Width: "+mdo1Width);
  	alert("mdo2XPos: "+mdo2XPos+"; "+"mdo2Width: "+mdo2Width);
  */

  	if ((mdo2YPos+mdo2Height < mdo1YPos+iOffsetYPosAsPixel) || //is the bottom of mdo2 above the top of mdo1?
  		(mdo2YPos > mdo1YPos+mdo1Height-iOffsetYPosAsPixel) || //is the top of mdo2 below the bottom of mdo1?
  		(mdo2XPos+mdo2Width < mdo1XPos+iOffsetXPosAsPixel) || //is the right of mdo2 to the left of mdo1?
  		(mdo2XPos > mdo1XPos+mdo1Width-iOffsetXPosAsPixel)) //is the left of mdo2 to the right of mdo1?
  	{
  		//no collision
  		return false;
  	}

  	return true;
  }

  //added by Mike, 20221123
  //@return bool
  function isPointsOfRectIntersectingPointsOfRectMonster(iXPos1, iYPos1, iXPos2, iYPos2, iImageFrameWidth1, iImageFrameHeight1, iImageFrameWidth2, iImageFrameHeight2) {
  	let mdo1XPos = iXPos1;
  	let mdo1YPos = iYPos1;

  	//edited by Mike, 20230524
  	//set as a point; not a tile
  	let mdo1Width = iImageFrameWidth1; //1;//iPuzzleTileWidth;
  	let mdo1Height = iImageFrameHeight1; //1;//iPuzzleTileHeight;

  	let mdo2XPos = iXPos2;
  	let mdo2YPos = iYPos2;

  	let mdo2Width = iImageFrameWidth2; //iPuzzleTileWidth;
  	let mdo2Height = iImageFrameHeight2; //iPuzzleTileHeight;

  	let iOffsetXPosAsPixel = iImageFrameWidth1*0.1;//0;
  	let iOffsetYPosAsPixel = iImageFrameHeight1*0.1;//0;

  	//alert("mdo1XPos: "+mdo1XPos);

  /*
  	alert("mdo1XPos: "+mdo1XPos+"; "+"mdo1Width: "+mdo1Width);
  	alert("mdo2XPos: "+mdo2XPos+"; "+"mdo2Width: "+mdo2Width);
  */

  	if ((mdo2YPos+mdo2Height < mdo1YPos+iOffsetYPosAsPixel) || //is the bottom of mdo2 above the top of mdo1?
  		(mdo2YPos > mdo1YPos+mdo1Height-iOffsetYPosAsPixel) || //is the top of mdo2 below the bottom of mdo1?
  		(mdo2XPos+mdo2Width < mdo1XPos+iOffsetXPosAsPixel) || //is the right of mdo2 to the left of mdo1?
  		(mdo2XPos > mdo1XPos+mdo1Width-iOffsetXPosAsPixel)) //is the left of mdo2 to the right of mdo1?
  	{
  		//no collision
  		return false;
  	}

    return true;
  }
  
  //@return bool
  //note input iImageFrameWidth2*2 and iImageFrameHeight2*2
  function isPointsOfRectIntersectingPointsOfRectMonsterLarge(iXPos1, iYPos1, iXPos2, iYPos2, iImageFrameWidth1, iImageFrameHeight1, iImageFrameWidth2, iImageFrameHeight2) {
  	let mdo1XPos = iXPos1;
  	let mdo1YPos = iYPos1;

  	//edited by Mike, 20230524
  	//set as a point; not a tile
  	let mdo1Width = iImageFrameWidth1; //1;//iPuzzleTileWidth;
  	let mdo1Height = iImageFrameHeight1; //1;//iPuzzleTileHeight;

  	let mdo2XPos = iXPos2;
  	let mdo2YPos = iYPos2;

  	let mdo2Width = iImageFrameWidth2; //iPuzzleTileWidth;
  	let mdo2Height = iImageFrameHeight2; //iPuzzleTileHeight;

  	let iOffsetXPosAsPixel = iImageFrameWidth1*0.4;//0.1;//0;
  	let iOffsetYPosAsPixel = iImageFrameHeight1*0.4;//0.1;//0;

  	//alert("mdo1XPos: "+mdo1XPos);

  /*
  	alert("mdo1XPos: "+mdo1XPos+"; "+"mdo1Width: "+mdo1Width);
  	alert("mdo2XPos: "+mdo2XPos+"; "+"mdo2Width: "+mdo2Width);
  */

  	if ((mdo2YPos+mdo2Height < mdo1YPos+iOffsetYPosAsPixel) || //is the bottom of mdo2 above the top of mdo1?
  		(mdo2YPos > mdo1YPos+mdo1Height-iOffsetYPosAsPixel) || //is the top of mdo2 below the bottom of mdo1?
  		(mdo2XPos+mdo2Width < mdo1XPos+iOffsetXPosAsPixel) || //is the right of mdo2 to the left of mdo1?
  		(mdo2XPos > mdo1XPos+mdo1Width-iOffsetXPosAsPixel)) //is the left of mdo2 to the right of mdo1?
  	{
  		//no collision
  		return false;
  	}

    return true;
  }  

	function onLoad() {
//alert(navigator.userAgent);


  if (/Macintosh|Mac|Mobile|Android|webOS|iPhone|iPad|iPod|AppleWebKit|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i.test(navigator.userAgent)) {

//		alert("detected: Mobile Browser!");

  //added by Mike, 20220925
  bIsMobile=true;

  //added by Mike, 20221108
  if (navigator.userAgent.includes("AppleWebKit")) {
    bIsUsingAppleWebKit=true;
    //added by Mike, 20221109
    bIsUsingAppleMac=false; //default
  }

  //added by Mike, 20221113
  //notes: "AppleWebKit" to exist even with "Android"
  if (navigator.userAgent.includes("Android")) {
    bIsUsingAppleWebKit=false;
  }

  //added by Mike, 20221113
  //example: Linux x86_64 (desktop)
  if (navigator.userAgent.includes("Linux x")) {
    bIsMobile=false;
  }

  //note: iPAD and MacBookPro OS : Mac OS X
  //adds: to be re-classified as iPAD via TOUCH command
  if ((navigator.userAgent.includes("Macintosh")) || navigator.userAgent.includes("Mac")) {
    bIsUsingAppleMac=true;
  }

  //added by Mike, 20230111
  //note: TO-DO: -add: touch/mouse click ACTION COMMANDS
  //if using EDGE browser;
  //observed: shaking on EDGE browser via desktop,
  //caused by bIsMobile=true;
  if (navigator.userAgent.includes("Edge")) { //not "Edg"
    bIsMobile=false;
  }
}

/*
//note:
alert("window.innerWidth: "+window.innerWidth); //1408
alert("window.innerHeight: "+window.innerHeight); //601

alert("screen.width: "+screen.width); //1408
alert("screen.height: "+screen.height); //792

	iStageMaxWidth=640*2;
	iStageMaxHeight=360*2;
*/


		init();

		//iFacingDirection=iFACING_DOWN;

		//added by Mike, 20230423
		initMouseInput();

		//added by Mike, 20231125
		initKeyboardInput();

		//added by Mike, 202301107
		initTouchInput();

		//fFramesPerSecond=16.66; //100.00; //16.66;
		clearInterval(iCurrentIntervalId);
		iCurrentIntervalId=setInterval(myUpdateFunction, fFramesPerSecond);
	}




  </script>

  <body id="myBodyId" onload="onLoad();">

	<canvas id="myCanvasId" class="myCanvas">
	</canvas>

				
  <canvas id="myCanvasTwoId" class="myCanvas">
	</canvas>
			

<!-- noted by Mike, 20230424;

reference: https://stackoverflow.com/questions/5713295/specify-a-root-path-of-your-html-directory-for-script-links/41011179#41011179; last accessed: 20230424;
answer by: MistyDawn, 20161207T0655;
edited by: Huy Nguyen, 20170124T0455

/ means the root of the current drive;
./ means the current directory;
/ means the parent of the current directory.

//noted by Mike, 20231105
incorrect output on Safari; macOS;

opting to put assets folder in "html_application" folder instead
-->

	<img id="faviconImageId" class="ImageTileFrame1" src="assets/images/favicon.png">
	<img id="deathCountImageId" class="ImageTileFrame1" src="assets/images/favicon.png">

	<img id="doorImageRightId" class="Image64x64Tile" src="assets/images/tile.png">
	<img id="doorImageLeftId" class="Image64x64Tile" src="assets/images/tile.png">
	<img id="doorImageTopId" class="Image64x64Tile" src="assets/images/tile.png?lastmod=20241120T2053">
	<img id="doorImageBottomId" class="Image64x64Tile" src="assets/images/tile.png">

	<img id="doorLockedImageRightId" class="Image64x64Tile" src="assets/images/tile.png">
	<img id="riverImageRightId" class="ImageRiverTile" src="assets/images/river.png">
	
	
		<img id="mainImageTileImageTankBodyId" class="ImageTankFrame1" src="assets/images/inputImageLarge.png?lastmod=20241110">
		
		<img id="mainImageTileImageHeroBodyId" class="ImageHeroFrame1" src="assets/images/inputImage.png?lastmod=20241110">		

		<img id="mainImageTileImageId" class="ImageTileFrame1" src="assets/images/inputImage.png?lastmod=20241107">

		<img id="mainImageTileProjectileImageId" class="ImageTileFrame1" src="assets/images/inputImage.png?lastmod=20241107">

		<img id="mainImageTileFireballProjectileImageId" class="ImageTileFrame1" src="assets/images/fireballSmall.png?lastmod=20241122">

		<img id="mainImageTileFireballProjectileHoldImageId" class="ImageTileFrameFireballProjectileHold" src="assets/images/fireballSmall.png?lastmod=20241122">


		<img id="batMonsterImageId" class="ImageTileFrame1" src="assets/images/monsters.png?lastmod=20241120">

<!--
		<img id="snakeMonsterImageId" class="ImageTileFrame1" src="assets/images/monsters.png?lastmod=20241110">
-->
		<img id="snakeMonsterImageId0" class="ImageTileFrame1" src="assets/images/monsters.png?lastmod=20241110">
		<img id="snakeMonsterImageId1" class="ImageTileFrame1" src="assets/images/monsters.png?lastmod=20241110">

		<img id="grassMonsterImageId0" class="ImageTileBgFrame" src="assets/images/bgTile.png?lastmod=20241117">
		<img id="grassMonsterImageId1" class="ImageTileBgFrame" src="assets/images/bgTile.png?lastmod=20241117">
		<img id="grassMonsterImageId2" class="ImageTileBgFrame" src="assets/images/bgTile.png?lastmod=20241117">
		<img id="grassMonsterImageId3" class="ImageTileBgFrame" src="assets/images/bgTile.png?lastmod=20241117">

		<img id="slimeMonsterImageId0" class="ImageTileFrame1" src="assets/images/monsters.png?lastmod=20241120T1011">
		<img id="slimeMonsterImageId1" class="ImageTileFrame1" src="assets/images/monsters.png?lastmod=20241120T1011">
		<img id="slimeMonsterImageId2" class="ImageTileFrame1" src="assets/images/monsters.png?lastmod=20241120T1011">
		<img id="slimeMonsterImageId3" class="ImageTileFrame1" src="assets/images/monsters.png?lastmod=20241120T1011">
		<img id="slimeMonsterImageId4" class="ImageTileFrame1" src="assets/images/monsters.png?lastmod=20241120T1011">
		<img id="slimeMonsterImageId5" class="ImageTileFrame1" src="assets/images/monsters.png?lastmod=20241120T1011">

		<img id="miniBossMonsterImageId0" class="ImageTileFrameDd1" src="assets/images/bossMonsters.png?lastmod=20241127T2030">
		<img id="miniBossMonsterImageId1" class="ImageTileFrame1" src="assets/images/bossMonsters.png?lastmod=20241127T2030">
		<img id="miniBossMonsterImageId2" class="ImageTileFrameDd1" src="assets/images/bossMonsters.png?lastmod=20241127T2030">
		<img id="miniBossMonsterImageId3" class="ImageTileFrame1" src="assets/images/bossMonsters.png?lastmod=20241127T2030">
		<img id="miniBossMonsterImageId4" class="ImageTileFrameDd1" src="assets/images/bossMonsters.png?lastmod=20241127T2030">
		<img id="miniBossMonsterImageId5" class="ImageTileFrame1" src="assets/images/bossMonsters.png?lastmod=20241127T2030">
		
		<img id="miniBossMonsterImageId6" class="ImageTileFrameDd1" src="assets/images/bossMonsters.png?lastmod=20241127T2030">
		<img id="miniBossMonsterImageId7" class="ImageTileFrame1" src="assets/images/bossMonsters.png?lastmod=20241127T2030">
		<img id="miniBossMonsterImageId8" class="ImageTileFrameDd1" src="assets/images/bossMonsters.png?lastmod=20241127T2030">
		<img id="miniBossMonsterImageId9" class="ImageTileFrame1" src="assets/images/bossMonsters.png?lastmod=20241127T2030">
		<img id="miniBossMonsterImageId10" class="ImageTileFrameDd1" src="assets/images/bossMonsters.png?lastmod=20241127T2030">
		<img id="miniBossMonsterImageId11" class="ImageTileFrame1" src="assets/images/bossMonsters.png?lastmod=20241127T2030">
		

		<!-- added by Mike, 20231121 -->
		<img id="mouseInputImageId" class="ImageMouseInput" src="assets/images/inputImageLarge.png">

		<img id="bossMonsterImageId" class="ImageMonsterBoss" src="assets/images/inputImageLarge.png">


		<!-- added by Mike, 20231104;
		  note: .html; not .php -->

	<img id="pearlImageTileId" class="ImagePearlSmall" src="assets/images/items.png?lastmod=20241130T1432">
	<img id="pearlStatusImageTileId" class="ImagePearlSmall" src="assets/images/items.png?lastmod=20241130T1432">

	<img id="keyImageTileId" class="ImageKeySmall" src="assets/images/items.png?lastmod=20241130T1432">
	<img id="keyStatusImageTileId" class="ImageKeySmall" src="assets/images/items.png?lastmod=20241130T1432">

	<img id="amuletImageTileId" class="ImageKeySmall" src="assets/images/items.png?lastmod=20241130T1432">
	<img id="amuletStatusImageTileId" class="ImageKeySmall" src="assets/images/items.png?lastmod=20241130T1432">
	
	<img id="heroLifeBarStatusImageTileId" class="ImageKeySmall" src="assets/images/profile.png">
	
	<img id="grassCutEffectImageId" class="ImageGrassCutEffectSmall" src="assets/images/bgTile.png">

	<img id="explosionEffectImageId" class="ImageExplosionEffectResizedToSmall" src="assets/images/effectsSmall.png">

	<img id="fireballExplosionEffectImageId" class="ImageExplosionEffectResizedToSmall" src="assets/images/effectsSmall.png">
  
	<img id="explosionEffectToMonsterImageId" class="ImageExplosion" src="assets/images/effects.png">

    <img id="explosionEffectToCityImageId" class="ImageExplosionToCity" src="assets/images/effects.png">

	<img id="dustEffectImageId" class="ImageDust" src="assets/images/effectsSmall.png">

	<img id="initFireballEffectImageId" class="ImageInitFireball" src="assets/images/effectsSmall.png">

	<img id="heroAttackEffectImageId" class="ImageHeroAttack" src="assets/images/heroEffectsSmall.png?lastmod=20241128T1010">

 
	<div id="divSnowEffectId0" class="myDivSnowEffect"></div>
	<div id="divSnowEffectId1" class="myDivSnowEffect"></div>
	<div id="divSnowEffectId2" class="myDivSnowEffect"></div>
	<div id="divSnowEffectId3" class="myDivSnowEffect"></div>
	<div id="divSnowEffectId4" class="myDivSnowEffect"></div>

	<div id="divSnowEffectId5" class="myDivSnowEffect"></div>
	<div id="divSnowEffectId6" class="myDivSnowEffect"></div>
	<div id="divSnowEffectId7" class="myDivSnowEffect"></div>
	<div id="divSnowEffectId8" class="myDivSnowEffect"></div>
	<div id="divSnowEffectId9" class="myDivSnowEffect"></div>

	<div id="divTransitionEffectId" class="myDivTransitionEffect"></div>

		
	<img id="howToPlayGuideImageId" class="ImageHowToPlayGuide" src="assets/images/gameOff2024HowToPlay.png">
		
	<img id="howToPlayGuideImageFrame2Id" class="ImageHowToPlayGuide" src="assets/images/gameOff2024HowToPlayFrame2.png">
	
	<!-- ImageTitle-->
	<img id="titleImageId" class="ImageHowToPlayGuide" src="assets/images/gameOff2024TitleBG.png">

	<img id="titleImageFrame2Id" class="ImageHowToPlayGuide" src="assets/images/gameOff2024TitleBGFrame2.png">

	<img id="bossBattleBgImageId" class="ImageBossBattleBg" src="assets/images/bgImageCave.png?lastmod=20241127">

	<img id="bossBattleBgImageBeachId" class="ImageBossBattleBg" src="assets/images/bgImageCaveStart.png?lastmod=20241127">

	<img id="bossBattleBgImageBeachPart2Id" class="ImageBossBattleBgBeachPart2" src="assets/images/bgImageCaveStartPart2.png?lastmod=20241128">
	
	
	<img id="bossBattleBgImagePart2Id" class="ImageBossBattleBgPart2" src="assets/images/bossBattleBgPart2.png">	

	<img id="bossBattleBgImagePart3Id" class="ImageBossBattleBgPart3" src="assets/images/bossBattleBgPart3.png">	
	
	<div id="textStatusDivId" class="DivTextStatus">CONGRATULATIONS!</div>
	<div id="textStatusBackgroundDivId" class="DivTextStatusBackground"></div>

	
	<!-- PRESS ENTER; PRESS START -->
	<div id="textEnterDivId" class="DivTextClickStart">START</div>

	<div id="textNewGameDivId" class="DivTextClickContinue">NEW GAME</div>
	<div id="textContinueGameDivId" class="DivTextClickContinue">CONTINUE</div>

	<div id="textScoreShadowDivId" class="DivStepCountStatusShadow">0</div>

	<div id="textScoreDivId" class="DivTextScore">0</div>

	<div id="textTimeDivId" class="DivTextTime">0</div>
	<div id="textPearlStatusDivId" class="DivTextTime">0</div>
	<div id="textLifeBarDivId" class="DivTextTime">LIFE</div>
	<div id="textManaBarDivId" class="DivTextTime">MANA</div>
	<div id="textMonsterDeathStatusDivId" class="DivTextTime">0</div>



<!--
	<div id="stepCountStatusDivId" class="DivStepCountStatus">0</div>
	
	//usbongGameOff2023BGM
	//usbongGameOff2023AudioEffectsCannon
-->

  <audio id="myAudioId" class="myAudio" src="assets/audio/usbongGameOff2024CaveBGMV22.mp3" type="audio/x-m4a" controls loop>
	  Your browser does not support the audio tag.
	</audio><br/>

  <audio id="myAudioPart2Id" class="myAudio" src="assets/audio/usbongGameOff2024CaveBadBGMV10.mp3" type="audio/x-m4a" controls loop>
	  Your browser does not support the audio tag.
	</audio><br/>

  <audio id="myAudioPart3Id" class="myAudio" src="assets/audio/usbongGameOff2024TitleV5.mp3" type="audio/x-m4a" controls loop>
	  Your browser does not support the audio tag.
	</audio><br/>
	
  <audio id="myAudioBossScreechId" class="myAudio" src="assets/audio/usbongGameOff2024Screech.mp3" type="audio/x-m4a" controls loop>
	  Your browser does not support the audio tag.
	</audio><br/>
	
  <audio id="myAudioWaterId" class="myAudio" src="assets/audio/usbongGameOff2024WaterOKV2.mp3" type="audio/x-m4a" controls loop>
	  Your browser does not support the audio tag.
	</audio><br/>	

<!--
	<audio id="myAudioId" class="myAudio" src="assets/audio/usbongGameOff2023BGM.mp3" type="audio/x-m4a">
	  Your browser does not support the audio tag.
	</audio><br/>	
-->	
	

	<audio id="myAudioEffectGrassCutId" class="myAudio" src="assets/audio/usbongGameOff2023TapLoudEdited.mp3" type="audio/x-m4a">
	  Your browser does not support the audio tag.
	</audio><br/>

	<audio id="myAudioEffectCannonFireId" class="myAudio" src="assets/audio/usbongGameOff2023AudioEffectsCannon.mp3" type="audio/x-m4a">
	  Your browser does not support the audio tag.
	</audio><br/>
	
	<audio id="myAudioEffectSolvedId" class="myAudio" src="assets/audio/UsbongGameOff2024TuneSolved.mp3" type="audio/x-m4a">
	  Your browser does not support the audio tag.
	</audio><br/>

<!--
<button onclick="openFullscreen();">Open Fullscreen</button>
-->

  </body>
</html>
